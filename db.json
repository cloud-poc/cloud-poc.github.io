{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/affix.js","path":"js/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/exturl.js","path":"js/exturl.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/js.cookie.js","path":"js/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/post-details.js","path":"js/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/scroll-cookie.js","path":"js/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/scrollspy.js","path":"js/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"source/about/index/20190713213835-4.jpg","path":"about/index/20190713213835-4.jpg","modified":0,"renderable":0},{"_id":"themes/next/source/images/20190713213835-4.jpg","path":"images/20190713213835-4.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/20190713213835-3.jpg","path":"images/20190713213835-3.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/LICENSE","path":"lib/canvas-nest/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/README.md","path":"lib/canvas-nest/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest-nomobile.min.js","path":"lib/canvas-nest/canvas-nest-nomobile.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/LICENSE","path":"lib/three/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/README.md","path":"lib/three/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/gulpfile.js","path":"lib/three/gulpfile.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/package.json","path":"lib/three/package.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/renovate.json","path":"lib/three/renovate.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/lib/CanvasRenderer.js","path":"lib/three/lib/CanvasRenderer.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/lib/Projector.js","path":"lib/three/lib/Projector.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/package-lock.json","path":"lib/three/package-lock.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/src/canvas_lines.js","path":"lib/three/src/canvas_lines.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/src/canvas_sphere.js","path":"lib/three/src/canvas_sphere.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/src/three-waves.js","path":"lib/three/src/three-waves.js","modified":0,"renderable":1},{"_id":"themes/next/source/images/home-bg-jeep.jpg","path":"images/home-bg-jeep.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":0,"renderable":1}],"Cache":[{"_id":"themes/next/.all-contributorsrc","hash":"b44e43bfab92df4cf5180cfe096f262c1526f335","modified":1563032666018},{"_id":"themes/next/.bowerrc","hash":"334da94ca6f024d60d012cc26ea655681e724ad8","modified":1563032666018},{"_id":"themes/next/.editorconfig","hash":"211d2c92bfdddb3e81ea946f4ca7a539f150f4da","modified":1563032666021},{"_id":"themes/next/.eslintrc.json","hash":"d3c11de434171d55d70daadd3914bc33544b74b8","modified":1563032666022},{"_id":"themes/next/.gitattributes","hash":"8454b9313cb1a97b63fb87e2d29daee497ce6249","modified":1563032666023},{"_id":"themes/next/.gitignore","hash":"8bf1bfc917aa8dd2d886fd36f764447a2b561e1e","modified":1563032666045},{"_id":"themes/next/.stylintrc","hash":"3b7f9785e9ad0dab764e1c535b40df02f4ff5fd6","modified":1563032666046},{"_id":"themes/next/.travis.yml","hash":"fb9ac54e875f6ea16d5c83db497f6bd70ae83198","modified":1563032666047},{"_id":"themes/next/LICENSE.md","hash":"0a9c7399f102b4eb0a6950dd31264be421557c7d","modified":1563032666048},{"_id":"themes/next/README.md","hash":"1e993dacb9743e074ae7fe78e82daf6a497fdd49","modified":1563032666050},{"_id":"themes/next/_config.yml","hash":"e696e3f14d66a5b5f70b8fb333f588c72a7bc0fc","modified":1563083148932},{"_id":"themes/next/bower.json","hash":"e9fafd267d723927d9deaf9dafd2ad76e682498a","modified":1563032666053},{"_id":"themes/next/crowdin.yml","hash":"4a53f5985e545c635cb56b2a57ed290cb8cf8942","modified":1563032666054},{"_id":"themes/next/gulpfile.coffee","hash":"0270ef10352921dc64166a0d29477e762459a0cd","modified":1563032666082},{"_id":"themes/next/package.json","hash":"a80d8a4f6aaa325725e14a33329ae441e9c1c86f","modified":1563032666184},{"_id":"source/categories/index.md","hash":"fc74e6f4f5beb6a4a5b8e6f86afcaf3ebd13b2bc","modified":1563065722195},{"_id":"source/about/index.md","hash":"b78cdead05e5e6500f2909033c4623fc2c964481","modified":1563085986670},{"_id":"source/tags/index.md","hash":"06b19f452e9aeb135c43a632370cf15faa848001","modified":1563065670093},{"_id":"themes/next/.git/FETCH_HEAD","hash":"09f3ac390d5f8e8883de36d8dffe85bf31990f3c","modified":1563033982481},{"_id":"themes/next/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1563032665983},{"_id":"themes/next/.git/ORIG_HEAD","hash":"68621e1e32daf17be4fcb4f1126cade6d00858e1","modified":1563033982558},{"_id":"themes/next/.git/config","hash":"7f8b507977a695e25b27d4c2e8aaed71410536bf","modified":1563032665997},{"_id":"themes/next/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1563032586577},{"_id":"themes/next/.git/index","hash":"889dce32c08fd56bfaf6fdf46dcd713b2b43b5a9","modified":1563064056894},{"_id":"themes/next/.git/packed-refs","hash":"c62e0e35414fc3f5edcaaaebebc91671ecb284e3","modified":1563032665974},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"f7ddb7faed8031a9f40eae4ee7bb48c1bc50fd14","modified":1563032666024},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5c494437ae0325b02b52fa5e80235060be1d3c6a","modified":1563032666025},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"1e212fe229bd659726b4a3bcf4b5b14e0310ba3a","modified":1563032666027},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"f1631b9bef922e7bc2db1e33badfad70fd88d459","modified":1563032666033},{"_id":"themes/next/.github/auto_assign.yml","hash":"9fe0dbe3f6edc59bf10ea25b14eba0e92e2c8f42","modified":1563032666034},{"_id":"themes/next/.github/config.yml","hash":"cbd06d0c40afa9fdf056765120e9085826b00d20","modified":1563032666035},{"_id":"themes/next/.github/eslint-disable-bot.yml","hash":"e06053d417579ed967a94166deb6bda5ce41d805","modified":1563032666036},{"_id":"themes/next/.github/lock.yml","hash":"4f1070097b614b24050f238694127e3573ce8472","modified":1563032666038},{"_id":"themes/next/.github/mergeable.yml","hash":"1c1cb77a62df1e3654b151c2da34b4a10d351170","modified":1563032666039},{"_id":"themes/next/.github/release-drafter.yml","hash":"d01b1e8f462af114e3934fef2ee654634d86b406","modified":1563032666040},{"_id":"themes/next/.github/stale.yml","hash":"85975c43d606c39b91c0ad32197154be9d482a09","modified":1563032666041},{"_id":"themes/next/.github/support.yml","hash":"7ce2722d6904c31a086444c422dc49b6aa310651","modified":1563032666042},{"_id":"themes/next/.github/topissuebot.yml","hash":"5091c3bc6f3df303d16d853ce65a302601c1e875","modified":1563032666043},{"_id":"themes/next/.github/weekly-digest.yml","hash":"6db3bcad65c3156de298f6a3ffd3ba887af4aa4f","modified":1563032666044},{"_id":"themes/next/docs/AGPL3.md","hash":"f463f95b169d64983f59fa6f3e4b6760290a0e6b","modified":1563032666055},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"32c6d2c5c55b96a7f9b6da110127be6ca56ed0fb","modified":1563032666056},{"_id":"themes/next/docs/DATA-FILES.md","hash":"9a1895c0a0db705c4c48f512e86917f9af1ec3fb","modified":1563032666059},{"_id":"themes/next/docs/INSTALLATION.md","hash":"b74ef6fedf76cdb156e2265759ee0a789ddd49cc","modified":1563032666060},{"_id":"themes/next/docs/LICENSE.txt","hash":"ae5ad07e4f4106bad55535dba042221539e6c7f9","modified":1563032666063},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"721a1aa9feed1b580ab99af8e69ed22699121e88","modified":1563032666061},{"_id":"themes/next/docs/MATH.md","hash":"7d0330c250082a86897d1c96fbb4ef5df59538af","modified":1563032666064},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"c9f2ed8e15c137b1885d9ca8b7197d9f457971e9","modified":1563032666065},{"_id":"themes/next/languages/de.yml","hash":"131f9ad9ef130cfc8058e2764d3ce7e0c1700d39","modified":1563032666083},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1563032666085},{"_id":"themes/next/languages/en.yml","hash":"d66b8b48840443a4f9c72c7696a21e292f685a47","modified":1563032666086},{"_id":"themes/next/languages/es.yml","hash":"19995062f6f9fb9b621fc055e780524c42fccd31","modified":1563032666087},{"_id":"themes/next/languages/fa.yml","hash":"56dccb20a1f156bd278e9c600e397e5ba845d9a1","modified":1563032666088},{"_id":"themes/next/languages/fr.yml","hash":"aeae19629eab296855dc5cddfe6712c2569c7d3c","modified":1563032666090},{"_id":"themes/next/languages/hu.yml","hash":"a52b04cad56168e642eb4d071b05a0dcad53f365","modified":1563032666091},{"_id":"themes/next/languages/id.yml","hash":"f67c884cfbf4f6d5254a34e0ea7193dd746d29ea","modified":1563032666092},{"_id":"themes/next/languages/it.yml","hash":"3e2d836aa93abf642e951fb69c234e8ef150b1c8","modified":1563032666093},{"_id":"themes/next/languages/ja.yml","hash":"29bf46c6e0e3d107d2befc7bce2552668defcd3e","modified":1563032666094},{"_id":"themes/next/languages/ko.yml","hash":"1874f92fffc7b93f9907da76c0bf4953a87795c5","modified":1563032666096},{"_id":"themes/next/languages/nl.yml","hash":"1a0b5fa111c586e1df7fef08637ccb19bcb8eda7","modified":1563032666097},{"_id":"themes/next/languages/pt-BR.yml","hash":"5158cd29b0676d3b79c3b9538f88a2f121741ff1","modified":1563032666098},{"_id":"themes/next/languages/pt.yml","hash":"7b0d3a6cc507cd4325f87af9d84ab9e53e0c50e8","modified":1563032666099},{"_id":"themes/next/languages/ru.yml","hash":"6504871e5f3103ab65391fc3fcab2c6c68a075dc","modified":1563032666100},{"_id":"themes/next/languages/tr.yml","hash":"cd913ee8a69ecd1ba615ba71339d376677b29251","modified":1563032666101},{"_id":"themes/next/languages/uk.yml","hash":"7d0396cb2adb9d44a6756c9352ffe7e0f944f10d","modified":1563032666102},{"_id":"themes/next/languages/vi.yml","hash":"ed57e3263d9da09029bf2afa6853e50033faa4dd","modified":1563032666103},{"_id":"themes/next/languages/zh-HK.yml","hash":"f42a0b7a0f0b9844e711ab13b205e8f91ae81098","modified":1563032666105},{"_id":"themes/next/languages/zh-CN.yml","hash":"a4095bef4abb6e1261b7e950f352eaef86b069f6","modified":1563032666104},{"_id":"themes/next/languages/zh-TW.yml","hash":"e72e67b1f8007428aa6952078d1ebf877f438da9","modified":1563032666106},{"_id":"themes/next/layout/_layout.swig","hash":"7f6886702bd9ddf6aeea372192e79921a2059416","modified":1563032666107},{"_id":"themes/next/layout/archive.swig","hash":"61bc56e77e653684fc834f63dcbdadf18687c748","modified":1563032666179},{"_id":"themes/next/layout/index.swig","hash":"a5153bc4b2eaf2ff1f58ad04b5715188614b6b22","modified":1563032666180},{"_id":"themes/next/layout/category.swig","hash":"ad0ac6a1ff341f8eab9570e7fb443962948c5f9d","modified":1563032666179},{"_id":"themes/next/layout/page.swig","hash":"9a272ec78ccef56a6a39304c59cdb5c0350afea0","modified":1563032666181},{"_id":"themes/next/layout/post.swig","hash":"af74e97d57cf00cde6f8dbd4364f27910915454e","modified":1563032666182},{"_id":"themes/next/layout/schedule.swig","hash":"e79f43df0e9a6cf48bbf00882de48c5a58080247","modified":1563032666182},{"_id":"themes/next/layout/tag.swig","hash":"283519d4d5b67814412863a3e0212bac18bcc5a0","modified":1563032666183},{"_id":"themes/next/scripts/injects-point.js","hash":"dca4dce43ec27661bec39335be7d8b97447d4306","modified":1563032666189},{"_id":"themes/next/scripts/injects.js","hash":"fc7d63dbf0ffea6b05b87d7366ed400c073d095e","modified":1563032666190},{"_id":"themes/next/scripts/merge-configs.js","hash":"da9008cf41ca35530dcae0eddd295f07b129f26c","modified":1563032666192},{"_id":"themes/next/scripts/merge.js","hash":"39b84b937b2a9608b94e5872349a47200e1800ff","modified":1563032666193},{"_id":"themes/next/test/.jshintrc","hash":"c9fca43ae0d99718e45a6f5ce736a18ba5fc8fb6","modified":1563032666345},{"_id":"themes/next/test/helpers.js","hash":"f25e7f3265eb5a6e1ccbb5e5012fa9bebf134105","modified":1563032666346},{"_id":"themes/next/test/intern.js","hash":"db90b1063356727d72be0d77054fdc32fa882a66","modified":1563032666346},{"_id":"themes/next/docs/AUTHORS.md","hash":"a8b638397dc5e42c4c0bad403820a28b86f83fc7","modified":1563032666058},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563032666297},{"_id":"source/_posts/Harshicorp-vault-setup-Config/index.md","hash":"837f7695e38e9c15aa513613fb154880925b03bb","modified":1563087966231},{"_id":"source/_posts/Https-setup-using-Certbot-Docker-Nginx/index.md","hash":"7c126ee88388fab7aaba72c92cf9cbecf15e3259","modified":1563105610839},{"_id":"source/_posts/Linux-network-proxy-setup-desktop-and-terminal/index.md","hash":"7b032667bd5c3576a43bbffb2c8d651f1592d211","modified":1563089093260},{"_id":"themes/next/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1563032586578},{"_id":"themes/next/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1563032586580},{"_id":"themes/next/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1563032586584},{"_id":"themes/next/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1563032586585},{"_id":"themes/next/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1563032586587},{"_id":"themes/next/.git/hooks/pre-commit.sample","hash":"33729ad4ce51acda35094e581e4088f3167a0af8","modified":1563032586588},{"_id":"themes/next/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1563032586590},{"_id":"themes/next/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1563032586592},{"_id":"themes/next/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1563032586593},{"_id":"themes/next/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1563032586594},{"_id":"themes/next/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1563032586596},{"_id":"themes/next/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1563032586598},{"_id":"themes/next/.git/logs/HEAD","hash":"62493953bd8a31a8242d40ac233c8b284cd46cdb","modified":1563032665989},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"795b8ddb251da8e2327299d5f7dbf446fb9867c6","modified":1563032666028},{"_id":"themes/next/.github/ISSUE_TEMPLATE/custom-issue-template.md","hash":"245917ffaa296bc2d9a85444acf639077ca25944","modified":1563032666030},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"59b2b45e151972bbe08582cde22f398e58832765","modified":1563032666031},{"_id":"themes/next/.github/ISSUE_TEMPLATE/non-english.md","hash":"ae22e700b7c63c60746321719a20d34022ad78d9","modified":1563032666032},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"a51de08657f5946f4028b11373280ddc04639525","modified":1563032666066},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"7b2963daac19b0c14f98ebef375d5fbce8fc3f44","modified":1563032666067},{"_id":"themes/next/docs/ru/README.md","hash":"a4fbc2813d1c55d1f7ff14667b85db0344ca247d","modified":1563032666068},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"1a4e41adcf5831057f3f7b3025ed4a5ef7c442b4","modified":1563032666070},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"aaf25d304793344e2d026062768c93005723f5c6","modified":1563032666071},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"1c21127b1a5004e99169fe8bbf5493245f07e843","modified":1563032666072},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"56cf765f835c11afde3ebf128afa36742ea0b31f","modified":1563032666074},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"67f4a987e7db0ab1ce1ea4c311f2961df07b6681","modified":1563032666075},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"baca12cc24be082f1db28c7f283493569666321c","modified":1563032666077},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"b17fc344ff61603f83387c0f9b2b2189aae81d50","modified":1563032666078},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"db2797f161e1e7a4987cbfa3d1be682266dfbba6","modified":1563032666079},{"_id":"themes/next/docs/zh-CN/README.md","hash":"21762c4cf04dc1aafa1072cfdfe9452912da2778","modified":1563032666080},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"2095d1214a4e519a1d31b67b41c89080fa3285d3","modified":1563032666081},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"891ab67815969dd8736cb22fbbb3f791b8fff4e4","modified":1563032666111},{"_id":"themes/next/layout/_macro/post.swig","hash":"43e3494f08485db176ee6757c39a2e944b712859","modified":1563081622350},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"d7de4508c4883ceff055f3389edcda950bdcd76b","modified":1563032666113},{"_id":"themes/next/layout/_partials/comments.swig","hash":"05c71af28590c885b94d09bf0c64baeaf4a0abb5","modified":1563032666114},{"_id":"themes/next/layout/_partials/footer.swig","hash":"64d4e3753c7d55f53e1f919e75494b85b1f2e60a","modified":1563032666115},{"_id":"themes/next/layout/_partials/github-banner.swig","hash":"1ad13269b43b900356f3bdab7947d6a86f035a2c","modified":1563032666116},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"914155d5d758306cff405beefd4a07973fd8fc77","modified":1563032666124},{"_id":"themes/next/layout/_partials/post-edit.swig","hash":"dee345054d564dd56f74bb143942d3edd1cb8150","modified":1563032666125},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"0074818d7cbe56ee49f56baca768915f76fa6891","modified":1563032666136},{"_id":"themes/next/layout/_scripts/exturl.swig","hash":"c2e8f4b3a2bf991320ecc827dcdc227399ad5b51","modified":1563032666137},{"_id":"themes/next/layout/_scripts/next-boot.swig","hash":"a0921aa828c8ef4719558f736aac2a64e1e79b0b","modified":1563032666137},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"efb3404a3303622f3be60944d9d1926972c5c248","modified":1563032666138},{"_id":"themes/next/layout/_scripts/scroll-cookie.swig","hash":"8a992b7fe42b9c1a5eb9d937b0827aed91586d94","modified":1563032666143},{"_id":"themes/next/layout/_scripts/three.swig","hash":"5815ead7edd2a74869b545339f24aa6320adc26a","modified":1563032666143},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"b19cf6dcf1be92d5cf4fb80e287beba988590290","modified":1563032666144},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"87bcb495f7ddd81cc3fe2c2a886e51c08053019b","modified":1563032666158},{"_id":"themes/next/layout/_third-party/bookmark.swig","hash":"4b93dc7ac0573c402aabcb5c933bbcb893b07c51","modified":1563032666159},{"_id":"themes/next/layout/_third-party/chatra.swig","hash":"8e1b441cb7e8e90896c63dfaa314bc884cab3251","modified":1563032666159},{"_id":"themes/next/layout/_third-party/mermaid.swig","hash":"80dfc0879866e6512cb67590a3b2d8741a66f980","modified":1563032666168},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"7db4ad4a8dd5420dad2f6890f5299945df0af970","modified":1563032666169},{"_id":"themes/next/layout/_third-party/pangu.swig","hash":"76f5933925670044ec65b454295ba7e0a8439986","modified":1563032666170},{"_id":"themes/next/layout/_third-party/pdf.swig","hash":"4ae61c7efb16e962385bfe522a38c4d29cdcccbe","modified":1563032666171},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"8b1322a091355853db62a5aafb8886fdbd8ab56a","modified":1563032666172},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"c476dc3693a9dd0be2d136a45b0d7fdef55d4d92","modified":1563032666172},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"882cd0b68c493af1b6d945660f9c21085e006ffc","modified":1563032666173},{"_id":"themes/next/layout/_third-party/tidio.swig","hash":"b44010cd577e4d063c3406772938c4b117ec7b7b","modified":1563032666178},{"_id":"themes/next/scripts/helpers/engine.js","hash":"cdb6152582313268d970ffeef99b4a8a7850f034","modified":1563032666188},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"a40ce6bc852bb4bff8b9f984fa064741dd151e96","modified":1563032666189},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"513023c716f91c70e0a1743e7cfbfe37824825a3","modified":1563032666185},{"_id":"themes/next/scripts/filters/exturl.js","hash":"b19c7c1021e57367b3b3bbf5678381017ed5667d","modified":1563032666186},{"_id":"themes/next/scripts/filters/lazyload.js","hash":"22c99f15c6607f62d9b8764f296b5abdec4cd88b","modified":1563032666187},{"_id":"themes/next/scripts/tags/button.js","hash":"95a520f6529424a03c7ead6dbfd5e626d672febb","modified":1563032666194},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"4519ab8e6898f2ee90d05cde060375462b937a7d","modified":1563032666195},{"_id":"themes/next/scripts/tags/full-image.js","hash":"04dab9274c33e2293c878d4549764321db5f25d3","modified":1563032666195},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"8e1befa08c07f822f9487978dbd27db60fb700c7","modified":1563032666197},{"_id":"themes/next/scripts/tags/include-raw.js","hash":"ab4a82a7246265717556c7a42f897430340b88cf","modified":1563032666197},{"_id":"themes/next/scripts/tags/label.js","hash":"fc83f4e1be2c34e81cb79938f4f99973eba1ea60","modified":1563032666198},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"81134494ff0134c0dae1b3815caf6606fccd4e46","modified":1563032666199},{"_id":"themes/next/scripts/tags/note.js","hash":"1fdf4f95810fdb983bfd5ad4c4f13fedd4ea2f8d","modified":1563032666200},{"_id":"themes/next/scripts/tags/pdf.js","hash":"ab995f0fc60d60f637220e2651111b775b8a06de","modified":1563032666200},{"_id":"themes/next/scripts/tags/tabs.js","hash":"72a5adbd8f300bee1d0c289367598ca06b2bed17","modified":1563032666201},{"_id":"themes/next/scripts/tags/video.js","hash":"944293fec96e568d9b09bc1280d5dbc9ee1bbd17","modified":1563032666202},{"_id":"themes/next/source/css/main.styl","hash":"ddb72ce34c79773a771f5502b53751a5186d1d08","modified":1563032666297},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1563032666298},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1563032666299},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1563032666301},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1563032666302},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1563032666303},{"_id":"themes/next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1563032666300},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1563032666304},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1563032666304},{"_id":"themes/next/source/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1563032666305},{"_id":"themes/next/source/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1563032666306},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1563032666307},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1563032666308},{"_id":"themes/next/source/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1563032666309},{"_id":"themes/next/source/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1563032666309},{"_id":"themes/next/source/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1563032666310},{"_id":"themes/next/source/js/algolia-search.js","hash":"84906eeae57bd06744dd20160b93eacf658f97e2","modified":1563032666313},{"_id":"themes/next/source/js/affix.js","hash":"ad343aa406fd8181b5f310434817ce98fc2219e3","modified":1563032666311},{"_id":"themes/next/source/js/exturl.js","hash":"c48aa4b3c0e578a807fd3661e6cd4f3890777437","modified":1563032666314},{"_id":"themes/next/source/js/js.cookie.js","hash":"f11e84def0352b7dd6393f1b83e55a40ab468686","modified":1563032666314},{"_id":"themes/next/source/js/motion.js","hash":"ba588549879501daf3021007e5d4a3a4556cd2df","modified":1563032666315},{"_id":"themes/next/source/js/next-boot.js","hash":"f1c09824627c4623b36cdf41669aecc9f7dabfb3","modified":1563032666316},{"_id":"themes/next/source/js/post-details.js","hash":"82a1339034bcbf370760ea4bc5000dadaf44a36b","modified":1563032666317},{"_id":"themes/next/source/js/scroll-cookie.js","hash":"c4867626afab749404daf321367f9b6b8e223f69","modified":1563032666320},{"_id":"themes/next/source/js/scrollspy.js","hash":"68d3690152c89e7adb08bb35ec28dbda2bd93686","modified":1563032666320},{"_id":"themes/next/source/js/utils.js","hash":"33721b452b2561a40bc1502c1c3e88a71d2ef657","modified":1563032666321},{"_id":"source/about/index/20190713213835-4.jpg","hash":"af4250dd4bf39788fb53e291cc682296073785df","modified":1563027735466},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563032666268},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563032666269},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563032666293},{"_id":"themes/next/source/images/20190713213835-4.jpg","hash":"af4250dd4bf39788fb53e291cc682296073785df","modified":1563027735466},{"_id":"source/_posts/Harshicorp-vault-setup-Config/index/15532408-351f3fa54f1ebc1a.png","hash":"c1412da8605a160e16be667b5c6d2a1d13eebfb3","modified":1563067302176},{"_id":"source/_posts/Harshicorp-vault-setup-Config/index/15532408-698c9ee3afd1d4f9.png","hash":"874a89684c1fba27abbb688824cf9ad7159b604a","modified":1563067318363},{"_id":"source/_posts/Https-setup-using-Certbot-Docker-Nginx/index/20190714194434.png","hash":"694974e10a9c5ba363e25c101bd59569d8701d82","modified":1563104707082},{"_id":"source/_posts/Https-setup-using-Certbot-Docker-Nginx/index/20190714195417.png","hash":"106217b2e63837c89cf620008ca99cd6508fe733","modified":1563105269538},{"_id":"source/_posts/Linux-network-proxy-setup-desktop-and-terminal/index/15532408-1405d25f0bcee21b.png","hash":"5466cb8e58e14b5468d6f3f3e04899a1443309ef","modified":1563087336390},{"_id":"source/_posts/Https-setup-using-Certbot-Docker-Nginx/index/debug.log","hash":"9ef4faa329db5d25135da946c875d48caa59cd31","modified":1563109088039},{"_id":"themes/next/.git/refs/heads/master","hash":"68621e1e32daf17be4fcb4f1126cade6d00858e1","modified":1563032665988},{"_id":"themes/next/layout/_macro/menu/menu-badge.swig","hash":"4eb8e222dc337211efb0d3bbdb5e29af3e6ecdb8","modified":1563032666108},{"_id":"themes/next/layout/_macro/menu/menu-item.swig","hash":"14b8ee43ac848b829960af80c8981271b9e37d51","modified":1563032666110},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"b57bf9c865bed0f22157176a8085de168a1aef77","modified":1563032666117},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"fd079a414ca0f42f4cddd00247a9d5a5f58c4d8e","modified":1563032666118},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"ae49170a2494c1808a67b2ffa29d5b9d336e7b1a","modified":1563032666118},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"f05576c95ebadbb7a4a04be26399554ef1c5aa60","modified":1563032666119},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"15974219bfa63ff2782992657e23d6a1e5e39ffa","modified":1563032666120},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"39c4ad0e36b7c1260da98ba345f7bd72a2ac0f2e","modified":1563032666121},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"e015c7d9b84062b60b15b36be3ef11929dd10943","modified":1563032666122},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"2b905ddd5dea8558c3fd95aacad241da6b6800f4","modified":1563032666123},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"f46699a9daa5fef599733cbab35cb75cf7a05444","modified":1563032666124},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"be6683db6a269d83bb0441d7cf74db63a240fa8a","modified":1563032666126},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"f331ad02beea8990066d32ad6ec9f859672c3615","modified":1563032666127},{"_id":"themes/next/layout/_partials/post/reward.swig","hash":"f62b801c7999da67b4bdca9c5e373b9b5ed039dc","modified":1563032666128},{"_id":"themes/next/layout/_partials/post/wechat-subscriber.swig","hash":"fb7727e8ec63a58238a7206bf70eb273c8879993","modified":1563032666129},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"277367168c647ff0160034bb93f1b069780f60ce","modified":1563032666130},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"f14e9e8c27af82f1bfe794e252dec0d7e521f503","modified":1563032666131},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"b2f0d247b213e4cf8de47af6a304d98070cc7256","modified":1563032666132},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"31245e09ce0465b994cebd94223a531585c4eab4","modified":1563032666133},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"c609097b95eb6127c2784f47f2230e6e6efc0be2","modified":1563032666134},{"_id":"themes/next/layout/_partials/share/likely.swig","hash":"b9f02377daf9dd3187eafff0d707b3fe85c17244","modified":1563032666135},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"cf87ab778618a32119ec1c4ac2079a51385b1913","modified":1563032666139},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a62c93f19429f159bcf0c2e533ffc619aa399755","modified":1563032666140},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"3c548934b97cc426544947f7a2ae35c270b5e33f","modified":1563032666141},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"7ef07edd2a97a3774229990d2f0a6eefa31bd015","modified":1563032666141},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"828eb9c47f34090c841a2e9a0b3f31b0e4ccf40a","modified":1563032666142},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"66d562b3778dbc839f7c00103bd0099c5d61602a","modified":1563032666146},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"83dd7df11b100bae38c9faab9a478f92149a0315","modified":1563032666147},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"73576c9683d9ad9b124916dc6c660607fe7cc1fa","modified":1563032666148},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"2e1de38f44af00209129d4051b7ae307cb11ad68","modified":1563032666148},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"335005a9f8b36349f0ad0a7beeba6969c55fc7f7","modified":1563032666150},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"f648e5bf8c5dfc74143233976ed4ff5978deda43","modified":1563032666151},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"8ab040fccba41675bc835973515530af8a51f8bd","modified":1563032666151},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"d68da660cd1cc8fb3ff0a81178decadb620afc11","modified":1563032666152},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"623e73bedef067ac24a398ef27c8197295da872d","modified":1563032666153},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"39928f358dd13d9fc1a4641800e57be157ecd815","modified":1563032666154},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"7a4e7d463165df3221a2a9063dc010968289782d","modified":1563032666155},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"d18c87d7839e7407e39acd2998bcc9e0b34611b0","modified":1563032666155},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"a22d1ea29a5ffe46199ab7d108a291a05af8d5b6","modified":1563032666156},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"4cff8bf5c42c62f7f0ac1f0d70f839dae39ba77a","modified":1563032666157},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"43a20fa0e9ae2f4254f04813f9c619dd36b49ae5","modified":1563032666166},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"ea1c136f960667a0a13b334db497b9b19c41f629","modified":1563032666167},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"767ba29f258db5d2e5baf875a6f36ac1d44df6a3","modified":1563032666168},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"bc3fc9d053b3d1fc0cd3918bf9a629a6f38f6414","modified":1563032666160},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"3da014b25f9ac804eda1614591706e3733c0d2c5","modified":1563032666161},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"280ff4282396beb53fb3913f58c6b5890bd1c9ef","modified":1563032666162},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"4e86e1ace90a70bb8862f5e6de9dbe7bfc046bee","modified":1563032666163},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"14bab3833728594ab31b3f83acba9e48502d18fc","modified":1563032666164},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"ab2940e5ab4ee035fe2fa0279bdaec3d63d09068","modified":1563032666164},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"b1b3778145dcfc27b58e3ecc32316ebe253793fa","modified":1563032666165},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"143ef265c96a8ea2fb93c36c5ffb9c5e940f7693","modified":1563032666175},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"078bd2d5815eb23e8c5f74467dc0042babea00ae","modified":1563032666176},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"d45ca53af17d1d83fd27f8ed0917a72f0060e1a9","modified":1563032666176},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"559a5cf167ac19a37149980666eb41be83dd8952","modified":1563082261030},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"07f7da320689f828f6e36a6123807964a45157a0","modified":1563032666268},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"1aabac9e37a8f4451c86d09037b3a1f8b30eaf5e","modified":1563032666270},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"601d87045fd6b372716eb345e6edfdf2524a8aea","modified":1563032666271},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"e9b0752f08398709e787546a246baca12b4c557f","modified":1563032666292},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"a25408534f8fe6e321db4bbf9dd03335d648fe17","modified":1563032666293},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"da7049f3d9a157abe0ecc62611edcf43605ba84d","modified":1563032666294},{"_id":"themes/next/source/images/20190713213835-3.jpg","hash":"0c9697db847fcc17b31f66f7e765b3419574df64","modified":1563025713350},{"_id":"themes/next/source/js/schemes/muse.js","hash":"5f65344737b6467140ea1d8b6d93ed332c401681","modified":1563032666318},{"_id":"themes/next/source/js/schemes/pisces.js","hash":"3eea56cc9ce47bb4760930c4c69cebf847a7fbb2","modified":1563032666319},{"_id":"themes/next/source/lib/canvas-nest/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1563080941088},{"_id":"themes/next/source/lib/canvas-nest/README.md","hash":"28bc2250a16e22c705cba7b3c17fcc15081e50f2","modified":1563080941091},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest-nomobile.min.js","hash":"6b4437a9cd8aa04329cc6220a595acfe1fb9b598","modified":1563080941093},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1563080941095},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"b4aefc910578d76b267e86dfffdd5121c8db9aec","modified":1563032666323},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"03ddbf76c1dd1afb93eed0b670d2eee747472ef1","modified":1563032666324},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"c31ff06a740955e44edd4403902e653ccabfd4db","modified":1563032666325},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1563032666325},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"71e7183634dc1b9449f590f15ebd7201add22ca7","modified":1563032666326},{"_id":"themes/next/source/lib/three/.gitignore","hash":"5767276045f60da2350895a59aa6e138b0e83294","modified":1563080762501},{"_id":"themes/next/source/lib/three/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1563080762510},{"_id":"themes/next/source/lib/three/README.md","hash":"6dd1906f6928a2d2dd5bfa12a28474e8cc650a77","modified":1563080762512},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"294caca93f6099ea1a5ee1370095484e84ade8f8","modified":1563080762516},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"b2e62e969b2f6322c5c6cbe657cd27cecda8eb6a","modified":1563080762519},{"_id":"themes/next/source/lib/three/gulpfile.js","hash":"8667c49d81292b55e4ec8c0ec9f8eb42f4ababab","modified":1563080762521},{"_id":"themes/next/source/lib/three/package.json","hash":"eab1fdcad97bba965dfd5024de8c93d086299f56","modified":1563080762535},{"_id":"themes/next/source/lib/three/renovate.json","hash":"767b077c7b615e20af3cf865813cd64674a9bea6","modified":1563080762543},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"fcbf7d8d7f22f0f90df11c587c10cc2a021087d7","modified":1563080762572},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"bf172816a9c57f9040e3d19c24e181a142daf92b","modified":1563032666342},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"dbbfb50f6502f6b81dcc9fee7b31f1e812da3464","modified":1563032666343},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"dde584994ac13dc601836e86f4cf490e418d9723","modified":1563032666344},{"_id":"themes/next/source/css/_variables/base.styl","hash":"ebc95eeb8966d17cdc7dd0de009deaef1fe65064","modified":1563032666296},{"_id":"themes/next/source/lib/jquery/index.js","hash":"b15f7cfa79519756dff1ad22553fd0ed09024343","modified":1563032666338},{"_id":"themes/next/.git/logs/refs/heads/master","hash":"62493953bd8a31a8242d40ac233c8b284cd46cdb","modified":1563032665990},{"_id":"themes/next/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1563032665981},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"5c0ca7f801859cff254d2f5b7d1a70d66ff61a8d","modified":1563032666204},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"463817cbbd804ce134cb3e7e721431cb0e1616f2","modified":1563032666204},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"9fd526db0527c71243f05e18086f937dc67b1c3e","modified":1563032666205},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"ff4489cd582f518bba6909a301ac1292a38b4e96","modified":1563032666206},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"997058180065d986e05df72992cc2cbfd7febd7e","modified":1563032666207},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"a4c6ee546a94fd69e5b7a1e4c054ab8cacb73d2a","modified":1563032666224},{"_id":"themes/next/source/css/_common/components/rainbow.styl","hash":"c9ec92ffc5bd3618989b0885311b001e5e5b8942","modified":1563032666239},{"_id":"themes/next/source/css/_common/components/scrollbar.styl","hash":"afdd21533db18d846e1a2663b1199761b1bd2c1e","modified":1563032666240},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"1a4ac0d119f2126ef8951897338706edce112235","modified":1563032666262},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"40144394fdfe05d400f39f6763f66f75479a2e34","modified":1563032666263},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"35c6fd7eab3779bd9e38b7ba8825ab0c67a1be7a","modified":1563032666264},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"26690b87bef6393b72fbdfb614d7069029fa54d8","modified":1563032666265},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"fec36a14080104b5862e9f021eab117d87c5f7c5","modified":1563032666266},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a17e2b871a335f290afb392a08f94fd35f59c715","modified":1563032666267},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"107f42aa590ec4ba0765a0bc5d735f0f09edc0ff","modified":1563032666267},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"d0e9065b0dbbc01811259f0597d1790268b4881b","modified":1563032666273},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"8da8416213127595dfc4d2b358639194647e7bd3","modified":1563032666274},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"b1025c421406d2c24cc92a02ae28c1915b01e240","modified":1563032666274},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"40f266e24af4dedc9497056ab18ebcfda38dd47d","modified":1563032666275},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"b0b4c91d2938d1dc24963349477bb5b473b7b5a7","modified":1563032666276},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"6aee54cd5a20181e18596565356bd54c66e33823","modified":1563032666278},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"8ff4159916aa7856355e52991a6992d3e3794ac5","modified":1563032666279},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"04706657af638f2746ae59520e6fc78577c7682c","modified":1563032666280},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"157e6915dcf5990566e463acffa71043b2651c07","modified":1563032666281},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"234b44cfd03f9c9e3e179ff5fd698ac876341913","modified":1563032666282},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"6aee54cd5a20181e18596565356bd54c66e33823","modified":1563032666283},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"51a1b2f9c55810006ea2dd4a4d6eea9661fe726b","modified":1563032666284},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"5d0adc62f06d8373119b4435d78c02a23659cbae","modified":1563032666272},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"b9619c9827f969ca2e2f5878552362a7b858918f","modified":1563032666286},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"e73d6da74c5755442e831d8fd7d922c5b32bd892","modified":1563032666287},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"1b6776ac58c122b35290549866d9e6f91591f6ef","modified":1563032666288},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"8a2b5b6ed1e83c9d5235d6dc5a89dc0be24319fd","modified":1563032666289},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b6555a2d9f45559ab789183ee67066f3b3ad844b","modified":1563032666290},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"adb7379f3b9001840eb38b260434e89365771a81","modified":1563032666291},{"_id":"themes/next/source/lib/canvas-nest/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1563080941035},{"_id":"themes/next/source/lib/canvas-nest/.git/config","hash":"78c4459d066ad795856608d603d780b53488073d","modified":1563080941053},{"_id":"themes/next/source/lib/canvas-nest/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1563080936759},{"_id":"themes/next/source/lib/canvas-nest/.git/index","hash":"c890372829df37a30db1838f20dae179ab73c694","modified":1563080941096},{"_id":"themes/next/source/lib/canvas-nest/.git/packed-refs","hash":"949c61b7ce3b6e582b7d47f985a3d13ddfbb82ca","modified":1563080941023},{"_id":"themes/next/source/lib/canvas-nest/.github/stale.yml","hash":"dbd5e6bf89b76ad1f2b081578b239c7ae32755af","modified":1563080941086},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"3655f1fdf1e584c4d8e8d39026093ca306a5a341","modified":1563032666327},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1563032666328},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"88af80502c44cd52ca81ffe7dc7276b7eccb06cf","modified":1563032666330},{"_id":"themes/next/source/lib/three/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1563080762384},{"_id":"themes/next/source/lib/three/.git/config","hash":"c9c13087a3f33e6f46cd35a93c8b9bdf27618852","modified":1563080762449},{"_id":"themes/next/source/lib/three/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1563080744539},{"_id":"themes/next/source/lib/three/.git/index","hash":"c0c967a093a41c871ce9e5be451e4d0c857f59b5","modified":1563080762587},{"_id":"themes/next/source/lib/three/.git/packed-refs","hash":"1ba693633e9d08fc243af9a2c3116b2cc530cf14","modified":1563080762354},{"_id":"themes/next/source/lib/three/.github/stale.yml","hash":"dbd5e6bf89b76ad1f2b081578b239c7ae32755af","modified":1563080762496},{"_id":"themes/next/source/lib/three/lib/CanvasRenderer.js","hash":"71141daa39bbcedcf14ae95c05023a57828a5a43","modified":1563080762525},{"_id":"themes/next/source/lib/three/lib/Projector.js","hash":"69725cd0af6868c5aa059343cc6e18e0c10b2f2e","modified":1563080762529},{"_id":"themes/next/source/lib/three/package-lock.json","hash":"9a1a0a9990ac708c32019beb47ff97146e4235ea","modified":1563080762533},{"_id":"themes/next/source/lib/three/src/canvas_lines.js","hash":"10795d7f1e5393b2b5e1529b017ee4e0ffe82ac9","modified":1563080762550},{"_id":"themes/next/source/lib/three/src/canvas_sphere.js","hash":"8381c792b161001a1b5cf39613c6d48e2588b3ce","modified":1563080762557},{"_id":"themes/next/source/lib/three/src/three-waves.js","hash":"ac382962d408f16acf07b925b94bb15495b5207c","modified":1563080762563},{"_id":"themes/next/source/images/home-bg-jeep.jpg","hash":"9a5f2927beb19c369ec732fe8a1c3d0d78fa2cdc","modified":1563023515642},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1563032666335},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1563032666336},{"_id":"themes/next/.git/logs/refs/remotes/origin/HEAD","hash":"62493953bd8a31a8242d40ac233c8b284cd46cdb","modified":1563032665980},{"_id":"themes/next/.git/objects/pack/pack-78b645dbf98020eb155eaa40a9ebf82758d404dc.idx","hash":"8c1aa978161d0c4942d187e25f67c795cb4feab0","modified":1563032665899},{"_id":"themes/next/source/css/_common/components/header/github-banner.styl","hash":"a8f4d4b86acaa34c99111b2dde5d0779cc7e0de6","modified":1563032666209},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d63e0cacc53dd375fcc113465a4328c59ff5f2c1","modified":1563032666211},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"33200f60bd6a8bbfc66dd49a239bcc75c2f564c1","modified":1563032666212},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"b8647d6140141b0a160607f6353e4d4594cca92e","modified":1563032666213},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"3a0efe849587b34f20d4e260028dc799215b0bb3","modified":1563032666213},{"_id":"themes/next/source/css/_common/components/highlight/copy-code.styl","hash":"ef8efb717aa8584b2e33463cd8fb3bb5f7cee230","modified":1563032666214},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"c9cfb4b99e1ec8ec9cf075cb761b8f7fa5fe63fd","modified":1563032666210},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"40a2bf42fe338d718dd9db663a0b4be75c726ed0","modified":1563032666215},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"f8f1ae0f8c10f1bd1e631f596fc03a61a93557eb","modified":1563032666217},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"2eb4f5803ea4701f676e93c1057aeaf8e6e8d633","modified":1563032666217},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"4e516548243365c64b64ae839339043a122750a5","modified":1563032666219},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"33adfbef469c935a2a92cbd0beb8712579d3e409","modified":1563032666220},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"e5a5f8747fdf2ca960e4e73c081b8952afd62224","modified":1563032666218},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"9a8fb61bd2d184de9d206e62ba8961d1845c5669","modified":1563032666221},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"4e3838d7ac81d9ad133960f0f7ed58a44a015285","modified":1563032666222},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"3019b488ca3badcc80ec3a961446281489ad9c34","modified":1563032666223},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"c97c819a65f6967485184399397601e5133deda6","modified":1563032666223},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"2df409df04fdb52d7234876a9f6e502edd4e3929","modified":1563032666208},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"62fbbd32cf5a99ae550c45c763a2c4813a138d01","modified":1563032666225},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"996111e51dd7208317ffe3508201515bcd431d7c","modified":1563032666226},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"fc94dd09b4245143b452d6cf2fc4c12134d99d6d","modified":1563032666227},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"a73346f999b31355075cd58637946a8950cf6f7e","modified":1563032666227},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"77391928e594a17aba2f1afc74ba17470e324a25","modified":1563032666228},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"b6a241626783d2ac115d683fd59ec283af68e5bb","modified":1563032666229},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"31bbaba8f9453a3315bce1abc1c00f3548bd339b","modified":1563032666230},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"13d365ee626c01f17ec664b3f54f51d8b9ee7cf4","modified":1563032666231},{"_id":"themes/next/source/css/_common/components/post/post-reading_progress.styl","hash":"4aad8e36178faaa71a767af0084d578df4c09f73","modified":1563032666232},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"ccd0b1309acff0c676fdcc848a8ae2d05f0369ab","modified":1563032666233},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"b2495ae5e04dcca610aacadc47881d9e716cd440","modified":1563032666234},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"5a982d8ef3b3623ea5f59e63728990f5623c1b57","modified":1563032666234},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"539fc0880b2e035e8316d5d4b423703195c1b7ba","modified":1563032666235},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"c8009fd9598a661b7d23158b5121b6ac266939e9","modified":1563032666236},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"981795aad232c8bd3f52a0ed8720db696d18a234","modified":1563032666237},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"d413301a6f27844a1f6e977e1ead9a628219fc57","modified":1563083306521},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"26a479b01d32a3447079cc4c9cfa4b52962544a7","modified":1563032666240},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"d660ac2a4a66491d1080cc49b89e366a688ac2fb","modified":1563032666241},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"03a4e75e963e3e7cc393d588b1495a88d52e0e40","modified":1563032666242},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-button.styl","hash":"b36eea093bd4b32056b5de6f370ff57e50b25a49","modified":1563032666243},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"499e508b63d49656c5f1d64df6e2cc51cd42b41a","modified":1563032666243},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"7e2ba73073daaea0a18c3d67ff137dd683af7011","modified":1563032666244},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"9204c79c05d620ecd5d411cdf11e27441b6281dc","modified":1563032666245},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"7874ed05005ff449b28e8e00c6d7bc9d35336009","modified":1563032666246},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"a24825049857d500036eef442791a2395cb67632","modified":1563032666247},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"fde59300ec38868676ff5ed495b9dc9b02d07ffc","modified":1563032666249},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"2d58ad90f148e845bc7023751a7a13260600f8d6","modified":1563032666250},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"ed3a2960ebce7396d1893bb8e08c99c7d9259140","modified":1563032666248},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"3dbfb77e37485b56dd11f3c78ac2667bcaad327c","modified":1563032666251},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"b43421291bf85b589e8d0ec853e238d36ab80631","modified":1563032666252},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"95a0ea1d02421c29240632e7fb8639c72aa6c420","modified":1563032666253},{"_id":"themes/next/source/css/_common/components/tags/pdf.styl","hash":"3baeeb51cfe123e99235ee1816d0e1f6a97c7852","modified":1563032666253},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"118e729e0698cd7fd159b06d6423f79dd45c65ee","modified":1563032666254},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"da7a21f5a2f7dcf4c5a4788d7670159ca4132b65","modified":1563032666255},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"4305813408a1cd6aba764a7769b94b081d383d4f","modified":1563032666256},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"6d71ed9d1f0eb7d1bec52c139aae258543421ccb","modified":1563032666257},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"ed8a12982c0497eeb9d7642781abeb801428f83d","modified":1563032666258},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"6880467b4f6d7b057fb8291aa10966429a0a3bff","modified":1563032666259},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"35dc9f3990fadff3ea038d4e8ac75923219886ed","modified":1563032666259},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"9801977a23268e36c5deefd270423f6f1a0c3bb2","modified":1563032666260},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"2a50a466d667274e597b4ed3ae2866ea00c4cc0d","modified":1563032666261},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"a07aa12cc36ac5c819670c2a3c17d07ed7a08986","modified":1563032666280},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/_sidebar.styl","hash":"41f70380a40d7e868f628601805cf1480ffefd6e","modified":1563032666284},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"1f09be9bb38411f0629b58c3b23873589a6dbcaa","modified":1563032666285},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1563080936761},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1563080936762},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1563080936763},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1563080936764},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1563080936765},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-commit.sample","hash":"33729ad4ce51acda35094e581e4088f3167a0af8","modified":1563080936766},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1563080936768},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1563080936769},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1563080936772},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1563080936775},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1563080936776},{"_id":"themes/next/source/lib/canvas-nest/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1563080936778},{"_id":"themes/next/source/lib/canvas-nest/.git/logs/HEAD","hash":"c65d1130b467d98d41fde56edfcda0ac55bdd310","modified":1563080941042},{"_id":"themes/next/source/lib/three/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1563080744543},{"_id":"themes/next/source/lib/three/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1563080744547},{"_id":"themes/next/source/lib/three/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1563080744552},{"_id":"themes/next/source/lib/three/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1563080744554},{"_id":"themes/next/source/lib/three/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1563080744559},{"_id":"themes/next/source/lib/three/.git/hooks/pre-commit.sample","hash":"33729ad4ce51acda35094e581e4088f3167a0af8","modified":1563080744563},{"_id":"themes/next/source/lib/three/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1563080744567},{"_id":"themes/next/source/lib/three/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1563080744572},{"_id":"themes/next/source/lib/three/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1563080744577},{"_id":"themes/next/source/lib/three/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1563080744580},{"_id":"themes/next/source/lib/three/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1563080744585},{"_id":"themes/next/source/lib/three/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1563080744593},{"_id":"themes/next/source/lib/three/.git/logs/HEAD","hash":"0fba33eb89f2a1060215586e959a24bb3677eb63","modified":1563080762406},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"4237c6e9d59da349639de20e559e87c2c0218cfd","modified":1563032666341},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1563032666333},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1563080940699},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/2a/f622a4d7df40a2708946e91d6d7a0df1dc468c","hash":"3da7207fb18d361b83c56f4e35f67e9e945abd82","modified":1563080940907},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1563080940716},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/44/6ddf9b6c0e5ade17ca5cb99f9b3a5300919c57","hash":"fb72799ff98445f72fda041337da4cf105d9dcba","modified":1563080940770},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/45/9262fe92f0115707bf8d8764f1886bc5e7c9e0","hash":"36040483f8af76775b7e4b6d87cec53729625399","modified":1563080940941},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/46/cad4f872aa93e813aed99547c4705322ca483f","hash":"b0465d3186e2d58a8a99c56c6e68aa2965a396d4","modified":1563080940480},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/50/dd2a6539498a70226c81a587db486b47e839ff","hash":"3844b0c815d0b4b32c6312c751a826bf9dc2c945","modified":1563080940495},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/51/7c5eb7dcc2cb9769efea2e7375ff6e04123150","hash":"ec53157077d47430f4729bf164999d18d370aeab","modified":1563080940779},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/5a/69ce9c2e4a1a34f6063ae9a121af1555669c69","hash":"dad25cc0f450e2827b5676975f4a70636e3fd2c8","modified":1563080940738},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/5e/8ae972c99b04af7dd56dabfc485e8fdae5094d","hash":"791b3349c5696ccacae00bffbdbb8d88a03e61a9","modified":1563080940509},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/69/39233ece53c9bdb9a1faf3271ed5768b034aad","hash":"5a770d418c1bb7b0f031f4d5416530002032fcf3","modified":1563080940761},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/69/a20d65d83035fdb01734a8eabe3340f740a4cb","hash":"9e95b02d8e43ec92e06bee3f60dffb74e8e7b9fa","modified":1563080940729},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/75/de2b8fa62d52690de32c351c63ab6446104ed5","hash":"52d10122d633ce4895a0690c5955e1b356f5a391","modified":1563080940923},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/7b/c7e3186212b6f2e06d3370502565e2c6326890","hash":"379f3c6486f589fc9c1ab07d0382adacf4f655a2","modified":1563080940537},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/90/f6477118d05f5f96ce0a63c6f18b7b2baea200","hash":"385f58e92981f27fa54eb52bf60424e87c70a9d8","modified":1563080940593},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/91/f99a0c53b26dd54f56b9e452c68f56b06f8f7e","hash":"3dca8a5629e66599b6e0f146aa32f1b7ce023d89","modified":1563080940865},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/86/1c9f4241fe0eb6af02ad770d5ce04c1f68972b","hash":"7005c3e36015a4af30d4b91bd5a849a7861a073e","modified":1563080940885},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/98/67d1132e0e50bbb7df754a63358d70741df6d5","hash":"3cb710a1faee73c08036f5e2df7df3a7ce29e9dd","modified":1563080940559},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/99/be66a33ab4ebc34f62f2880a0e0cc6d334d0f2","hash":"f2346fe8ddd7d7abf38f2946f3083d8150f502d2","modified":1563080940681},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/aa/da83ad9aa55faa2b34ede31b1d41e16966f80b","hash":"b304541ab95b7969a63ba2ec4f60f5391bd8bb44","modified":1563080940577},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/b1/bb278ca2e50dff1b343f9d5ca025272859432f","hash":"74f0afa72a30268d84613fb0d1d893bba866f01d","modified":1563080940814},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/bb/5755c22b6c1b7461319624f0f000bc947882ee","hash":"2b87a2a354a0fa77cbddf461b03b0b8e43c16a4f","modified":1563080940752},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/ca/3466a8cbf05c2982c58199d6ee71ec6d0271ca","hash":"a9b80b5d827b5e84229b1afd7920d9218dce610f","modified":1563080940645},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/d4/95d28a8fab74d23908f6ccef9e4db2625fbacb","hash":"59e6067b0a806deee7bda6460b36c0f63e2e1db5","modified":1563080940790},{"_id":"themes/next/source/lib/canvas-nest/.git/refs/heads/master","hash":"42b96d49f5eae1a58b8413a60a0c2699e94df28d","modified":1563080941041},{"_id":"themes/next/source/lib/three/.git/objects/03/c40a4b50e21c63a0e27b1fbcd014168ae3f6da","hash":"987ca2a1169e875a5ac73e8a1a906b9ae88d4d22","modified":1563080748793},{"_id":"themes/next/source/lib/three/.git/objects/03/eb19e6b3194a820c462bc63177b6fc2bda245f","hash":"0be88820832fa6ea30d56905e98b27798805dc92","modified":1563080749276},{"_id":"themes/next/source/lib/three/.git/objects/09/3d290f60c3b467d503633531d7ce7cdd42dd75","hash":"ab09bc8bfc9079e408dc6facc1bfd9aa5d6bdef9","modified":1563080760280},{"_id":"themes/next/source/lib/three/.git/objects/0b/de10292fcd5dd4b66d1bf60f62ea7d7a30b310","hash":"37710386189fe435ea20541a69c1a9b833b5f50b","modified":1563080749348},{"_id":"themes/next/source/lib/three/.git/objects/15/e42465bbd9589d2112d7fe3328bd7f85c6b24f","hash":"c28f5e24b9b15ecfddd666711c6d6ef57317cb29","modified":1563080760377},{"_id":"themes/next/source/lib/three/.git/objects/1a/f9d30697fd2194a4132a3a6647722be2eb75dc","hash":"0f686b4e26b1e751509ded8a2db697b1d7938004","modified":1563080748479},{"_id":"themes/next/source/lib/three/.git/objects/1b/3d1cd16f3e6ce99ea92c7e9c0b78ee30a8c346","hash":"16569e1c4912fd762f32b13de839d05b9c319e54","modified":1563080748590},{"_id":"themes/next/source/lib/three/.git/objects/1f/0b95a965630f47a7264fe9e9456ed7da36c2aa","hash":"6e98b6d7740bf53074339ce383089320fe1962b9","modified":1563080759831},{"_id":"themes/next/source/lib/three/.git/objects/21/77c1416c8e91ed918b6d3cf7f333d99d659a24","hash":"7330016805a652c2153bfcfbdd4c3c50e5b5a642","modified":1563080760333},{"_id":"themes/next/source/lib/three/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1563080748707},{"_id":"themes/next/source/lib/three/.git/objects/29/4f11136ee13277ee96ec3bb56d810f43655298","hash":"a294c3770aa5e7ed386075202f5b88048e1d170d","modified":1563080760234},{"_id":"themes/next/source/lib/three/.git/objects/34/cbb2a80da03e4d233dcfa3f11fed64894b2de5","hash":"ddf0c1fdb72ed14c50b1d1718a122f5f2a38a3ed","modified":1563080762166},{"_id":"themes/next/source/lib/three/.git/objects/36/3db3ce197d25b8c64db663aa9000a181511461","hash":"f87bc2ce87e37d0ee60eceef8be89dae4c52e01d","modified":1563080748880},{"_id":"themes/next/source/lib/three/.git/objects/3a/4c8581b3aa0d4f9192de158bd4223a90d646b5","hash":"a64efe9f8e2db0ff3cfb7b5e71fedf229ce290fd","modified":1563080748729},{"_id":"themes/next/source/lib/three/.git/objects/3a/ae52073909b7ccdbd43538ee6c814691935c57","hash":"652619b1d76f267c1646b6167de80f58a520525e","modified":1563080760414},{"_id":"themes/next/source/lib/three/.git/objects/3a/cef7449b991ee78bb5b7f2f121996b9ec9bba4","hash":"d9165d5939be17750b9edad5d0fc32029e4a23d6","modified":1563080749363},{"_id":"themes/next/source/lib/three/.git/objects/3c/6fef4314903036253335d4550346f6b927c721","hash":"1ee4e7d110363dc5e2676b675c7f7030731cf3a5","modified":1563080760166},{"_id":"themes/next/source/lib/three/.git/objects/3e/4151e56ef50d7ff46a1ce73156c35ac6f1224d","hash":"a47d2e1895903aa7e1b51d35731f212ffc6a1718","modified":1563080760351},{"_id":"themes/next/source/lib/three/.git/objects/3f/f2616b188ab71e1abf2029d7d55834c5643fc5","hash":"65bbc360ee3cc66fba71b9fb0baa3cff744327b9","modified":1563080748811},{"_id":"themes/next/source/lib/three/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1563080748685},{"_id":"themes/next/source/lib/three/.git/objects/42/d67e32b0d5f676f7462ad5b013f4eb8cad2486","hash":"fb1c4d377401f2145cc721d96fdf40d89ac23434","modified":1563080760726},{"_id":"themes/next/source/lib/three/.git/objects/52/71f18c203d24b27ec7bd977c2d5c61300cea1a","hash":"cdae53ba376df246585a2f44a86d0c7da98bca1f","modified":1563080760129},{"_id":"themes/next/source/lib/three/.git/objects/53/c865f8ff0aaa7ae2c8da7324dce73756ffe7c0","hash":"2d1c2dcfa342f46910a5698023b2c208bf3336e0","modified":1563080760429},{"_id":"themes/next/source/lib/three/.git/objects/64/d845d3aed3dce9eab9de39793f1c4d1d6e0deb","hash":"1c7346386e8c3d8830bf36bff7011976ba326b3e","modified":1563080760715},{"_id":"themes/next/source/lib/three/.git/objects/67/6b9f6189356d0201fd72dd6f98db19628a2ff5","hash":"250795ea0af79524945e66b28f233eb8bd9ee7dd","modified":1563080760110},{"_id":"themes/next/source/lib/three/.git/objects/69/a20d65d83035fdb01734a8eabe3340f740a4cb","hash":"9e95b02d8e43ec92e06bee3f60dffb74e8e7b9fa","modified":1563080748749},{"_id":"themes/next/source/lib/three/.git/objects/6b/128053933889f264c239abe0d381523daa8fa5","hash":"23df1e6daed83528bc2f36980678ecc31e17f09e","modified":1563080748903},{"_id":"themes/next/source/lib/three/.git/objects/6e/a4473e91dc2dbc452ff446e7cb04cb2ff16da0","hash":"710066cce498e372a932ff272d3d0eb4345fe3cf","modified":1563080748500},{"_id":"themes/next/source/lib/three/.git/objects/70/0960a662785b70b5c72909810794e1c18e9891","hash":"ea3c3330dd0a213a3cebdc42ee57d43fb8f9813c","modified":1563080759848},{"_id":"themes/next/source/lib/three/.git/objects/79/ae5f64ea4be7e1a108b2f1fc8afbca7bfa1fba","hash":"4e28517d80599b1a6051b1d3f657654aca6333b9","modified":1563080748763},{"_id":"themes/next/source/lib/three/.git/objects/7b/a927a3390f9a6345039cdb5bc54c6a54297f69","hash":"0d10f821d9e61a27c3f9d9e03e923265693d68ab","modified":1563080762139},{"_id":"themes/next/source/lib/three/.git/objects/7d/2bcbb026e4a38ab45317d8b78bfed70ba25c51","hash":"05394b260c2c58ee38b7224bb4ecb52df1e7f354","modified":1563080760396},{"_id":"themes/next/source/lib/three/.git/objects/7d/d7c1e8f79dc9a9a99e290147528d7a47d46830","hash":"c2104c89bcf686b243061b456ddc86d916b84360","modified":1563080749379},{"_id":"themes/next/source/lib/three/.git/objects/7f/6a7ddb8a04644dc980d83c9878b4621acf82f5","hash":"c517caf5d47c9f1eba2ced6800dab03e2e29a130","modified":1563080748604},{"_id":"themes/next/source/lib/three/.git/objects/80/5e5d92b903742c45e359b26a06cf86376301d8","hash":"6d39f5d10ed1e3acaaef5ac5999945b65ab12b88","modified":1563080759811},{"_id":"themes/next/source/lib/three/.git/objects/82/69b6fd29a514f9bd746497b298176228bd4061","hash":"cf527c08b5d88d72939a61446d128eba2fb94be2","modified":1563080760089},{"_id":"themes/next/source/lib/three/.git/objects/87/782e1008d1f88a9cb63d59407b1cb9e47b0861","hash":"0af5c5e17b27d8114fddd53d7cae8bb3284ae9af","modified":1563080748555},{"_id":"themes/next/source/lib/three/.git/objects/8a/2159d7a0c70d394071e8dcc79502d5cd1fc5e4","hash":"58ff19b7a9a65c9e562b9e1c7ee0ed3ac005b15d","modified":1563080760203},{"_id":"themes/next/source/lib/three/.git/objects/8e/3ea1a067348d2a9c066fbf201663b462a3ed6c","hash":"f3168176590ac08570ef75b73ecae2b4a455d753","modified":1563080748863},{"_id":"themes/next/source/lib/three/.git/objects/89/b7ae569312ae577534d7b58647232fb48bfb08","hash":"a265c0a7e24267bd82d11a48f091d2241edc0080","modified":1563080760263},{"_id":"themes/next/source/lib/three/.git/objects/a4/6866ca175f7c27daaf6b39c94d930bc27d4ce5","hash":"fc416f7f3f62c338bda28bb56bfa6f8fb49421ff","modified":1563080759794},{"_id":"themes/next/source/lib/three/.git/objects/a9/27aca23c7f27f5d1ebf2c4baea3aa5d8676143","hash":"dc3e5c853a502fbe7ea3e35c2f7a2bf94318ade4","modified":1563080748458},{"_id":"themes/next/source/lib/three/.git/objects/ae/8fa980e909988af2ebd9423658213d2e7e6bba","hash":"9978e4f223de97e23a047986bf21cbf48663a150","modified":1563080748519},{"_id":"themes/next/source/lib/three/.git/objects/b0/2d36d33210bc68d3e6451c663eb567ebc5721c","hash":"8d3bac2fa021a8f4609a134167edb84fd46254b2","modified":1563080748846},{"_id":"themes/next/source/lib/three/.git/objects/ce/175226253f7f31da632b93ab6560debab1bf6d","hash":"55c41b0948cb31fad3a52ab7ac91ba93e6c22751","modified":1563080748572},{"_id":"themes/next/source/lib/three/.git/objects/d0/32ce3fe05be57b72cc925f86149497229cda13","hash":"59e5036e95b496852ad3b918eac2e4b28a5951f2","modified":1563080760298},{"_id":"themes/next/source/lib/three/.git/objects/d2/a00ca1067b93b81dae8ea7d0c9838e935595e8","hash":"4b1ecd5271cdf94c10c2e413c7378adb22e940bb","modified":1563080760218},{"_id":"themes/next/source/lib/three/.git/objects/d8/8d5765694f92039daac0f944405d4cf61a0d13","hash":"70d2b236fcd955aa4fa95efc2e18c98919003ec6","modified":1563080748646},{"_id":"themes/next/source/lib/three/.git/objects/d9/0026fb76d55bba50ee4a221c887a0f1a8e8102","hash":"ac0ac5756be4b24f2249be101665ff29ed93d1f9","modified":1563080760183},{"_id":"themes/next/source/lib/three/.git/objects/d9/90e2654ec49768cd50d630db99ee00bee2b13c","hash":"6c5cc041391cb5a6b3e0f2f15f30bd62735ac7fa","modified":1563080749325},{"_id":"themes/next/source/lib/three/.git/objects/db/fc5bb53f0ee561f55b18c9796e1e03a9781153","hash":"3cda0d28ce918db5b722db817e69ea522a4db9ce","modified":1563080760360},{"_id":"themes/next/source/lib/three/.git/objects/df/932438893faefc6b9f5ba9191913dfeedc2a1c","hash":"ac939ae39ab04abc99c0caaef00849585ff4886d","modified":1563080760243},{"_id":"themes/next/source/lib/three/.git/objects/e0/52c7542703df4969a95779bd4dc58b568bcb5e","hash":"b1ccf1650011f74939f07233834bdff21baf4952","modified":1563080748625},{"_id":"themes/next/source/lib/three/.git/objects/e0/ced7e71c43a729f9653b1c4434b95724fc02ed","hash":"98c61b57d8e5e03cf30d402cfcb840c6e610aaa6","modified":1563080760148},{"_id":"themes/next/source/lib/three/.git/objects/e5/6e96bd99ebe3f0dc8f02c979703c3666f6dd9e","hash":"b971fcaae8424ea1b507379afdcdff74359a1525","modified":1563080760317},{"_id":"themes/next/source/lib/three/.git/objects/ea/7a1bbd08eb930b5f777ec025493ae0c8cb12d4","hash":"3c428fd65f982afbabbf683163bcc88a4eb4cda0","modified":1563080748532},{"_id":"themes/next/source/lib/three/.git/objects/ec/00e107b97a0b7a9850219894bf4e533c68bf87","hash":"5b7f94788c3c19c8a0f73f1b712d5d79e0236668","modified":1563080749286},{"_id":"themes/next/source/lib/three/.git/objects/f4/5d8f110c3034162a1091dafe4b03d2e56b323e","hash":"963dad8248030a8d7b185f4726e40a65a0583c0e","modified":1563080749304},{"_id":"themes/next/source/lib/three/.git/objects/fa/be1d6949c228188d07df0f4b99b217c7b7f92e","hash":"de53b76740aff0953bcd79853d8addfabfc29f95","modified":1563080748668},{"_id":"themes/next/source/lib/three/.git/objects/fe/47fa8f2d9edef52a8ea859537c9286363ee168","hash":"dfaa57c592a229b220a7241bbd0567ec38f4e578","modified":1563080748834},{"_id":"themes/next/source/lib/three/.git/refs/heads/master","hash":"6a105fd9e84319ebcdea881ebbd3e924c9e41162","modified":1563080762403},{"_id":"themes/next/source/lib/canvas-nest/.git/logs/refs/heads/master","hash":"c65d1130b467d98d41fde56edfcda0ac55bdd310","modified":1563080941043},{"_id":"themes/next/source/lib/canvas-nest/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1563080941033},{"_id":"themes/next/source/lib/three/.git/logs/refs/heads/master","hash":"0fba33eb89f2a1060215586e959a24bb3677eb63","modified":1563080762415},{"_id":"themes/next/source/lib/three/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1563080762375},{"_id":"themes/next/source/lib/three/.git/objects/76/310b5a7e93e66e7d98aaab2960d6354b2288c5","hash":"84de52193b47c83d01eb8800b063ccd83ad42cf9","modified":1563080759228},{"_id":"themes/next/source/lib/three/three.min.js","hash":"26273b1cb4914850a89529b48091dc584f2c57b8","modified":1563080762582},{"_id":"themes/next/source/lib/canvas-nest/.git/logs/refs/remotes/origin/HEAD","hash":"c65d1130b467d98d41fde56edfcda0ac55bdd310","modified":1563080941032},{"_id":"themes/next/source/lib/three/.git/logs/refs/remotes/origin/HEAD","hash":"0fba33eb89f2a1060215586e959a24bb3677eb63","modified":1563080762374},{"_id":"themes/next/.git/objects/pack/pack-78b645dbf98020eb155eaa40a9ebf82758d404dc.pack","hash":"023125753a0a20255618e7e32d3472e26d26f2ce","modified":1563032665908},{"_id":"public/search.xml","hash":"f72bdc6fb43320198cb69689bfb5d4d90a0d9eba","modified":1563111765408},{"_id":"public/categories/index.html","hash":"5df930d3b3d0aa3cfb1e1f82259be22904da3b10","modified":1563111765424},{"_id":"public/about/index.html","hash":"cab80c253b78c8fecb9c4b1f6fe358e47b2871fd","modified":1563111765424},{"_id":"public/tags/index.html","hash":"f4e17d03734191161c3dcc90f585007a9648e8a6","modified":1563111765424},{"_id":"public/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/index.html","hash":"99510b625ee4128962b91aa1076c884a3c57026a","modified":1563111765424},{"_id":"public/2019/07/14/Linux-network-proxy-setup-desktop-and-terminal/index/index.html","hash":"4cc56580bbdc9272f11a4f7a56d6748ba34bf829","modified":1563111765424},{"_id":"public/2019/07/14/Harshicorp-vault-setup-Config/index/index.html","hash":"1167d9ec1bc986b892e74fcbef9ceaee13028860","modified":1563111765425},{"_id":"public/archives/index.html","hash":"014609a58fcca4214901e9ffd389cacb9792c3ab","modified":1563111765425},{"_id":"public/archives/2019/index.html","hash":"03dd8351b73efd5da6330d6983b4bdc1661f2163","modified":1563111765425},{"_id":"public/archives/2019/07/index.html","hash":"b1732abe74c3bf7918ffa8983474b41092736a24","modified":1563111765425},{"_id":"public/categories/Microservices/index.html","hash":"c33ae5ad7ddd1860b8244f3a19005d994447d0d8","modified":1563111765425},{"_id":"public/categories/Infra/index.html","hash":"c59a0b3d2c1446ac140cb6c166c2aa5227fcacfa","modified":1563111765425},{"_id":"public/index.html","hash":"483cadb1868b6f60f6cf3eb3cb99c84462fed68d","modified":1563111765425},{"_id":"public/tags/Harshicorp/index.html","hash":"3158b8c369a21393bc93795d494e160c231d598a","modified":1563111765425},{"_id":"public/tags/Docker/index.html","hash":"414c391dd60099691e42c85190d2fec757a963d8","modified":1563111765426},{"_id":"public/tags/Microservices/index.html","hash":"ebf64f94013f7d60072e9361bb98a9b24face4b4","modified":1563111765426},{"_id":"public/tags/Certbot/index.html","hash":"5cd88cc2f6dce902ade324a064b863d525edc689","modified":1563111765426},{"_id":"public/tags/Let’s-Encrypt/index.html","hash":"5bd6b3f0d49040c75970eb53166a79b7a1d5cd61","modified":1563111765426},{"_id":"public/tags/Nginx/index.html","hash":"4395b4cca18bc3cafef417f1df3d02c79e2d33ad","modified":1563111765426},{"_id":"public/tags/Shadowsocks/index.html","hash":"fe8a02a1031498de0db37176e35178b9b6b13c4e","modified":1563111765426},{"_id":"public/tags/Proxychain/index.html","hash":"a290cbb4cf096ff0fa1f2a11194cf30f86bf7c70","modified":1563111765426},{"_id":"public/tags/Proxy/index.html","hash":"8416b680a62df33f2c9ee856fe7cb6660bc52832","modified":1563111765427},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1563111765440},{"_id":"public/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1563111765440},{"_id":"public/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1563111765441},{"_id":"public/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1563111765441},{"_id":"public/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1563111765441},{"_id":"public/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1563111765441},{"_id":"public/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1563111765441},{"_id":"public/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1563111765441},{"_id":"public/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1563111765441},{"_id":"public/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1563111765441},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1563111765442},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1563111765442},{"_id":"public/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1563111765442},{"_id":"public/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1563111765442},{"_id":"public/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1563111765442},{"_id":"public/lib/canvas-nest/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1563111765442},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1563111765442},{"_id":"public/lib/three/LICENSE","hash":"336611e76f0638d3d8aeca6b1b97138d2a07523f","modified":1563111765442},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1563111765442},{"_id":"public/2019/07/14/Linux-network-proxy-setup-desktop-and-terminal/index/15532408-1405d25f0bcee21b.png","hash":"5466cb8e58e14b5468d6f3f3e04899a1443309ef","modified":1563111765442},{"_id":"public/2019/07/14/Harshicorp-vault-setup-Config/index/15532408-351f3fa54f1ebc1a.png","hash":"c1412da8605a160e16be667b5c6d2a1d13eebfb3","modified":1563111765442},{"_id":"public/2019/07/14/Harshicorp-vault-setup-Config/index/15532408-698c9ee3afd1d4f9.png","hash":"874a89684c1fba27abbb688824cf9ad7159b604a","modified":1563111765442},{"_id":"public/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/20190714194434.png","hash":"694974e10a9c5ba363e25c101bd59569d8701d82","modified":1563111765442},{"_id":"public/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/20190714195417.png","hash":"106217b2e63837c89cf620008ca99cd6508fe733","modified":1563111765443},{"_id":"public/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/debug.log","hash":"9ef4faa329db5d25135da946c875d48caa59cd31","modified":1563111765443},{"_id":"public/about/index/20190713213835-4.jpg","hash":"af4250dd4bf39788fb53e291cc682296073785df","modified":1563111766082},{"_id":"public/images/20190713213835-4.jpg","hash":"af4250dd4bf39788fb53e291cc682296073785df","modified":1563111766085},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1563111766085},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1563111766085},{"_id":"public/js/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1563111766091},{"_id":"public/js/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1563111766091},{"_id":"public/js/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1563111766092},{"_id":"public/js/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1563111766092},{"_id":"public/js/motion.js","hash":"ca2965da47ba9fc5b0dde0a825c29e0817b965b9","modified":1563111766092},{"_id":"public/js/post-details.js","hash":"a614a3830f7dfcd4df303c1255d558a135b3854e","modified":1563111766092},{"_id":"public/js/next-boot.js","hash":"d673f486417eaf1925ffecc3c4720850cad2ada3","modified":1563111766092},{"_id":"public/js/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1563111766092},{"_id":"public/js/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1563111766092},{"_id":"public/js/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1563111766092},{"_id":"public/js/schemes/muse.js","hash":"d6e4d1c937387d0d7891a41305ecdfe5597d6136","modified":1563111766092},{"_id":"public/lib/canvas-nest/canvas-nest-nomobile.min.js","hash":"956eada198babd00f028e8908767cb158926c3f3","modified":1563111766092},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1563111766092},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1563111766092},{"_id":"public/lib/three/gulpfile.js","hash":"e0e9e7051d9d82a37c2aba1df396d8b3916323c4","modified":1563111766092},{"_id":"public/lib/three/renovate.json","hash":"94990e0ad04ce4a7c6f0ac3543318d9e02db1264","modified":1563111766092},{"_id":"public/lib/three/package.json","hash":"b26242f5b3aa082ae137c437e2e9ee2a7094028b","modified":1563111766092},{"_id":"public/lib/three/src/canvas_sphere.js","hash":"7614790c67d3e79e3390fe688f6b01afad7e3bb1","modified":1563111766093},{"_id":"public/lib/three/src/canvas_lines.js","hash":"650310ff6783671f8ceccf01f840b20d9c87b491","modified":1563111766093},{"_id":"public/lib/three/src/three-waves.js","hash":"e98e442f14920e9fb8691846dca3a2225d403048","modified":1563111766093},{"_id":"public/lib/canvas-nest/README.html","hash":"ff1e1f2071d6b0b21abf9fbe1e58411d2e9b77fa","modified":1563111766093},{"_id":"public/lib/three/README.html","hash":"353b8970d56f6c865bf82e5b9e580e0a84ebee74","modified":1563111766093},{"_id":"public/css/main.css","hash":"7564c344823ca716ea0aa7ce33c079130f745e2e","modified":1563111766093},{"_id":"public/images/20190713213835-3.jpg","hash":"0c9697db847fcc17b31f66f7e765b3419574df64","modified":1563111766093},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1563111766093},{"_id":"public/js/utils.js","hash":"cdb827a84df4330c728dbe5e50129a48ac33de01","modified":1563111766097},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1563111766098},{"_id":"public/lib/three/canvas_lines.min.js","hash":"294caca93f6099ea1a5ee1370095484e84ade8f8","modified":1563111766106},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"b2e62e969b2f6322c5c6cbe657cd27cecda8eb6a","modified":1563111766106},{"_id":"public/lib/three/three-waves.min.js","hash":"fcbf7d8d7f22f0f90df11c587c10cc2a021087d7","modified":1563111766107},{"_id":"public/lib/three/lib/Projector.js","hash":"1ad16e96cea2a8a9155bb429c83ef9bdd341ce99","modified":1563111766107},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1563111766113},{"_id":"public/lib/three/lib/CanvasRenderer.js","hash":"cf8e1ce6e884023ad0d692cf30f399862407fb40","modified":1563111766113},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1563111766116},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1563111766116},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1563111766117},{"_id":"public/images/home-bg-jeep.jpg","hash":"9a5f2927beb19c369ec732fe8a1c3d0d78fa2cdc","modified":1563111766117},{"_id":"public/lib/jquery/index.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1563111766129},{"_id":"public/lib/three/package-lock.json","hash":"18a22a7eadc46729ed033b9318a9dc9b8aed5ba0","modified":1563111766139},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1563111766143},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1563111766148}],"Category":[{"name":"Microservices","_id":"cjy30duh8000564m7w3xm4pvx"},{"name":"Infra","_id":"cjy30duhc000864m748dkqk71"}],"Data":[],"Page":[{"title":"categories","date":"2019-07-14T00:54:47.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2019-07-14 08:54:47\ntype: \"categories\"\ncomments: false\n---\n","updated":"2019-07-14T00:55:22.195Z","path":"categories/index.html","layout":"page","_id":"cjy30du4t000064m7xgla9l6n","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"Jamie","date":"2019-07-14T01:54:06.000Z","_content":"![](/images/20190713213835-4.jpg)  **_Jamie Zhang_** is from Shannxi China. He has more than 9 years of experience in web/mobile application development and management,\nparticipated in a number of large-scale projects in Huawei & HSBC.\n\nHe loves open source and likes learning new technologies.\n\nHe also has strong interests in various tech stuff such as Artificial Intelligence, Microservice, Cloud native.\n\nHe is happy with his current job, but also willing to take new challenges if the opportunity matches his career path.\n\nFeel free to connect Jamie via Github (https://github.com/akjamie) or drop him an email (akjamie.zhang@gmail.com).\n\n","source":"about/index.md","raw":"---\ntitle: Jamie\ndate: 2019-07-14 09:54:06\n---\n![](/images/20190713213835-4.jpg)  **_Jamie Zhang_** is from Shannxi China. He has more than 9 years of experience in web/mobile application development and management,\nparticipated in a number of large-scale projects in Huawei & HSBC.\n\nHe loves open source and likes learning new technologies.\n\nHe also has strong interests in various tech stuff such as Artificial Intelligence, Microservice, Cloud native.\n\nHe is happy with his current job, but also willing to take new challenges if the opportunity matches his career path.\n\nFeel free to connect Jamie via Github (https://github.com/akjamie) or drop him an email (akjamie.zhang@gmail.com).\n\n","updated":"2019-07-14T06:33:06.670Z","path":"about/index.html","comments":1,"layout":"page","_id":"cjy30ducm000164m7lnpvjpsg","content":"<p><img src=\"/images/20190713213835-4.jpg\" alt>  <strong><em>Jamie Zhang</em></strong> is from Shannxi China. He has more than 9 years of experience in web/mobile application development and management,<br>participated in a number of large-scale projects in Huawei &amp; HSBC.</p>\n<p>He loves open source and likes learning new technologies.</p>\n<p>He also has strong interests in various tech stuff such as Artificial Intelligence, Microservice, Cloud native.</p>\n<p>He is happy with his current job, but also willing to take new challenges if the opportunity matches his career path.</p>\n<p>Feel free to connect Jamie via Github (<a href=\"https://github.com/akjamie\" target=\"_blank\" rel=\"noopener\">https://github.com/akjamie</a>) or drop him an email (<a href=\"mailto:akjamie.zhang@gmail.com\" target=\"_blank\" rel=\"noopener\">akjamie.zhang@gmail.com</a>).</p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"/images/20190713213835-4.jpg\" alt>  <strong><em>Jamie Zhang</em></strong> is from Shannxi China. He has more than 9 years of experience in web/mobile application development and management,<br>participated in a number of large-scale projects in Huawei &amp; HSBC.</p>\n<p>He loves open source and likes learning new technologies.</p>\n<p>He also has strong interests in various tech stuff such as Artificial Intelligence, Microservice, Cloud native.</p>\n<p>He is happy with his current job, but also willing to take new challenges if the opportunity matches his career path.</p>\n<p>Feel free to connect Jamie via Github (<a href=\"https://github.com/akjamie\" target=\"_blank\" rel=\"noopener\">https://github.com/akjamie</a>) or drop him an email (<a href=\"mailto:akjamie.zhang@gmail.com\" target=\"_blank\" rel=\"noopener\">akjamie.zhang@gmail.com</a>).</p>\n"},{"title":"tags","date":"2019-07-14T00:51:11.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2019-07-14 08:51:11\ntype: \"tags\"\ncomments: false\n---\n","updated":"2019-07-14T00:54:30.093Z","path":"tags/index.html","layout":"page","_id":"cjy30duco000264m7i2xjkzzu","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Harshicorp vault setup & Config","date":"2019-07-14T01:08:03.000Z","_content":"## Install vault\n* Prepare *docker-compose.yml*,  content as below (just a sample here, please don't use it for production, there are more aspects should be considered)\n<!--more-->\n```\n    version: '3'\n    services:\n        consul:\n            container_name: consul.server\n            command: agent -server -bind 0.0.0.0 -client 0.0.0.0 -bootstrap-expect=1\n            image: consul:latest\n            restart: always\n            volumes:\n              - ./consul.server/config:/consul/config\n              - ./consul.server/data:/consul/data\n            ports:\n              - \"9300:9300\"\n              - \"9500:9500\"\n              - \"9600:9600/udp\"\n        vault:\n            container_name: vault.server\n            image: vault\n            ports:\n            - \"8200:8200\"\n            restart: always\n            links:\n                - consul:consul.server\n            volumes:\n            - ./vault.server/config:/mnt/vault/config\n            - ./vault.server/data:/mnt/vault/data\n            - ./vault.server/logs:/mnt/vault/logs\n            - ./vault.server/config:/vault/config\n            - /etc/letsencrypt:/etc/letsencrypt\n            cap_add:\n            - IPC_LOCK\n            command: server\n```\n- *consul config - config.json*\n```\n   {\n     \"datacenter\": \"data-center-1\",\n     \"node_name\": \"master-node\",\n     \"log_level\": \"INFO\",\n     \"server\": true,\n     \"data_dir\": \"/consul/data\",\n     \"ui\" : true,\n     \"ports\": {\n       \"http\": 8500,\n       \"server\": 8300\n     }\n   } \n```\n- *vault config - vault.hcl*\n```ui = true\nbackend \"consul\" {\n        address = \"consul:8500\"\n        advertise_addr = \"http://consul:8300\"\n        scheme = \"http\"\n}\nlistener \"tcp\" {\n    address = \"0.0.0.0:8200\n    tls_disable = 1\n}\ndisable_mlock = true\n```\n- Use docker-compose up -d to run these services, and check its status\n![](15532408-351f3fa54f1ebc1a.png)\n![](15532408-698c9ee3afd1d4f9.png)\n## Configure the vault\nin #1, we created the vault container, but vault is still in uninitialized status (unsealed)\n- Vault init\n\n```\n    curl -X PUT \\\n      https://demo.xxx.com/vault/v1/sys/init \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: cb5d640a-152e-844f-cda3-5e8be4e3eec3' \\\n      -d '{\"secret_shares\":5, \"secret_threshold\":2}'\n      \n      {\n        \"keys\": [\n            \"977595193b3a8cb4ae70338859f0a7264b2757775a51cca461731b1bff4b61798f\",\n            \"9f6c61623da515b36671ca2677f5be084f670751e2da6a05d88970ebe832d6430b\",\n            \"d1f13304840d0445e23ebe7ea39d23dc6821ddcb9fc97ce5ea2c8a9e82ca132ca0\",\n            \"d49bda98c1723e659f5bb87af7774988e709ff9ad4337dc4c4851cf8a89c7dfd7f\",\n            \"dfa480970d31b18b7c7943211cdd76636f51b17a55ee2d7a6718052a50d7198847\"\n        ],\n        \"keys_base64\": [\n            \"l3WVGTs6jLSucDOIWfCnJksnV3daUcykYXMbG/9LYXmP\",\n            \"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\",\n            \"0fEzBIQNBEXiPr5+o50j3Ggh3cufyXzl6iyKnoLKEyyg\",\n            \"1JvamMFyPmWfW7h693dJiOcJ/5rUM33ExIUc+Kicff1/\",\n            \"36SAlw0xsYt8eUMhHN12Y29RsXpV7i16ZxgFKlDXGYhH\"\n        ],\n        \"root_token\": \"s.nBXC2nmVs7IVLHk6zsU7ZoaT\"\n       }\n```\n- Vault unseal\n```\n    curl -X PUT \\\n      https://demo.xxx.com/vault/v1/sys/unseal \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: a43db86c-26d4-de01-9a13-eefc23857eb7' \\\n      -d '{\"key\": \"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\"}'\n      \n      {\n        \"type\": \"shamir\",\n        \"initialized\": true,\n        \"sealed\": false,\n        \"t\": 2,\n        \"n\": 5,\n        \"progress\": 0,\n        \"nonce\": \"\",\n        \"version\": \"1.1.0\",\n        \"migration\": false,\n        \"cluster_name\": \"vault-cluster-8492c510\",\n        \"cluster_id\": \"c73cee19-c9ab-81f1-9563-8fd060084370\",\n        \"recovery_seal\": false\n      }\n```\n- create read/write token\na. create admin policy\n```\n    curl -X POST \\\n      https://demo.xxx.com/vault/v1/sys/policy/admin-policy \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: c03aae97-d6c1-fa79-f8d5-f4476fe8347a' \\\n      -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT' \\\n      -d '{\"policy\":\"{\\\"path\\\":{\\\"secret/*\\\":{\\\"capabilities\\\":[\\\"create\\\", \\\"read\\\", \\\"update\\\", \\\"delete\\\", \\\"list\\\"]}}}\"}'\n```\nb.create user policy\nsimilar request as step <label style=\"color:red\">create admin-policy</label>\nc.check the policy we created\n```\n    curl -X GET \\\n      https://demo.xxx.com/vault/v1/sys/policy/admin-policy \\\n      -H 'Accept: application/json' \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Postman-Token: 6874a6ca-070c-8d20-f4bb-183e1ff663d1' \\\n      -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT'\n      \n    {\n        \"name\": \"admin-policy\",\n        \"rules\": \"{\\\"path\\\":{\\\"secrets/*\\\":{\\\"capabilities\\\":[\\\"create\\\", \\\"read\\\", \\\"update\\\", \\\"delete\\\", \\\"list\\\"]}}}\",\n        \"request_id\": \"51ba3350-f14d-0e3f-27b4-610b6442d296\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 0,\n        \"data\": {\n            \"name\": \"admin-policy\",\n            \"rules\": \"{\\\"path\\\":{\\\"secret/*\\\":{\\\"capabilities\\\":[\\\"create\\\", \\\"read\\\", \\\"update\\\", \\\"delete\\\", \\\"list\\\"]}}}\"\n        },\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": null\n    }  \n```\n- Create Token for above two newly created policies\n```\n    curl -X POST \\\n      https://demo.xxx.com/vault/v1/auth/token/create \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 21ef1963-b06d-b4ea-547c-03539a681ca5' \\\n      -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT' \\\n      -d '{\"policies\": [\"admin-policy\"]}'\n    \n    {\n        \"request_id\": \"a5251b70-e14c-5c56-a81e-6ad59445a44f\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 0,\n        \"data\": null,\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": {\n            \"client_token\": \"s.AXTHvuudLS6C4PYjSvLLabr9\",\n            \"accessor\": \"wVg70OelyhDMwa4MojtCKeZ1\",\n            \"policies\": [\n                \"admin-policy\",\n                \"default\"\n            ],\n            \"token_policies\": [\n                \"admin-policy\",\n                \"default\"\n            ],\n            \"metadata\": null,\n            \"lease_duration\": 2764800,\n            \"renewable\": true,\n            \"entity_id\": \"\",\n            \"token_type\": \"service\",\n            \"orphan\": false\n        }\n    }\n    \n    {\n        \"request_id\": \"35212529-0b4c-3c50-0489-94df50a5f781\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 0,\n        \"data\": null,\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": {\n            \"client_token\": \"s.7A1UuLB7aJdiGhn5Qaj2FlxN\",\n            \"accessor\": \"8H2pMpG4SnKHMgH8nr56FsUJ\",\n            \"policies\": [\n                \"default\",\n                \"user-policy\"\n            ],\n            \"token_policies\": [\n                \"default\",\n                \"user-policy\"\n            ],\n            \"metadata\": null,\n            \"lease_duration\": 2764800,\n            \"renewable\": true,\n            \"entity_id\": \"\",\n            \"token_type\": \"service\",\n            \"orphan\": false\n        }\n    }\n```\n- Try to use above token to read/write data\n$\\color{red}{Admin-token}$ to put key/value, otherwise got <label style=\"color:red\">error occurred:permission denied</label>\n```\n    curl -X POST \\\n      https://demo.xxx.com/vault/v1/secret/test \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 0b3cd187-14fd-c94f-9198-794e71b906af' \\\n      -H 'X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9' \\ \n     \n      -d '{\n    \t\"token\":\"test-token\"\n    }'\n<label style=\"color:red\">user-token</label> to get key/value\n\n    curl -X GET \\\n      https://demo.xxx.com/vault/v1/secret/test \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 2f1e1e02-db11-5fdc-426e-ad0adc735b47' \\\n      -H 'X-Vault-Token: s.7A1UuLB7aJdiGhn5Qaj2FlxN' \n    \n    {\n        \"request_id\": \"8a1dfacd-7514-ae7d-8133-d3295fafb394\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 2764800,\n        \"data\": {\n            \"token\": \"test-token\"\n        },\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": null\n    }\n```\n  #####Q1: no handler for route 'secret/test'\ncheck secrets engine if corresponding is enabled or not, commands: \na. docker exec -it <container-name> /bin/sh\nb.set VAULT_ADDR=http://127.0.0.1:8200, and VAULT_TOKEN={root token}\nc. vault secrets list, to list out all secrets, by default,  kv secrets engine at: secret/ should be enabled, if not found, please move forward to #d\nd. vault secrets enable -path=secret kv\ne. test the secrets engine, vault kv put secret/hello foo=world excited=yes \nf. vault kv get secret/hello, to check the data u've just pushed\n\n## Springboot application intergrates with Vault\n- create project - *vault-test*, and import related maven dependencies\n```\n    <properties>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <spring.cloud.version>Greenwich.RELEASE</spring.cloud.version>\n    </properties>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.3.RELEASE</version>\n    </parent>\n\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>${spring.cloud.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-vault-config</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-vault-config-databases</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n            <exclusions>\n                <exclusion>\n                    <groupId>junit</groupId>\n                    <artifactId>junit</artifactId>\n                </exclusion>\n            </exclusions>\n        </dependency>\n\n        <dependency>\n            <groupId>org.junit.jupiter</groupId>\n            <artifactId>junit-jupiter-api</artifactId>\n            <scope>test</scope>\n        </dependency>\n\n        <dependency>\n            <groupId>org.junit.jupiter</groupId>\n            <artifactId>junit-jupiter-engine</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-devtools</artifactId>\n            <optional>true</optional>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-configuration-processor</artifactId>\n            <optional>true</optional>\n        </dependency>\n\n    </dependencies>\n```\n- Prepare test data\n```\n    curl -X POST \\\n      https://demo.xxx.com/v1/secret/vault-test \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 6cad13c9-14d3-8260-dd74-6cef2b2ee822' \\\n      -H 'X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9' \\\n      -d '{\n    \t\"username\":\"Jamie\",\n    \t\"password\":\"Hlhjjj&jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\"\n    }'\n```\n- Configure Spring Vault in src/main/resources/bootstrap.yml\n```\n    server:\n      port: 8084\n    \n    logging.level.org.springframework.vault: DEBUG\n    \n    spring:\n      application:\n        name: vault-test\n    spring.cloud:\n        vault:\n          host: demo.xxx.com\n          port: 443\n          scheme: https\n          authentication: TOKEN\n          config:\n              order: -10\n          kv:\n            application-name: vault-test\n            default-context: vault-test\n            backend: secret\n            enabled: true\n            profile-separator: /\n          token: s.7A1UuLB7aJdiGhn5Qaj2FlxN  \n```\n- Impl a controller to inject the data loaded from vault\n```\n    @RestController\n    public class TestController {\n    \n    \t@Value(\"${username:test}\")\n    \tprivate String userName;\n    \n    \t@Value(\"${password:test}\")\n    \tprivate String password;\n    \n    \t@GetMapping(\"/\")\n    \t@ResponseBody\n    \tpublic Map<String, String> test() {\n    \t\tMap<String, String> rsp = new HashMap<String, String>();\n    \t\trsp.put(\"userName\", userName);\n    \t\trsp.put(\"password\", password);    \n    \t\treturn rsp;\n    \t}    \n    }\n```\n>Findings found during testing:\n*if change the spring.cloud.vault.config.order to a lower value, for example -100, the configs loaded from vault can take effects on spring auto-configured beans, like HikaiCP datasource, can put credentials onto vault in k/v format rather than keep these sensitive data in explicit config file, spring.datasource.username=xxx,spring.datasource.password=xxx*\n\n- Test it\n```\n    curl -X GET \\\n      http://localhost:8084/ \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Postman-Token: 9466ffbc-e8d5-355f-cb2c-c29907a5af9d'\n    \n    {\n        \"password\": \"Hlhjjj&jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\",\n        \"userName\": \"Jamie\"\n    }\n```\nyou can find sources code on [github](https://github.com/cloud-poc/springboot-vault-test)\n\nReferenced posts: \n[https://www.vaultproject.io/docs/concepts/policies.html](https://www.vaultproject.io/docs/concepts/policies.html)\n[https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running](https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running)\n[https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine](https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine)\n[https://www.jianshu.com/p/267f2d9ae87e](https://www.jianshu.com/p/267f2d9ae87e)\n[https://blog.51cto.com/7308310/2338146?source=dra](https://blog.51cto.com/7308310/2338146?source=dra)\n\n","source":"_posts/Harshicorp-vault-setup-Config/index.md","raw":"---\ntitle: Harshicorp vault setup & Config\ndate: 2019-07-14 09:08:03\ncategories: \"Microservices\"\ntags: #文章標籤 可以省略\n     - Harshicorp\n     - Docker\n     - Microservices\n---\n## Install vault\n* Prepare *docker-compose.yml*,  content as below (just a sample here, please don't use it for production, there are more aspects should be considered)\n<!--more-->\n```\n    version: '3'\n    services:\n        consul:\n            container_name: consul.server\n            command: agent -server -bind 0.0.0.0 -client 0.0.0.0 -bootstrap-expect=1\n            image: consul:latest\n            restart: always\n            volumes:\n              - ./consul.server/config:/consul/config\n              - ./consul.server/data:/consul/data\n            ports:\n              - \"9300:9300\"\n              - \"9500:9500\"\n              - \"9600:9600/udp\"\n        vault:\n            container_name: vault.server\n            image: vault\n            ports:\n            - \"8200:8200\"\n            restart: always\n            links:\n                - consul:consul.server\n            volumes:\n            - ./vault.server/config:/mnt/vault/config\n            - ./vault.server/data:/mnt/vault/data\n            - ./vault.server/logs:/mnt/vault/logs\n            - ./vault.server/config:/vault/config\n            - /etc/letsencrypt:/etc/letsencrypt\n            cap_add:\n            - IPC_LOCK\n            command: server\n```\n- *consul config - config.json*\n```\n   {\n     \"datacenter\": \"data-center-1\",\n     \"node_name\": \"master-node\",\n     \"log_level\": \"INFO\",\n     \"server\": true,\n     \"data_dir\": \"/consul/data\",\n     \"ui\" : true,\n     \"ports\": {\n       \"http\": 8500,\n       \"server\": 8300\n     }\n   } \n```\n- *vault config - vault.hcl*\n```ui = true\nbackend \"consul\" {\n        address = \"consul:8500\"\n        advertise_addr = \"http://consul:8300\"\n        scheme = \"http\"\n}\nlistener \"tcp\" {\n    address = \"0.0.0.0:8200\n    tls_disable = 1\n}\ndisable_mlock = true\n```\n- Use docker-compose up -d to run these services, and check its status\n![](15532408-351f3fa54f1ebc1a.png)\n![](15532408-698c9ee3afd1d4f9.png)\n## Configure the vault\nin #1, we created the vault container, but vault is still in uninitialized status (unsealed)\n- Vault init\n\n```\n    curl -X PUT \\\n      https://demo.xxx.com/vault/v1/sys/init \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: cb5d640a-152e-844f-cda3-5e8be4e3eec3' \\\n      -d '{\"secret_shares\":5, \"secret_threshold\":2}'\n      \n      {\n        \"keys\": [\n            \"977595193b3a8cb4ae70338859f0a7264b2757775a51cca461731b1bff4b61798f\",\n            \"9f6c61623da515b36671ca2677f5be084f670751e2da6a05d88970ebe832d6430b\",\n            \"d1f13304840d0445e23ebe7ea39d23dc6821ddcb9fc97ce5ea2c8a9e82ca132ca0\",\n            \"d49bda98c1723e659f5bb87af7774988e709ff9ad4337dc4c4851cf8a89c7dfd7f\",\n            \"dfa480970d31b18b7c7943211cdd76636f51b17a55ee2d7a6718052a50d7198847\"\n        ],\n        \"keys_base64\": [\n            \"l3WVGTs6jLSucDOIWfCnJksnV3daUcykYXMbG/9LYXmP\",\n            \"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\",\n            \"0fEzBIQNBEXiPr5+o50j3Ggh3cufyXzl6iyKnoLKEyyg\",\n            \"1JvamMFyPmWfW7h693dJiOcJ/5rUM33ExIUc+Kicff1/\",\n            \"36SAlw0xsYt8eUMhHN12Y29RsXpV7i16ZxgFKlDXGYhH\"\n        ],\n        \"root_token\": \"s.nBXC2nmVs7IVLHk6zsU7ZoaT\"\n       }\n```\n- Vault unseal\n```\n    curl -X PUT \\\n      https://demo.xxx.com/vault/v1/sys/unseal \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: a43db86c-26d4-de01-9a13-eefc23857eb7' \\\n      -d '{\"key\": \"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\"}'\n      \n      {\n        \"type\": \"shamir\",\n        \"initialized\": true,\n        \"sealed\": false,\n        \"t\": 2,\n        \"n\": 5,\n        \"progress\": 0,\n        \"nonce\": \"\",\n        \"version\": \"1.1.0\",\n        \"migration\": false,\n        \"cluster_name\": \"vault-cluster-8492c510\",\n        \"cluster_id\": \"c73cee19-c9ab-81f1-9563-8fd060084370\",\n        \"recovery_seal\": false\n      }\n```\n- create read/write token\na. create admin policy\n```\n    curl -X POST \\\n      https://demo.xxx.com/vault/v1/sys/policy/admin-policy \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: c03aae97-d6c1-fa79-f8d5-f4476fe8347a' \\\n      -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT' \\\n      -d '{\"policy\":\"{\\\"path\\\":{\\\"secret/*\\\":{\\\"capabilities\\\":[\\\"create\\\", \\\"read\\\", \\\"update\\\", \\\"delete\\\", \\\"list\\\"]}}}\"}'\n```\nb.create user policy\nsimilar request as step <label style=\"color:red\">create admin-policy</label>\nc.check the policy we created\n```\n    curl -X GET \\\n      https://demo.xxx.com/vault/v1/sys/policy/admin-policy \\\n      -H 'Accept: application/json' \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Postman-Token: 6874a6ca-070c-8d20-f4bb-183e1ff663d1' \\\n      -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT'\n      \n    {\n        \"name\": \"admin-policy\",\n        \"rules\": \"{\\\"path\\\":{\\\"secrets/*\\\":{\\\"capabilities\\\":[\\\"create\\\", \\\"read\\\", \\\"update\\\", \\\"delete\\\", \\\"list\\\"]}}}\",\n        \"request_id\": \"51ba3350-f14d-0e3f-27b4-610b6442d296\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 0,\n        \"data\": {\n            \"name\": \"admin-policy\",\n            \"rules\": \"{\\\"path\\\":{\\\"secret/*\\\":{\\\"capabilities\\\":[\\\"create\\\", \\\"read\\\", \\\"update\\\", \\\"delete\\\", \\\"list\\\"]}}}\"\n        },\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": null\n    }  \n```\n- Create Token for above two newly created policies\n```\n    curl -X POST \\\n      https://demo.xxx.com/vault/v1/auth/token/create \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 21ef1963-b06d-b4ea-547c-03539a681ca5' \\\n      -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT' \\\n      -d '{\"policies\": [\"admin-policy\"]}'\n    \n    {\n        \"request_id\": \"a5251b70-e14c-5c56-a81e-6ad59445a44f\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 0,\n        \"data\": null,\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": {\n            \"client_token\": \"s.AXTHvuudLS6C4PYjSvLLabr9\",\n            \"accessor\": \"wVg70OelyhDMwa4MojtCKeZ1\",\n            \"policies\": [\n                \"admin-policy\",\n                \"default\"\n            ],\n            \"token_policies\": [\n                \"admin-policy\",\n                \"default\"\n            ],\n            \"metadata\": null,\n            \"lease_duration\": 2764800,\n            \"renewable\": true,\n            \"entity_id\": \"\",\n            \"token_type\": \"service\",\n            \"orphan\": false\n        }\n    }\n    \n    {\n        \"request_id\": \"35212529-0b4c-3c50-0489-94df50a5f781\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 0,\n        \"data\": null,\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": {\n            \"client_token\": \"s.7A1UuLB7aJdiGhn5Qaj2FlxN\",\n            \"accessor\": \"8H2pMpG4SnKHMgH8nr56FsUJ\",\n            \"policies\": [\n                \"default\",\n                \"user-policy\"\n            ],\n            \"token_policies\": [\n                \"default\",\n                \"user-policy\"\n            ],\n            \"metadata\": null,\n            \"lease_duration\": 2764800,\n            \"renewable\": true,\n            \"entity_id\": \"\",\n            \"token_type\": \"service\",\n            \"orphan\": false\n        }\n    }\n```\n- Try to use above token to read/write data\n$\\color{red}{Admin-token}$ to put key/value, otherwise got <label style=\"color:red\">error occurred:permission denied</label>\n```\n    curl -X POST \\\n      https://demo.xxx.com/vault/v1/secret/test \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 0b3cd187-14fd-c94f-9198-794e71b906af' \\\n      -H 'X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9' \\ \n     \n      -d '{\n    \t\"token\":\"test-token\"\n    }'\n<label style=\"color:red\">user-token</label> to get key/value\n\n    curl -X GET \\\n      https://demo.xxx.com/vault/v1/secret/test \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 2f1e1e02-db11-5fdc-426e-ad0adc735b47' \\\n      -H 'X-Vault-Token: s.7A1UuLB7aJdiGhn5Qaj2FlxN' \n    \n    {\n        \"request_id\": \"8a1dfacd-7514-ae7d-8133-d3295fafb394\",\n        \"lease_id\": \"\",\n        \"renewable\": false,\n        \"lease_duration\": 2764800,\n        \"data\": {\n            \"token\": \"test-token\"\n        },\n        \"wrap_info\": null,\n        \"warnings\": null,\n        \"auth\": null\n    }\n```\n  #####Q1: no handler for route 'secret/test'\ncheck secrets engine if corresponding is enabled or not, commands: \na. docker exec -it <container-name> /bin/sh\nb.set VAULT_ADDR=http://127.0.0.1:8200, and VAULT_TOKEN={root token}\nc. vault secrets list, to list out all secrets, by default,  kv secrets engine at: secret/ should be enabled, if not found, please move forward to #d\nd. vault secrets enable -path=secret kv\ne. test the secrets engine, vault kv put secret/hello foo=world excited=yes \nf. vault kv get secret/hello, to check the data u've just pushed\n\n## Springboot application intergrates with Vault\n- create project - *vault-test*, and import related maven dependencies\n```\n    <properties>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <spring.cloud.version>Greenwich.RELEASE</spring.cloud.version>\n    </properties>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.3.RELEASE</version>\n    </parent>\n\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>${spring.cloud.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-vault-config</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-vault-config-databases</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n            <exclusions>\n                <exclusion>\n                    <groupId>junit</groupId>\n                    <artifactId>junit</artifactId>\n                </exclusion>\n            </exclusions>\n        </dependency>\n\n        <dependency>\n            <groupId>org.junit.jupiter</groupId>\n            <artifactId>junit-jupiter-api</artifactId>\n            <scope>test</scope>\n        </dependency>\n\n        <dependency>\n            <groupId>org.junit.jupiter</groupId>\n            <artifactId>junit-jupiter-engine</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-devtools</artifactId>\n            <optional>true</optional>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-configuration-processor</artifactId>\n            <optional>true</optional>\n        </dependency>\n\n    </dependencies>\n```\n- Prepare test data\n```\n    curl -X POST \\\n      https://demo.xxx.com/v1/secret/vault-test \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Content-Type: application/json' \\\n      -H 'Postman-Token: 6cad13c9-14d3-8260-dd74-6cef2b2ee822' \\\n      -H 'X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9' \\\n      -d '{\n    \t\"username\":\"Jamie\",\n    \t\"password\":\"Hlhjjj&jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\"\n    }'\n```\n- Configure Spring Vault in src/main/resources/bootstrap.yml\n```\n    server:\n      port: 8084\n    \n    logging.level.org.springframework.vault: DEBUG\n    \n    spring:\n      application:\n        name: vault-test\n    spring.cloud:\n        vault:\n          host: demo.xxx.com\n          port: 443\n          scheme: https\n          authentication: TOKEN\n          config:\n              order: -10\n          kv:\n            application-name: vault-test\n            default-context: vault-test\n            backend: secret\n            enabled: true\n            profile-separator: /\n          token: s.7A1UuLB7aJdiGhn5Qaj2FlxN  \n```\n- Impl a controller to inject the data loaded from vault\n```\n    @RestController\n    public class TestController {\n    \n    \t@Value(\"${username:test}\")\n    \tprivate String userName;\n    \n    \t@Value(\"${password:test}\")\n    \tprivate String password;\n    \n    \t@GetMapping(\"/\")\n    \t@ResponseBody\n    \tpublic Map<String, String> test() {\n    \t\tMap<String, String> rsp = new HashMap<String, String>();\n    \t\trsp.put(\"userName\", userName);\n    \t\trsp.put(\"password\", password);    \n    \t\treturn rsp;\n    \t}    \n    }\n```\n>Findings found during testing:\n*if change the spring.cloud.vault.config.order to a lower value, for example -100, the configs loaded from vault can take effects on spring auto-configured beans, like HikaiCP datasource, can put credentials onto vault in k/v format rather than keep these sensitive data in explicit config file, spring.datasource.username=xxx,spring.datasource.password=xxx*\n\n- Test it\n```\n    curl -X GET \\\n      http://localhost:8084/ \\\n      -H 'Cache-Control: no-cache' \\\n      -H 'Postman-Token: 9466ffbc-e8d5-355f-cb2c-c29907a5af9d'\n    \n    {\n        \"password\": \"Hlhjjj&jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\",\n        \"userName\": \"Jamie\"\n    }\n```\nyou can find sources code on [github](https://github.com/cloud-poc/springboot-vault-test)\n\nReferenced posts: \n[https://www.vaultproject.io/docs/concepts/policies.html](https://www.vaultproject.io/docs/concepts/policies.html)\n[https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running](https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running)\n[https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine](https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine)\n[https://www.jianshu.com/p/267f2d9ae87e](https://www.jianshu.com/p/267f2d9ae87e)\n[https://blog.51cto.com/7308310/2338146?source=dra](https://blog.51cto.com/7308310/2338146?source=dra)\n\n","slug":"Harshicorp-vault-setup-Config/index","published":1,"updated":"2019-07-14T07:06:06.231Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjy30dugr000364m75c8hwg2i","content":"<h2 id=\"Install-vault\"><a href=\"#Install-vault\" class=\"headerlink\" title=\"Install vault\"></a>Install vault</h2><ul>\n<li>Prepare <em>docker-compose.yml</em>,  content as below (just a sample here, please don’t use it for production, there are more aspects should be considered)<a id=\"more\"></a>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"><span class=\"symbol\">services:</span></span><br><span class=\"line\"><span class=\"symbol\">    consul:</span></span><br><span class=\"line\"><span class=\"symbol\">        container_name:</span> consul.server</span><br><span class=\"line\"><span class=\"symbol\">        command:</span> agent -server -bind <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span> -client <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span> -bootstrap-expect=<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"symbol\">        image:</span> consul:latest</span><br><span class=\"line\"><span class=\"symbol\">        restart:</span> always</span><br><span class=\"line\"><span class=\"symbol\">        volumes:</span></span><br><span class=\"line\">          - ./consul.server/config:<span class=\"meta-keyword\">/consul/</span>config</span><br><span class=\"line\">          - ./consul.server/data:<span class=\"meta-keyword\">/consul/</span>data</span><br><span class=\"line\"><span class=\"symbol\">        ports:</span></span><br><span class=\"line\">          - <span class=\"string\">\"9300:9300\"</span></span><br><span class=\"line\">          - <span class=\"string\">\"9500:9500\"</span></span><br><span class=\"line\">          - <span class=\"string\">\"9600:9600/udp\"</span></span><br><span class=\"line\"><span class=\"symbol\">    vault:</span></span><br><span class=\"line\"><span class=\"symbol\">        container_name:</span> vault.server</span><br><span class=\"line\"><span class=\"symbol\">        image:</span> vault</span><br><span class=\"line\"><span class=\"symbol\">        ports:</span></span><br><span class=\"line\">        - <span class=\"string\">\"8200:8200\"</span></span><br><span class=\"line\"><span class=\"symbol\">        restart:</span> always</span><br><span class=\"line\"><span class=\"symbol\">        links:</span></span><br><span class=\"line\">            - consul:consul.server</span><br><span class=\"line\"><span class=\"symbol\">        volumes:</span></span><br><span class=\"line\">        - ./vault.server/config:<span class=\"meta-keyword\">/mnt/</span>vault/config</span><br><span class=\"line\">        - ./vault.server/data:<span class=\"meta-keyword\">/mnt/</span>vault/data</span><br><span class=\"line\">        - ./vault.server/logs:<span class=\"meta-keyword\">/mnt/</span>vault/logs</span><br><span class=\"line\">        - ./vault.server/config:<span class=\"meta-keyword\">/vault/</span>config</span><br><span class=\"line\">        - <span class=\"meta-keyword\">/etc/</span>letsencrypt:<span class=\"meta-keyword\">/etc/</span>letsencrypt</span><br><span class=\"line\"><span class=\"symbol\">        cap_add:</span></span><br><span class=\"line\">        - IPC_LOCK</span><br><span class=\"line\"><span class=\"symbol\">        command:</span> server</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ul>\n<li><p><em>consul config - config.json</em></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"datacenter\"</span>: <span class=\"string\">\"data-center-1\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"node_name\"</span>: <span class=\"string\">\"master-node\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"log_level\"</span>: <span class=\"string\">\"INFO\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"server\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"data_dir\"</span>: <span class=\"string\">\"/consul/data\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"ui\"</span> : <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"ports\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"http\"</span>: <span class=\"number\">8500</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"server\"</span>: <span class=\"number\">8300</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><em>vault config - vault.hcl</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">backend &quot;consul&quot; &#123;</span><br><span class=\"line\">        address = &quot;consul:8500&quot;</span><br><span class=\"line\">        advertise_addr = &quot;http://consul:8300&quot;</span><br><span class=\"line\">        scheme = &quot;http&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">listener &quot;tcp&quot; &#123;</span><br><span class=\"line\">    address = &quot;0.0.0.0:8200</span><br><span class=\"line\">    tls_disable = 1</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">disable_mlock = true</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Use docker-compose up -d to run these services, and check its status<br><img src=\"//cloud-poc.github.io/2019/07/14/Harshicorp-vault-setup-Config/index/15532408-351f3fa54f1ebc1a.png\" alt><br><img src=\"//cloud-poc.github.io/2019/07/14/Harshicorp-vault-setup-Config/index/15532408-698c9ee3afd1d4f9.png\" alt></p>\n<h2 id=\"Configure-the-vault\"><a href=\"#Configure-the-vault\" class=\"headerlink\" title=\"Configure the vault\"></a>Configure the vault</h2><p>in #1, we created the vault container, but vault is still in uninitialized status (unsealed)</p>\n</li>\n<li><p>Vault init</p>\n</li>\n</ul>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X PUT \\</span><br><span class=\"line\">  https:<span class=\"regexp\">//</span>demo.xxx.com<span class=\"regexp\">/vault/</span>v1<span class=\"regexp\">/sys/i</span>nit \\</span><br><span class=\"line\">  -H <span class=\"string\">'Cache-Control: no-cache'</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">'Content-Type: application/json'</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">'Postman-Token: cb5d640a-152e-844f-cda3-5e8be4e3eec3'</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">'&#123;\"secret_shares\":5, \"secret_threshold\":2&#125;'</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"keys\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"977595193b3a8cb4ae70338859f0a7264b2757775a51cca461731b1bff4b61798f\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"9f6c61623da515b36671ca2677f5be084f670751e2da6a05d88970ebe832d6430b\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"d1f13304840d0445e23ebe7ea39d23dc6821ddcb9fc97ce5ea2c8a9e82ca132ca0\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"d49bda98c1723e659f5bb87af7774988e709ff9ad4337dc4c4851cf8a89c7dfd7f\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"dfa480970d31b18b7c7943211cdd76636f51b17a55ee2d7a6718052a50d7198847\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">\"keys_base64\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"l3WVGTs6jLSucDOIWfCnJksnV3daUcykYXMbG/9LYXmP\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"0fEzBIQNBEXiPr5+o50j3Ggh3cufyXzl6iyKnoLKEyyg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"1JvamMFyPmWfW7h693dJiOcJ/5rUM33ExIUc+Kicff1/\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"36SAlw0xsYt8eUMhHN12Y29RsXpV7i16ZxgFKlDXGYhH\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">\"root_token\"</span>: <span class=\"string\">\"s.nBXC2nmVs7IVLHk6zsU7ZoaT\"</span></span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>Vault unseal</p>\n<figure class=\"highlight ada\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X PUT \\</span><br><span class=\"line\">  https://demo.xxx.com/vault/v1/sys/unseal \\</span><br><span class=\"line\">  -H <span class=\"symbol\">'Cache</span>-Control: no-cache' \\</span><br><span class=\"line\">  -H <span class=\"symbol\">'Content</span>-<span class=\"keyword\">Type</span>: application/json' \\</span><br><span class=\"line\">  -H <span class=\"symbol\">'Postman</span>-Token: a43db86c-<span class=\"number\">26</span>d4-de01-<span class=\"number\">9</span>a13-eefc23857eb7' \\</span><br><span class=\"line\">  -d '&#123;<span class=\"string\">\"key\"</span>: <span class=\"string\">\"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\"</span>&#125;'</span><br><span class=\"line\">  </span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"type\"</span>: <span class=\"string\">\"shamir\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"initialized\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"string\">\"sealed\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"t\"</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">\"n\"</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">    <span class=\"string\">\"progress\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"nonce\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"version\"</span>: <span class=\"string\">\"1.1.0\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"migration\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"cluster_name\"</span>: <span class=\"string\">\"vault-cluster-8492c510\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"cluster_id\"</span>: <span class=\"string\">\"c73cee19-c9ab-81f1-9563-8fd060084370\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"recovery_seal\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>create read/write token<br>a. create admin policy</p>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST <span class=\"tag\">\\</span></span><br><span class=\"line\">  https://demo.xxx.com/vault/v1/sys/policy/admin-policy <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'Cache-Control: no-cache' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'Content-Type: application/json' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'Postman-Token: c03aae97-d6c1-fa79-f8d5-f4476fe8347a' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -d '&#123;\"policy\":\"&#123;<span class=\"tag\">\\<span class=\"name\">\"</span></span>path<span class=\"tag\">\\<span class=\"name\">\"</span></span>:&#123;<span class=\"tag\">\\<span class=\"name\">\"</span></span>secret/*<span class=\"tag\">\\<span class=\"name\">\"</span></span>:&#123;<span class=\"tag\">\\<span class=\"name\">\"</span></span>capabilities<span class=\"tag\">\\<span class=\"name\">\"</span></span>:[<span class=\"tag\">\\<span class=\"name\">\"</span></span>create<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>read<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>update<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>delete<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>list<span class=\"tag\">\\<span class=\"name\">\"</span></span>]&#125;&#125;&#125;\"&#125;'</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>b.create user policy<br>similar request as step <label style=\"color:red\">create admin-policy</label><br>c.check the policy we created</p>\n<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET \\</span><br><span class=\"line\">  https:<span class=\"comment\">//demo.xxx.com/vault/v1/sys/policy/admin-policy \\</span></span><br><span class=\"line\">  -H 'Accept: application/json' \\</span><br><span class=\"line\">  -H 'Cache-Control: no-cache' \\</span><br><span class=\"line\">  -H 'Postman-Token: <span class=\"number\">6874</span>a6ca-070c-8d20-f4bb-183e1ff663d1' \\</span><br><span class=\"line\">  -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT'</span><br><span class=\"line\">  </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>: <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"rules\"</span>: <span class=\"string\">\"&#123;\\\"</span>path\\<span class=\"string\">\":&#123;\\\"</span>secrets/*\\<span class=\"string\">\":&#123;\\\"</span>capabilities\\<span class=\"string\">\":[\\\"</span>create\\<span class=\"string\">\", \\\"</span>read\\<span class=\"string\">\", \\\"</span>update\\<span class=\"string\">\", \\\"</span>delete\\<span class=\"string\">\", \\\"</span>list\\<span class=\"string\">\"]&#125;&#125;&#125;\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"51ba3350-f14d-0e3f-27b4-610b6442d296\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"renewable\"</span>: false,</span><br><span class=\"line\">    <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"data\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">\"name\"</span>: <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"rules\"</span>: <span class=\"string\">\"&#123;\\\"</span>path\\<span class=\"string\">\":&#123;\\\"</span>secret/*\\<span class=\"string\">\":&#123;\\\"</span>capabilities\\<span class=\"string\">\":[\\\"</span>create\\<span class=\"string\">\", \\\"</span>read\\<span class=\"string\">\", \\\"</span>update\\<span class=\"string\">\", \\\"</span>delete\\<span class=\"string\">\", \\\"</span>list\\<span class=\"string\">\"]&#125;&#125;&#125;\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"string\">\"wrap_info\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"warnings\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"auth\"</span>: <span class=\"literal\">null</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>Create Token for above two newly created policies</p>\n<figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -<span class=\"type\">X</span> <span class=\"type\">POST</span> \\</span><br><span class=\"line\">  https:<span class=\"comment\">//demo.xxx.com/vault/v1/auth/token/create \\</span></span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'Cache</span>-<span class=\"type\">Control</span>: no-cache' \\</span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'Content</span>-<span class=\"type\">Type</span>: application/json' \\</span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'Postman</span>-<span class=\"type\">Token</span>: <span class=\"number\">21</span>ef1963-b06d-b4ea<span class=\"number\">-547</span>c<span class=\"number\">-03539</span>a681ca5' \\</span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'X</span>-<span class=\"type\">Vault</span>-<span class=\"type\">Token</span>: s.nBXC2nmVs7IVLHk6zsU7ZoaT' \\</span><br><span class=\"line\">  -d '&#123;<span class=\"string\">\"policies\"</span>: [<span class=\"string\">\"admin-policy\"</span>]&#125;'</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"a5251b70-e14c-5c56-a81e-6ad59445a44f\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"data\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"wrap_info\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"warnings\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"auth\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">\"client_token\"</span>: <span class=\"string\">\"s.AXTHvuudLS6C4PYjSvLLabr9\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"accessor\"</span>: <span class=\"string\">\"wVg70OelyhDMwa4MojtCKeZ1\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"token_policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"metadata\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">2764800</span>,</span><br><span class=\"line\">        <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"string\">\"entity_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"token_type\"</span>: <span class=\"string\">\"service\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"orphan\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"35212529-0b4c-3c50-0489-94df50a5f781\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"data\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"wrap_info\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"warnings\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"auth\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">\"client_token\"</span>: <span class=\"string\">\"s.7A1UuLB7aJdiGhn5Qaj2FlxN\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"accessor\"</span>: <span class=\"string\">\"8H2pMpG4SnKHMgH8nr56FsUJ\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"user-policy\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"token_policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"user-policy\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"metadata\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">2764800</span>,</span><br><span class=\"line\">        <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"string\">\"entity_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"token_type\"</span>: <span class=\"string\">\"service\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"orphan\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Try to use above token to read/write data<br>$\\color{red}{Admin-token}$ to put key/value, otherwise got <label style=\"color:red\">error occurred:permission denied</label></p>\n<figure class=\"highlight lasso\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    curl <span class=\"params\">-X</span> POST \\</span><br><span class=\"line\">      https:<span class=\"comment\">//demo.xxx.com/vault/v1/secret/test \\</span></span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Cache-Control: no-cache'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Content-Type: application/json'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Postman-Token: 0b3cd187-14fd-c94f-9198-794e71b906af'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9'</span> \\ </span><br><span class=\"line\">     </span><br><span class=\"line\">      <span class=\"params\">-d</span> <span class=\"string\">'&#123;</span></span><br><span class=\"line\"><span class=\"string\">    \t\"token\":\"test-token\"</span></span><br><span class=\"line\"><span class=\"string\">    &#125;'</span></span><br><span class=\"line\">&lt;label style=<span class=\"string\">\"color:red\"</span>&gt;user<span class=\"params\">-token</span>&lt;/label&gt; <span class=\"keyword\">to</span> get key/value</span><br><span class=\"line\"></span><br><span class=\"line\">    curl <span class=\"params\">-X</span> GET \\</span><br><span class=\"line\">      https:<span class=\"comment\">//demo.xxx.com/vault/v1/secret/test \\</span></span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Cache-Control: no-cache'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Content-Type: application/json'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Postman-Token: 2f1e1e02-db11-5fdc-426e-ad0adc735b47'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'X-Vault-Token: s.7A1UuLB7aJdiGhn5Qaj2FlxN'</span> </span><br><span class=\"line\">    </span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"8a1dfacd-7514-ae7d-8133-d3295fafb394\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">2764800</span>,</span><br><span class=\"line\">        <span class=\"string\">\"data\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">\"token\"</span>: <span class=\"string\">\"test-token\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">\"wrap_info\"</span>: <span class=\"built_in\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"warnings\"</span>: <span class=\"built_in\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"auth\"</span>: <span class=\"built_in\">null</span></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>#####Q1: no handler for route ‘secret/test’<br>check secrets engine if corresponding is enabled or not, commands:<br>a. docker exec -it <container-name> /bin/sh<br>b.set VAULT_ADDR=<a href=\"http://127.0.0.1:8200\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:8200</a>, and VAULT_TOKEN={root token}<br>c. vault secrets list, to list out all secrets, by default,  kv secrets engine at: secret/ should be enabled, if not found, please move forward to #d<br>d. vault secrets enable -path=secret kv<br>e. test the secrets engine, vault kv put secret/hello foo=world excited=yes<br>f. vault kv get secret/hello, to check the data u’ve just pushed</container-name></p>\n</li>\n</ul>\n<h2 id=\"Springboot-application-intergrates-with-Vault\"><a href=\"#Springboot-application-intergrates-with-Vault\" class=\"headerlink\" title=\"Springboot application intergrates with Vault\"></a>Springboot application intergrates with Vault</h2><ul>\n<li><p>create project - <em>vault-test</em>, and import related maven dependencies</p>\n<figure class=\"highlight dust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">spring.cloud.version</span>&gt;</span>Greenwich.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">spring.cloud.version</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.1.3.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.cloud<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-cloud-dependencies<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$</span><span class=\"template-variable\">&#123;spring.cloud.version&#125;</span><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">type</span>&gt;</span>pom<span class=\"tag\">&lt;/<span class=\"name\">type</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>import<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.cloud<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-cloud-starter-vault-config<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.cloud<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-cloud-vault-config-databases<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">exclusions</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">exclusion</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;/<span class=\"name\">exclusion</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;/<span class=\"name\">exclusions</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.junit.jupiter<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit-jupiter-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.junit.jupiter<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit-jupiter-engine<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-devtools<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Prepare test data</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST \\</span><br><span class=\"line\">  https://demo.xxx.com/v1/secret/vault-test \\</span><br><span class=\"line\">  -H '<span class=\"keyword\">Cache</span>-Control: <span class=\"keyword\">no</span>-<span class=\"keyword\">cache</span><span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -H '</span><span class=\"keyword\">Content</span>-<span class=\"keyword\">Type</span>: application/<span class=\"keyword\">json</span><span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -H '</span>Postman-Token: <span class=\"number\">6</span>cad13c9<span class=\"number\">-14</span>d3<span class=\"number\">-8260</span>-dd74<span class=\"number\">-6</span>cef2b2ee822<span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -H '</span>X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9<span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -d '</span>&#123;</span><br><span class=\"line\">\t<span class=\"string\">\"username\"</span>:<span class=\"string\">\"Jamie\"</span>,</span><br><span class=\"line\">\t<span class=\"string\">\"password\"</span>:<span class=\"string\">\"Hlhjjj&amp;jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\"</span></span><br><span class=\"line\">&#125;<span class=\"string\">'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Configure Spring Vault in src/main/resources/bootstrap.yml</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">server</span>:</span><br><span class=\"line\">  <span class=\"attribute\">port</span>: <span class=\"number\">8084</span></span><br><span class=\"line\"></span><br><span class=\"line\">logging.level.org.springframework.<span class=\"attribute\">vault</span>: DEBUG</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">spring</span>:</span><br><span class=\"line\">  <span class=\"attribute\">application</span>:</span><br><span class=\"line\">    <span class=\"attribute\">name</span>: vault-test</span><br><span class=\"line\">spring.<span class=\"attribute\">cloud</span>:</span><br><span class=\"line\">    <span class=\"attribute\">vault</span>:</span><br><span class=\"line\">      <span class=\"attribute\">host</span>: demo.xxx.com</span><br><span class=\"line\">      <span class=\"attribute\">port</span>: <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attribute\">scheme</span>: https</span><br><span class=\"line\">      <span class=\"attribute\">authentication</span>: TOKEN</span><br><span class=\"line\">      <span class=\"attribute\">config</span>:</span><br><span class=\"line\">          <span class=\"attribute\">order</span>: -<span class=\"number\">10</span></span><br><span class=\"line\">      <span class=\"attribute\">kv</span>:</span><br><span class=\"line\">        <span class=\"attribute\">application-name</span>: vault-test</span><br><span class=\"line\">        <span class=\"attribute\">default-context</span>: vault-test</span><br><span class=\"line\">        <span class=\"attribute\">backend</span>: secret</span><br><span class=\"line\">        <span class=\"attribute\">enabled</span>: true</span><br><span class=\"line\">        <span class=\"attribute\">profile-separator</span>: /</span><br><span class=\"line\">      <span class=\"attribute\">token</span>: s.<span class=\"number\">7</span>A1UuLB7aJdiGhn5Qaj2FlxN</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Impl a controller to inject the data loaded from vault</p>\n<figure class=\"highlight dart\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Value</span>(<span class=\"string\">\"<span class=\"subst\">$&#123;username:test&#125;</span>\"</span>)</span><br><span class=\"line\">\tprivate <span class=\"built_in\">String</span> userName;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Value</span>(<span class=\"string\">\"<span class=\"subst\">$&#123;password:test&#125;</span>\"</span>)</span><br><span class=\"line\">\tprivate <span class=\"built_in\">String</span> password;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/\"</span>)</span><br><span class=\"line\">\t<span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\">\tpublic <span class=\"built_in\">Map</span>&lt;<span class=\"built_in\">String</span>, <span class=\"built_in\">String</span>&gt; test() &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">Map</span>&lt;<span class=\"built_in\">String</span>, <span class=\"built_in\">String</span>&gt; rsp = <span class=\"keyword\">new</span> HashMap&lt;<span class=\"built_in\">String</span>, <span class=\"built_in\">String</span>&gt;();</span><br><span class=\"line\">\t\trsp.put(<span class=\"string\">\"userName\"</span>, userName);</span><br><span class=\"line\">\t\trsp.put(<span class=\"string\">\"password\"</span>, password);    </span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> rsp;</span><br><span class=\"line\">\t&#125;    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<blockquote>\n<p>Findings found during testing:<br><em>if change the spring.cloud.vault.config.order to a lower value, for example -100, the configs loaded from vault can take effects on spring auto-configured beans, like HikaiCP datasource, can put credentials onto vault in k/v format rather than keep these sensitive data in explicit config file, spring.datasource.username=xxx,spring.datasource.password=xxx</em></p>\n</blockquote>\n<ul>\n<li>Test it<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET \\</span><br><span class=\"line\">  http:<span class=\"comment\">//localhost:8084/ \\</span></span><br><span class=\"line\">  -H 'Cache-Control: no-cache' \\</span><br><span class=\"line\">  -H 'Postman-Token: <span class=\"number\">9466</span>ffbc-e8d5-355f-cb2c-c<span class=\"number\">2990</span>7a5af9d'</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"password\"</span>: <span class=\"string\">\"Hlhjjj&amp;jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userName\"</span>: <span class=\"string\">\"Jamie\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>you can find sources code on <a href=\"https://github.com/cloud-poc/springboot-vault-test\" target=\"_blank\" rel=\"noopener\">github</a></p>\n<p>Referenced posts:<br><a href=\"https://www.vaultproject.io/docs/concepts/policies.html\" target=\"_blank\" rel=\"noopener\">https://www.vaultproject.io/docs/concepts/policies.html</a><br><a href=\"https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running\" target=\"_blank\" rel=\"noopener\">https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running</a><br><a href=\"https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine\" target=\"_blank\" rel=\"noopener\">https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine</a><br><a href=\"https://www.jianshu.com/p/267f2d9ae87e\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/267f2d9ae87e</a><br><a href=\"https://blog.51cto.com/7308310/2338146?source=dra\" target=\"_blank\" rel=\"noopener\">https://blog.51cto.com/7308310/2338146?source=dra</a></p>\n","site":{"data":{}},"excerpt":"<h2 id=\"Install-vault\"><a href=\"#Install-vault\" class=\"headerlink\" title=\"Install vault\"></a>Install vault</h2><ul>\n<li>Prepare <em>docker-compose.yml</em>,  content as below (just a sample here, please don’t use it for production, there are more aspects should be considered)</li></ul>","more":"<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"><span class=\"symbol\">services:</span></span><br><span class=\"line\"><span class=\"symbol\">    consul:</span></span><br><span class=\"line\"><span class=\"symbol\">        container_name:</span> consul.server</span><br><span class=\"line\"><span class=\"symbol\">        command:</span> agent -server -bind <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span> -client <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span> -bootstrap-expect=<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"symbol\">        image:</span> consul:latest</span><br><span class=\"line\"><span class=\"symbol\">        restart:</span> always</span><br><span class=\"line\"><span class=\"symbol\">        volumes:</span></span><br><span class=\"line\">          - ./consul.server/config:<span class=\"meta-keyword\">/consul/</span>config</span><br><span class=\"line\">          - ./consul.server/data:<span class=\"meta-keyword\">/consul/</span>data</span><br><span class=\"line\"><span class=\"symbol\">        ports:</span></span><br><span class=\"line\">          - <span class=\"string\">\"9300:9300\"</span></span><br><span class=\"line\">          - <span class=\"string\">\"9500:9500\"</span></span><br><span class=\"line\">          - <span class=\"string\">\"9600:9600/udp\"</span></span><br><span class=\"line\"><span class=\"symbol\">    vault:</span></span><br><span class=\"line\"><span class=\"symbol\">        container_name:</span> vault.server</span><br><span class=\"line\"><span class=\"symbol\">        image:</span> vault</span><br><span class=\"line\"><span class=\"symbol\">        ports:</span></span><br><span class=\"line\">        - <span class=\"string\">\"8200:8200\"</span></span><br><span class=\"line\"><span class=\"symbol\">        restart:</span> always</span><br><span class=\"line\"><span class=\"symbol\">        links:</span></span><br><span class=\"line\">            - consul:consul.server</span><br><span class=\"line\"><span class=\"symbol\">        volumes:</span></span><br><span class=\"line\">        - ./vault.server/config:<span class=\"meta-keyword\">/mnt/</span>vault/config</span><br><span class=\"line\">        - ./vault.server/data:<span class=\"meta-keyword\">/mnt/</span>vault/data</span><br><span class=\"line\">        - ./vault.server/logs:<span class=\"meta-keyword\">/mnt/</span>vault/logs</span><br><span class=\"line\">        - ./vault.server/config:<span class=\"meta-keyword\">/vault/</span>config</span><br><span class=\"line\">        - <span class=\"meta-keyword\">/etc/</span>letsencrypt:<span class=\"meta-keyword\">/etc/</span>letsencrypt</span><br><span class=\"line\"><span class=\"symbol\">        cap_add:</span></span><br><span class=\"line\">        - IPC_LOCK</span><br><span class=\"line\"><span class=\"symbol\">        command:</span> server</span><br></pre></td></tr></table></figure>\n\n\n<ul>\n<li><p><em>consul config - config.json</em></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"datacenter\"</span>: <span class=\"string\">\"data-center-1\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"node_name\"</span>: <span class=\"string\">\"master-node\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"log_level\"</span>: <span class=\"string\">\"INFO\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"server\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"data_dir\"</span>: <span class=\"string\">\"/consul/data\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"ui\"</span> : <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"ports\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"http\"</span>: <span class=\"number\">8500</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"server\"</span>: <span class=\"number\">8300</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><em>vault config - vault.hcl</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">backend &quot;consul&quot; &#123;</span><br><span class=\"line\">        address = &quot;consul:8500&quot;</span><br><span class=\"line\">        advertise_addr = &quot;http://consul:8300&quot;</span><br><span class=\"line\">        scheme = &quot;http&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">listener &quot;tcp&quot; &#123;</span><br><span class=\"line\">    address = &quot;0.0.0.0:8200</span><br><span class=\"line\">    tls_disable = 1</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">disable_mlock = true</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Use docker-compose up -d to run these services, and check its status<br><img src=\"//cloud-poc.github.io/2019/07/14/Harshicorp-vault-setup-Config/index/15532408-351f3fa54f1ebc1a.png\" alt><br><img src=\"//cloud-poc.github.io/2019/07/14/Harshicorp-vault-setup-Config/index/15532408-698c9ee3afd1d4f9.png\" alt></p>\n<h2 id=\"Configure-the-vault\"><a href=\"#Configure-the-vault\" class=\"headerlink\" title=\"Configure the vault\"></a>Configure the vault</h2><p>in #1, we created the vault container, but vault is still in uninitialized status (unsealed)</p>\n</li>\n<li><p>Vault init</p>\n</li>\n</ul>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X PUT \\</span><br><span class=\"line\">  https:<span class=\"regexp\">//</span>demo.xxx.com<span class=\"regexp\">/vault/</span>v1<span class=\"regexp\">/sys/i</span>nit \\</span><br><span class=\"line\">  -H <span class=\"string\">'Cache-Control: no-cache'</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">'Content-Type: application/json'</span> \\</span><br><span class=\"line\">  -H <span class=\"string\">'Postman-Token: cb5d640a-152e-844f-cda3-5e8be4e3eec3'</span> \\</span><br><span class=\"line\">  -d <span class=\"string\">'&#123;\"secret_shares\":5, \"secret_threshold\":2&#125;'</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"keys\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"977595193b3a8cb4ae70338859f0a7264b2757775a51cca461731b1bff4b61798f\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"9f6c61623da515b36671ca2677f5be084f670751e2da6a05d88970ebe832d6430b\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"d1f13304840d0445e23ebe7ea39d23dc6821ddcb9fc97ce5ea2c8a9e82ca132ca0\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"d49bda98c1723e659f5bb87af7774988e709ff9ad4337dc4c4851cf8a89c7dfd7f\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"dfa480970d31b18b7c7943211cdd76636f51b17a55ee2d7a6718052a50d7198847\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">\"keys_base64\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"l3WVGTs6jLSucDOIWfCnJksnV3daUcykYXMbG/9LYXmP\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"0fEzBIQNBEXiPr5+o50j3Ggh3cufyXzl6iyKnoLKEyyg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"1JvamMFyPmWfW7h693dJiOcJ/5rUM33ExIUc+Kicff1/\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"36SAlw0xsYt8eUMhHN12Y29RsXpV7i16ZxgFKlDXGYhH\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">\"root_token\"</span>: <span class=\"string\">\"s.nBXC2nmVs7IVLHk6zsU7ZoaT\"</span></span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>Vault unseal</p>\n<figure class=\"highlight ada\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X PUT \\</span><br><span class=\"line\">  https://demo.xxx.com/vault/v1/sys/unseal \\</span><br><span class=\"line\">  -H <span class=\"symbol\">'Cache</span>-Control: no-cache' \\</span><br><span class=\"line\">  -H <span class=\"symbol\">'Content</span>-<span class=\"keyword\">Type</span>: application/json' \\</span><br><span class=\"line\">  -H <span class=\"symbol\">'Postman</span>-Token: a43db86c-<span class=\"number\">26</span>d4-de01-<span class=\"number\">9</span>a13-eefc23857eb7' \\</span><br><span class=\"line\">  -d '&#123;<span class=\"string\">\"key\"</span>: <span class=\"string\">\"n2xhYj2lFbNmccomd/W+CE9nB1Hi2moF2Ilw6+gy1kML\"</span>&#125;'</span><br><span class=\"line\">  </span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"type\"</span>: <span class=\"string\">\"shamir\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"initialized\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"string\">\"sealed\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"t\"</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">\"n\"</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">    <span class=\"string\">\"progress\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"nonce\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"version\"</span>: <span class=\"string\">\"1.1.0\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"migration\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"cluster_name\"</span>: <span class=\"string\">\"vault-cluster-8492c510\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"cluster_id\"</span>: <span class=\"string\">\"c73cee19-c9ab-81f1-9563-8fd060084370\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"recovery_seal\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>create read/write token<br>a. create admin policy</p>\n<figure class=\"highlight tex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST <span class=\"tag\">\\</span></span><br><span class=\"line\">  https://demo.xxx.com/vault/v1/sys/policy/admin-policy <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'Cache-Control: no-cache' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'Content-Type: application/json' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'Postman-Token: c03aae97-d6c1-fa79-f8d5-f4476fe8347a' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT' <span class=\"tag\">\\</span></span><br><span class=\"line\">  -d '&#123;\"policy\":\"&#123;<span class=\"tag\">\\<span class=\"name\">\"</span></span>path<span class=\"tag\">\\<span class=\"name\">\"</span></span>:&#123;<span class=\"tag\">\\<span class=\"name\">\"</span></span>secret/*<span class=\"tag\">\\<span class=\"name\">\"</span></span>:&#123;<span class=\"tag\">\\<span class=\"name\">\"</span></span>capabilities<span class=\"tag\">\\<span class=\"name\">\"</span></span>:[<span class=\"tag\">\\<span class=\"name\">\"</span></span>create<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>read<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>update<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>delete<span class=\"tag\">\\<span class=\"name\">\"</span></span>, <span class=\"tag\">\\<span class=\"name\">\"</span></span>list<span class=\"tag\">\\<span class=\"name\">\"</span></span>]&#125;&#125;&#125;\"&#125;'</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>b.create user policy<br>similar request as step <label style=\"color:red\">create admin-policy</label><br>c.check the policy we created</p>\n<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET \\</span><br><span class=\"line\">  https:<span class=\"comment\">//demo.xxx.com/vault/v1/sys/policy/admin-policy \\</span></span><br><span class=\"line\">  -H 'Accept: application/json' \\</span><br><span class=\"line\">  -H 'Cache-Control: no-cache' \\</span><br><span class=\"line\">  -H 'Postman-Token: <span class=\"number\">6874</span>a6ca-070c-8d20-f4bb-183e1ff663d1' \\</span><br><span class=\"line\">  -H 'X-Vault-Token: s.nBXC2nmVs7IVLHk6zsU7ZoaT'</span><br><span class=\"line\">  </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>: <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"rules\"</span>: <span class=\"string\">\"&#123;\\\"</span>path\\<span class=\"string\">\":&#123;\\\"</span>secrets/*\\<span class=\"string\">\":&#123;\\\"</span>capabilities\\<span class=\"string\">\":[\\\"</span>create\\<span class=\"string\">\", \\\"</span>read\\<span class=\"string\">\", \\\"</span>update\\<span class=\"string\">\", \\\"</span>delete\\<span class=\"string\">\", \\\"</span>list\\<span class=\"string\">\"]&#125;&#125;&#125;\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"51ba3350-f14d-0e3f-27b4-610b6442d296\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"renewable\"</span>: false,</span><br><span class=\"line\">    <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"data\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">\"name\"</span>: <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"rules\"</span>: <span class=\"string\">\"&#123;\\\"</span>path\\<span class=\"string\">\":&#123;\\\"</span>secret/*\\<span class=\"string\">\":&#123;\\\"</span>capabilities\\<span class=\"string\">\":[\\\"</span>create\\<span class=\"string\">\", \\\"</span>read\\<span class=\"string\">\", \\\"</span>update\\<span class=\"string\">\", \\\"</span>delete\\<span class=\"string\">\", \\\"</span>list\\<span class=\"string\">\"]&#125;&#125;&#125;\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"string\">\"wrap_info\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"warnings\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"auth\"</span>: <span class=\"literal\">null</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>Create Token for above two newly created policies</p>\n<figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -<span class=\"type\">X</span> <span class=\"type\">POST</span> \\</span><br><span class=\"line\">  https:<span class=\"comment\">//demo.xxx.com/vault/v1/auth/token/create \\</span></span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'Cache</span>-<span class=\"type\">Control</span>: no-cache' \\</span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'Content</span>-<span class=\"type\">Type</span>: application/json' \\</span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'Postman</span>-<span class=\"type\">Token</span>: <span class=\"number\">21</span>ef1963-b06d-b4ea<span class=\"number\">-547</span>c<span class=\"number\">-03539</span>a681ca5' \\</span><br><span class=\"line\">  -<span class=\"type\">H</span> <span class=\"symbol\">'X</span>-<span class=\"type\">Vault</span>-<span class=\"type\">Token</span>: s.nBXC2nmVs7IVLHk6zsU7ZoaT' \\</span><br><span class=\"line\">  -d '&#123;<span class=\"string\">\"policies\"</span>: [<span class=\"string\">\"admin-policy\"</span>]&#125;'</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"a5251b70-e14c-5c56-a81e-6ad59445a44f\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"data\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"wrap_info\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"warnings\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"auth\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">\"client_token\"</span>: <span class=\"string\">\"s.AXTHvuudLS6C4PYjSvLLabr9\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"accessor\"</span>: <span class=\"string\">\"wVg70OelyhDMwa4MojtCKeZ1\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"token_policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"admin-policy\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"metadata\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">2764800</span>,</span><br><span class=\"line\">        <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"string\">\"entity_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"token_type\"</span>: <span class=\"string\">\"service\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"orphan\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"35212529-0b4c-3c50-0489-94df50a5f781\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">\"data\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"wrap_info\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"warnings\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"string\">\"auth\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">\"client_token\"</span>: <span class=\"string\">\"s.7A1UuLB7aJdiGhn5Qaj2FlxN\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"accessor\"</span>: <span class=\"string\">\"8H2pMpG4SnKHMgH8nr56FsUJ\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"user-policy\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"token_policies\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"default\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"user-policy\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"string\">\"metadata\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">2764800</span>,</span><br><span class=\"line\">        <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"string\">\"entity_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"token_type\"</span>: <span class=\"string\">\"service\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"orphan\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Try to use above token to read/write data<br>$\\color{red}{Admin-token}$ to put key/value, otherwise got <label style=\"color:red\">error occurred:permission denied</label></p>\n<figure class=\"highlight lasso\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    curl <span class=\"params\">-X</span> POST \\</span><br><span class=\"line\">      https:<span class=\"comment\">//demo.xxx.com/vault/v1/secret/test \\</span></span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Cache-Control: no-cache'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Content-Type: application/json'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Postman-Token: 0b3cd187-14fd-c94f-9198-794e71b906af'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9'</span> \\ </span><br><span class=\"line\">     </span><br><span class=\"line\">      <span class=\"params\">-d</span> <span class=\"string\">'&#123;</span></span><br><span class=\"line\"><span class=\"string\">    \t\"token\":\"test-token\"</span></span><br><span class=\"line\"><span class=\"string\">    &#125;'</span></span><br><span class=\"line\">&lt;label style=<span class=\"string\">\"color:red\"</span>&gt;user<span class=\"params\">-token</span>&lt;/label&gt; <span class=\"keyword\">to</span> get key/value</span><br><span class=\"line\"></span><br><span class=\"line\">    curl <span class=\"params\">-X</span> GET \\</span><br><span class=\"line\">      https:<span class=\"comment\">//demo.xxx.com/vault/v1/secret/test \\</span></span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Cache-Control: no-cache'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Content-Type: application/json'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'Postman-Token: 2f1e1e02-db11-5fdc-426e-ad0adc735b47'</span> \\</span><br><span class=\"line\">      <span class=\"params\">-H</span> <span class=\"string\">'X-Vault-Token: s.7A1UuLB7aJdiGhn5Qaj2FlxN'</span> </span><br><span class=\"line\">    </span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">\"request_id\"</span>: <span class=\"string\">\"8a1dfacd-7514-ae7d-8133-d3295fafb394\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_id\"</span>: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"renewable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"lease_duration\"</span>: <span class=\"number\">2764800</span>,</span><br><span class=\"line\">        <span class=\"string\">\"data\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">\"token\"</span>: <span class=\"string\">\"test-token\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">\"wrap_info\"</span>: <span class=\"built_in\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"warnings\"</span>: <span class=\"built_in\">null</span>,</span><br><span class=\"line\">        <span class=\"string\">\"auth\"</span>: <span class=\"built_in\">null</span></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>#####Q1: no handler for route ‘secret/test’<br>check secrets engine if corresponding is enabled or not, commands:<br>a. docker exec -it <container-name> /bin/sh<br>b.set VAULT_ADDR=<a href=\"http://127.0.0.1:8200\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:8200</a>, and VAULT_TOKEN={root token}<br>c. vault secrets list, to list out all secrets, by default,  kv secrets engine at: secret/ should be enabled, if not found, please move forward to #d<br>d. vault secrets enable -path=secret kv<br>e. test the secrets engine, vault kv put secret/hello foo=world excited=yes<br>f. vault kv get secret/hello, to check the data u’ve just pushed</container-name></p>\n</li>\n</ul>\n<h2 id=\"Springboot-application-intergrates-with-Vault\"><a href=\"#Springboot-application-intergrates-with-Vault\" class=\"headerlink\" title=\"Springboot application intergrates with Vault\"></a>Springboot application intergrates with Vault</h2><ul>\n<li><p>create project - <em>vault-test</em>, and import related maven dependencies</p>\n<figure class=\"highlight dust\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">spring.cloud.version</span>&gt;</span>Greenwich.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">spring.cloud.version</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.1.3.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.cloud<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-cloud-dependencies<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$</span><span class=\"template-variable\">&#123;spring.cloud.version&#125;</span><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">type</span>&gt;</span>pom<span class=\"tag\">&lt;/<span class=\"name\">type</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>import<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.cloud<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-cloud-starter-vault-config<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.cloud<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-cloud-vault-config-databases<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">exclusions</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">exclusion</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;/<span class=\"name\">exclusion</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;/<span class=\"name\">exclusions</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.junit.jupiter<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit-jupiter-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.junit.jupiter<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit-jupiter-engine<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-devtools<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Prepare test data</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST \\</span><br><span class=\"line\">  https://demo.xxx.com/v1/secret/vault-test \\</span><br><span class=\"line\">  -H '<span class=\"keyword\">Cache</span>-Control: <span class=\"keyword\">no</span>-<span class=\"keyword\">cache</span><span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -H '</span><span class=\"keyword\">Content</span>-<span class=\"keyword\">Type</span>: application/<span class=\"keyword\">json</span><span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -H '</span>Postman-Token: <span class=\"number\">6</span>cad13c9<span class=\"number\">-14</span>d3<span class=\"number\">-8260</span>-dd74<span class=\"number\">-6</span>cef2b2ee822<span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -H '</span>X-Vault-Token: s.AXTHvuudLS6C4PYjSvLLabr9<span class=\"string\">' \\</span></span><br><span class=\"line\"><span class=\"string\">  -d '</span>&#123;</span><br><span class=\"line\">\t<span class=\"string\">\"username\"</span>:<span class=\"string\">\"Jamie\"</span>,</span><br><span class=\"line\">\t<span class=\"string\">\"password\"</span>:<span class=\"string\">\"Hlhjjj&amp;jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\"</span></span><br><span class=\"line\">&#125;<span class=\"string\">'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Configure Spring Vault in src/main/resources/bootstrap.yml</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">server</span>:</span><br><span class=\"line\">  <span class=\"attribute\">port</span>: <span class=\"number\">8084</span></span><br><span class=\"line\"></span><br><span class=\"line\">logging.level.org.springframework.<span class=\"attribute\">vault</span>: DEBUG</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">spring</span>:</span><br><span class=\"line\">  <span class=\"attribute\">application</span>:</span><br><span class=\"line\">    <span class=\"attribute\">name</span>: vault-test</span><br><span class=\"line\">spring.<span class=\"attribute\">cloud</span>:</span><br><span class=\"line\">    <span class=\"attribute\">vault</span>:</span><br><span class=\"line\">      <span class=\"attribute\">host</span>: demo.xxx.com</span><br><span class=\"line\">      <span class=\"attribute\">port</span>: <span class=\"number\">443</span></span><br><span class=\"line\">      <span class=\"attribute\">scheme</span>: https</span><br><span class=\"line\">      <span class=\"attribute\">authentication</span>: TOKEN</span><br><span class=\"line\">      <span class=\"attribute\">config</span>:</span><br><span class=\"line\">          <span class=\"attribute\">order</span>: -<span class=\"number\">10</span></span><br><span class=\"line\">      <span class=\"attribute\">kv</span>:</span><br><span class=\"line\">        <span class=\"attribute\">application-name</span>: vault-test</span><br><span class=\"line\">        <span class=\"attribute\">default-context</span>: vault-test</span><br><span class=\"line\">        <span class=\"attribute\">backend</span>: secret</span><br><span class=\"line\">        <span class=\"attribute\">enabled</span>: true</span><br><span class=\"line\">        <span class=\"attribute\">profile-separator</span>: /</span><br><span class=\"line\">      <span class=\"attribute\">token</span>: s.<span class=\"number\">7</span>A1UuLB7aJdiGhn5Qaj2FlxN</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Impl a controller to inject the data loaded from vault</p>\n<figure class=\"highlight dart\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Value</span>(<span class=\"string\">\"<span class=\"subst\">$&#123;username:test&#125;</span>\"</span>)</span><br><span class=\"line\">\tprivate <span class=\"built_in\">String</span> userName;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Value</span>(<span class=\"string\">\"<span class=\"subst\">$&#123;password:test&#125;</span>\"</span>)</span><br><span class=\"line\">\tprivate <span class=\"built_in\">String</span> password;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/\"</span>)</span><br><span class=\"line\">\t<span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\">\tpublic <span class=\"built_in\">Map</span>&lt;<span class=\"built_in\">String</span>, <span class=\"built_in\">String</span>&gt; test() &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">Map</span>&lt;<span class=\"built_in\">String</span>, <span class=\"built_in\">String</span>&gt; rsp = <span class=\"keyword\">new</span> HashMap&lt;<span class=\"built_in\">String</span>, <span class=\"built_in\">String</span>&gt;();</span><br><span class=\"line\">\t\trsp.put(<span class=\"string\">\"userName\"</span>, userName);</span><br><span class=\"line\">\t\trsp.put(<span class=\"string\">\"password\"</span>, password);    </span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> rsp;</span><br><span class=\"line\">\t&#125;    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<blockquote>\n<p>Findings found during testing:<br><em>if change the spring.cloud.vault.config.order to a lower value, for example -100, the configs loaded from vault can take effects on spring auto-configured beans, like HikaiCP datasource, can put credentials onto vault in k/v format rather than keep these sensitive data in explicit config file, spring.datasource.username=xxx,spring.datasource.password=xxx</em></p>\n</blockquote>\n<ul>\n<li>Test it<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET \\</span><br><span class=\"line\">  http:<span class=\"comment\">//localhost:8084/ \\</span></span><br><span class=\"line\">  -H 'Cache-Control: no-cache' \\</span><br><span class=\"line\">  -H 'Postman-Token: <span class=\"number\">9466</span>ffbc-e8d5-355f-cb2c-c<span class=\"number\">2990</span>7a5af9d'</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"password\"</span>: <span class=\"string\">\"Hlhjjj&amp;jkjlkjklhHHJKKYUJKjTFttrdfhHg#h$$HHHH\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userName\"</span>: <span class=\"string\">\"Jamie\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>you can find sources code on <a href=\"https://github.com/cloud-poc/springboot-vault-test\" target=\"_blank\" rel=\"noopener\">github</a></p>\n<p>Referenced posts:<br><a href=\"https://www.vaultproject.io/docs/concepts/policies.html\" target=\"_blank\" rel=\"noopener\">https://www.vaultproject.io/docs/concepts/policies.html</a><br><a href=\"https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running\" target=\"_blank\" rel=\"noopener\">https://www.hashicorp.com/resources/getting-vault-enterprise-installed-running</a><br><a href=\"https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine\" target=\"_blank\" rel=\"noopener\">https://learn.hashicorp.com/vault/secrets-management/sm-pki-engine</a><br><a href=\"https://www.jianshu.com/p/267f2d9ae87e\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/267f2d9ae87e</a><br><a href=\"https://blog.51cto.com/7308310/2338146?source=dra\" target=\"_blank\" rel=\"noopener\">https://blog.51cto.com/7308310/2338146?source=dra</a></p>"},{"title":"Free CA Certs setup using Certbot + Docker + Nginx","date":"2019-07-14T11:13:00.000Z","_content":"#### Background\n**Let's Encrypt** is a [certificate authority](https://en.wikipedia.org/wiki/Certificate_authority \"Certificate authority\") that provides [X.509](https://en.wikipedia.org/wiki/X.509 \"X.509\") [certificates](https://en.wikipedia.org/wiki/Public_key_certificate \"Public key certificate\") for [Transport Layer Security](https://en.wikipedia.org/wiki/Transport_Layer_Security \"Transport Layer Security\") (TLS) encryption at no charge,The certificate is valid for 90 days, during which renewal can take place at anytime.\n这样我们就可以用上免费的CA cert来 安全expose我们自己的网站或者服务\n\n**基本的http和https**知识请阅读https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/的‘背景知识’部分，作者讲述的非常很不错。\n#### Objectives\n通过例子来demo如何生成和使用Internet Security Research Group推出的Let’s Encrypt 免费证书\n主要涉及如下：\n1.  Docker, docker-compose用来部署nginx\n2.  Certbot，用来为域名生成CA证书\n\n#### Not In Scope\n1. Docker 和docker compose的相关概念和安装，请参考[docker官方文档](https://docs.docker.com/install/linux/docker-ce/ubuntu/)\n\n#### Steps\n##### 生成CA证书\n* 安装Certbot 客户端\n```\n  wget https://dl.eff.org/certbot-auto\n  chmod a+x ./certbot-auto\n  ./certbot-auto --help\n```\n* 验证域名所有权\n   该步骤需要启动nginx\n  a. 准备docker-compose file\n```\n  version: '3.0'\n  services:\n    nginx:\n      restart: always\n      image: nginx:1.15.6\n      ports:\n       - 80:80\n       - 443:443\n      volumes:\n       - ./conf.d:/etc/nginx/conf.d\n       - ./log:/var/log/nginx\n       - ./wwwroot:/var/www\n       - /etc/letsencrypt:/etc/letsencrypt\n```\n>  **Docker volume的映射关系**\n./conf.d nginx的配置所在\n./log 日志文件位置\n./wwwroot 项目路径\n/etc/letsencrypt CA cert的父目录\n\nb. nginx 配置文件 .conf.d/app.conf\n```\n    server {\n        listen   80;\n        server_name   domain.com;\n\n        location ^~ /.well-known/acme-challenge/ {\n           default_type \"text/plain\";\n           root     /var/www;\n        }\n\n        location = /.well-known/acme-challenge/ {\n           return 404;\n        }\n    }\n```\n > PS:\n如上两个location配置是为了通过 Let’s Encrypt 的验证，验证域名归属\n\nc. 启动nginx\n```\n    root@aws-techpoc-c02:~/web# ls conf.d/app.conf\n    root@aws-techpoc-c02:~/web# ls wwwroot/\n    index.html\n    root@aws-techpoc-c02:~/web# docker-compose up -d\n    Creating network \"web_default\" with the default driver\n    Creating web_nginx_1 ...\n    Creating web_nginx_1 ... done\n```\nd. 生成Cert\n```\n    ./certbot-auto certonly -d domain1.com domain2.com\n```\n*该步骤过程中会自动运行和安装很多linux的以来包，不用干预，其中有两布需要注意：\ni.选择用standalone的方式运行还是webroot，一般80端口已经备用了，无法使用standalone，所以选择webroot方式，然后输入webroot的地址，及上面指定的主机项目目录，如本例，/root/web/wwwroot\n2.有一步要求输入邮箱地址的提示，照着输入自己的邮箱即可，顺利完成的话，屏幕上会有提示信息。\n最后，证书成功成功后，会有如下信息:*\nIMPORTANT NOTES:\n Congratulations! Your certificate and chain have been saved at\n   /etc/letsencrypt/live/**<domain.com>**/fullchain.pem. Your cert\n   will expire on xxxx-xx-xxxx. To obtain a new version of the\n   certificate in the future, simply run Let's Encrypt again.\n至此，证书就生成好了，接下来就可以去配置nginx ssl监听了\n\n##### 配置SSL监听 for Nginx\na. 修改nginx配置文件\n```\n    server {\n            listen   443 ssl;\n            server_name  domain.com;\n            ssl_certificate        /etc/letsencrypt/live/domain.com/fullchain.pem;\n            ssl_certificate_key    /etc/letsencrypt/live/domain.com/privkey.pem;\n    \n            location / {\n                root /var/www;\n                index index.jsp index.html index.htm index.php;\n            }\n    \n            location /proxy/ {\n                root /var/www;\n                index index.jsp index.html index.htm index.php;\n                proxy_set_header X-Real-IP $remote_addr;\n                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n                proxy_set_header Host $http_host;\n    \n                proxy_pass http://172.19.0.1:8080/;\n            }\n    \n            error_page   500 502 503 504  /50x.html;\n    \n            location = /50x.html {\n                root   /usr/share/nginx/html;\n            }\n    }\n    \n    server {\n            listen   80;\n            server_name   domain.com www.domain.com;\n            return 301 https://$server_name$request_uri;            \n    }\n```\n> proxy_pass 指定代理地址，注意代理地址后面有没有’/‘,区别很大\n\nb. [optional]准备一个测试的html，用来检测nginx配置是否正常，./wwwroot/index.html\n```\n    <!DOCTYPE html>\n    <html>\n       <head>\n         <title>TEST WebSite</title>\n       </head>    \n       <body>\n           <div>Hello, this is a test web site</div>\n        <body>\n    </html>\n```\nc. Reload nginx config\n```\n    docker container exec <container> nginx -s reload\n```\n然后就可以去测试了，https://<domain.com>,如果成功可以显示那个test html page，如果有问题，请使用docker logs -f <container>,或者查看日志目录先access.log 和 error.log\n\n#### Cert Renew\nLet’s Encrypt 签发的证书有效期只有 90 天，所以需要每隔三个月就要更新一次安全证书,为了能让你的网站能被安全的保护起来，所以是非常有必要去更新cert的。certbot-auto 支持手动和自动更新两种cert更新模式，我们来测试一下这两种模式\n首先运行测试一下能否更新,调试模式，不是真的更新\n```\n./certbot-auto renew --dry-run\n```\n获得的结果截图如下\n<img src=\"20190714194434.png\" style=\"margin-left:20px\" />\n\n手动更新模式：\n```\n./certbot-auto renew -v\n```\n自动更新模式：\n```\n./certbot-auto renew --quiet --no-self-upgrade\n```\n> PS:该部分一般有运维人员集中进行处理，CA证书自动生成后还需要被加载一下去刷新，在本例中，需要运行docker container exec <container> nginx -s reload 去刷新\n\n更新后的结果展示\n<img src=\"20190714195417.png\" style=\"margin-left:20px\" />\n\nQ&A:\n1. policy-forbids-issuing-for-name-on-amazon-ec2-domain\n[issue related post](https://community.letsencrypt.org/t/policy-forbids-issuing-for-name-on-amazon-ec2-domain/12692/3)  \namazonaws.com happens to be on the blacklist Let’s Encrypt uses for high-risk domain names，及无法使用free cert for aws，可以考虑使用route53\n\nRelated posts:\nhttps://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/\nhttps://www.jianshu.com/p/c136c7ec2572","source":"_posts/Https-setup-using-Certbot-Docker-Nginx/index.md","raw":"---\ntitle: Free CA Certs setup using Certbot + Docker + Nginx\ndate: 2019-07-14 19:13:00\ncategories: \"Infra\"\ntags: \n     - Certbot\n     - Let’s Encrypt\n     - Nginx\n---\n#### Background\n**Let's Encrypt** is a [certificate authority](https://en.wikipedia.org/wiki/Certificate_authority \"Certificate authority\") that provides [X.509](https://en.wikipedia.org/wiki/X.509 \"X.509\") [certificates](https://en.wikipedia.org/wiki/Public_key_certificate \"Public key certificate\") for [Transport Layer Security](https://en.wikipedia.org/wiki/Transport_Layer_Security \"Transport Layer Security\") (TLS) encryption at no charge,The certificate is valid for 90 days, during which renewal can take place at anytime.\n这样我们就可以用上免费的CA cert来 安全expose我们自己的网站或者服务\n\n**基本的http和https**知识请阅读https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/的‘背景知识’部分，作者讲述的非常很不错。\n#### Objectives\n通过例子来demo如何生成和使用Internet Security Research Group推出的Let’s Encrypt 免费证书\n主要涉及如下：\n1.  Docker, docker-compose用来部署nginx\n2.  Certbot，用来为域名生成CA证书\n\n#### Not In Scope\n1. Docker 和docker compose的相关概念和安装，请参考[docker官方文档](https://docs.docker.com/install/linux/docker-ce/ubuntu/)\n\n#### Steps\n##### 生成CA证书\n* 安装Certbot 客户端\n```\n  wget https://dl.eff.org/certbot-auto\n  chmod a+x ./certbot-auto\n  ./certbot-auto --help\n```\n* 验证域名所有权\n   该步骤需要启动nginx\n  a. 准备docker-compose file\n```\n  version: '3.0'\n  services:\n    nginx:\n      restart: always\n      image: nginx:1.15.6\n      ports:\n       - 80:80\n       - 443:443\n      volumes:\n       - ./conf.d:/etc/nginx/conf.d\n       - ./log:/var/log/nginx\n       - ./wwwroot:/var/www\n       - /etc/letsencrypt:/etc/letsencrypt\n```\n>  **Docker volume的映射关系**\n./conf.d nginx的配置所在\n./log 日志文件位置\n./wwwroot 项目路径\n/etc/letsencrypt CA cert的父目录\n\nb. nginx 配置文件 .conf.d/app.conf\n```\n    server {\n        listen   80;\n        server_name   domain.com;\n\n        location ^~ /.well-known/acme-challenge/ {\n           default_type \"text/plain\";\n           root     /var/www;\n        }\n\n        location = /.well-known/acme-challenge/ {\n           return 404;\n        }\n    }\n```\n > PS:\n如上两个location配置是为了通过 Let’s Encrypt 的验证，验证域名归属\n\nc. 启动nginx\n```\n    root@aws-techpoc-c02:~/web# ls conf.d/app.conf\n    root@aws-techpoc-c02:~/web# ls wwwroot/\n    index.html\n    root@aws-techpoc-c02:~/web# docker-compose up -d\n    Creating network \"web_default\" with the default driver\n    Creating web_nginx_1 ...\n    Creating web_nginx_1 ... done\n```\nd. 生成Cert\n```\n    ./certbot-auto certonly -d domain1.com domain2.com\n```\n*该步骤过程中会自动运行和安装很多linux的以来包，不用干预，其中有两布需要注意：\ni.选择用standalone的方式运行还是webroot，一般80端口已经备用了，无法使用standalone，所以选择webroot方式，然后输入webroot的地址，及上面指定的主机项目目录，如本例，/root/web/wwwroot\n2.有一步要求输入邮箱地址的提示，照着输入自己的邮箱即可，顺利完成的话，屏幕上会有提示信息。\n最后，证书成功成功后，会有如下信息:*\nIMPORTANT NOTES:\n Congratulations! Your certificate and chain have been saved at\n   /etc/letsencrypt/live/**<domain.com>**/fullchain.pem. Your cert\n   will expire on xxxx-xx-xxxx. To obtain a new version of the\n   certificate in the future, simply run Let's Encrypt again.\n至此，证书就生成好了，接下来就可以去配置nginx ssl监听了\n\n##### 配置SSL监听 for Nginx\na. 修改nginx配置文件\n```\n    server {\n            listen   443 ssl;\n            server_name  domain.com;\n            ssl_certificate        /etc/letsencrypt/live/domain.com/fullchain.pem;\n            ssl_certificate_key    /etc/letsencrypt/live/domain.com/privkey.pem;\n    \n            location / {\n                root /var/www;\n                index index.jsp index.html index.htm index.php;\n            }\n    \n            location /proxy/ {\n                root /var/www;\n                index index.jsp index.html index.htm index.php;\n                proxy_set_header X-Real-IP $remote_addr;\n                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n                proxy_set_header Host $http_host;\n    \n                proxy_pass http://172.19.0.1:8080/;\n            }\n    \n            error_page   500 502 503 504  /50x.html;\n    \n            location = /50x.html {\n                root   /usr/share/nginx/html;\n            }\n    }\n    \n    server {\n            listen   80;\n            server_name   domain.com www.domain.com;\n            return 301 https://$server_name$request_uri;            \n    }\n```\n> proxy_pass 指定代理地址，注意代理地址后面有没有’/‘,区别很大\n\nb. [optional]准备一个测试的html，用来检测nginx配置是否正常，./wwwroot/index.html\n```\n    <!DOCTYPE html>\n    <html>\n       <head>\n         <title>TEST WebSite</title>\n       </head>    \n       <body>\n           <div>Hello, this is a test web site</div>\n        <body>\n    </html>\n```\nc. Reload nginx config\n```\n    docker container exec <container> nginx -s reload\n```\n然后就可以去测试了，https://<domain.com>,如果成功可以显示那个test html page，如果有问题，请使用docker logs -f <container>,或者查看日志目录先access.log 和 error.log\n\n#### Cert Renew\nLet’s Encrypt 签发的证书有效期只有 90 天，所以需要每隔三个月就要更新一次安全证书,为了能让你的网站能被安全的保护起来，所以是非常有必要去更新cert的。certbot-auto 支持手动和自动更新两种cert更新模式，我们来测试一下这两种模式\n首先运行测试一下能否更新,调试模式，不是真的更新\n```\n./certbot-auto renew --dry-run\n```\n获得的结果截图如下\n<img src=\"20190714194434.png\" style=\"margin-left:20px\" />\n\n手动更新模式：\n```\n./certbot-auto renew -v\n```\n自动更新模式：\n```\n./certbot-auto renew --quiet --no-self-upgrade\n```\n> PS:该部分一般有运维人员集中进行处理，CA证书自动生成后还需要被加载一下去刷新，在本例中，需要运行docker container exec <container> nginx -s reload 去刷新\n\n更新后的结果展示\n<img src=\"20190714195417.png\" style=\"margin-left:20px\" />\n\nQ&A:\n1. policy-forbids-issuing-for-name-on-amazon-ec2-domain\n[issue related post](https://community.letsencrypt.org/t/policy-forbids-issuing-for-name-on-amazon-ec2-domain/12692/3)  \namazonaws.com happens to be on the blacklist Let’s Encrypt uses for high-risk domain names，及无法使用free cert for aws，可以考虑使用route53\n\nRelated posts:\nhttps://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/\nhttps://www.jianshu.com/p/c136c7ec2572","slug":"Https-setup-using-Certbot-Docker-Nginx/index","published":1,"updated":"2019-07-14T12:00:10.839Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjy30duh5000464m7ovjm1lym","content":"<h4 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h4><p><strong>Let’s Encrypt</strong> is a <a href=\"https://en.wikipedia.org/wiki/Certificate_authority\" title=\"Certificate authority\" target=\"_blank\" rel=\"noopener\">certificate authority</a> that provides <a href=\"https://en.wikipedia.org/wiki/X.509\" title=\"X.509\" target=\"_blank\" rel=\"noopener\">X.509</a> <a href=\"https://en.wikipedia.org/wiki/Public_key_certificate\" title=\"Public key certificate\" target=\"_blank\" rel=\"noopener\">certificates</a> for <a href=\"https://en.wikipedia.org/wiki/Transport_Layer_Security\" title=\"Transport Layer Security\" target=\"_blank\" rel=\"noopener\">Transport Layer Security</a> (TLS) encryption at no charge,The certificate is valid for 90 days, during which renewal can take place at anytime.<br>这样我们就可以用上免费的CA cert来 安全expose我们自己的网站或者服务</p>\n<p><strong>基本的http和https</strong>知识请阅读<a href=\"https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/的‘背景知识’部分，作者讲述的非常很不错。\" target=\"_blank\" rel=\"noopener\">https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/的‘背景知识’部分，作者讲述的非常很不错。</a></p>\n<h4 id=\"Objectives\"><a href=\"#Objectives\" class=\"headerlink\" title=\"Objectives\"></a>Objectives</h4><p>通过例子来demo如何生成和使用Internet Security Research Group推出的Let’s Encrypt 免费证书<br>主要涉及如下：</p>\n<ol>\n<li>Docker, docker-compose用来部署nginx</li>\n<li>Certbot，用来为域名生成CA证书</li>\n</ol>\n<h4 id=\"Not-In-Scope\"><a href=\"#Not-In-Scope\" class=\"headerlink\" title=\"Not In Scope\"></a>Not In Scope</h4><ol>\n<li>Docker 和docker compose的相关概念和安装，请参考<a href=\"https://docs.docker.com/install/linux/docker-ce/ubuntu/\" target=\"_blank\" rel=\"noopener\">docker官方文档</a></li>\n</ol>\n<h4 id=\"Steps\"><a href=\"#Steps\" class=\"headerlink\" title=\"Steps\"></a>Steps</h4><h5 id=\"生成CA证书\"><a href=\"#生成CA证书\" class=\"headerlink\" title=\"生成CA证书\"></a>生成CA证书</h5><ul>\n<li><p>安装Certbot 客户端</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https:<span class=\"string\">//dl.eff.org/certbot-auto</span></span><br><span class=\"line\">chmod a+x <span class=\"string\">./certbot-auto</span></span><br><span class=\"line\"><span class=\"string\">./certbot-auto</span> <span class=\"params\">--help</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>验证域名所有权<br> 该步骤需要启动nginx<br>a. 准备docker-compose file</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">version</span>: <span class=\"string\">'3.0'</span></span><br><span class=\"line\"><span class=\"attribute\">services</span>:</span><br><span class=\"line\">  <span class=\"attribute\">nginx</span>:</span><br><span class=\"line\">    <span class=\"attribute\">restart</span>: always</span><br><span class=\"line\">    <span class=\"attribute\">image</span>: <span class=\"attribute\">nginx</span>:<span class=\"number\">1.15</span>.<span class=\"number\">6</span></span><br><span class=\"line\">    <span class=\"attribute\">ports</span>:</span><br><span class=\"line\">     - <span class=\"number\">80</span>:<span class=\"number\">80</span></span><br><span class=\"line\">     - <span class=\"number\">443</span>:<span class=\"number\">443</span></span><br><span class=\"line\">    <span class=\"attribute\">volumes</span>:</span><br><span class=\"line\">     - ./conf.<span class=\"attribute\">d</span>:/etc/nginx/conf.d</span><br><span class=\"line\">     - ./<span class=\"attribute\">log</span>:/var/log/nginx</span><br><span class=\"line\">     - ./<span class=\"attribute\">wwwroot</span>:/var/www</span><br><span class=\"line\">     - /etc/<span class=\"attribute\">letsencrypt</span>:/etc/letsencrypt</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<blockquote>\n<p> <strong>Docker volume的映射关系</strong><br>./conf.d nginx的配置所在<br>./log 日志文件位置<br>./wwwroot 项目路径<br>/etc/letsencrypt CA cert的父目录</p>\n</blockquote>\n<p>b. nginx 配置文件 .conf.d/app.conf</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">listen</span>   <span class=\"number\">80</span>;</span><br><span class=\"line\">    <span class=\"attribute\">server_name</span>   domain.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">location</span><span class=\"regexp\"> ^~</span> /.well-known/acme-challenge/ &#123;</span><br><span class=\"line\">       <span class=\"attribute\">default_type</span> <span class=\"string\">\"text/plain\"</span>;</span><br><span class=\"line\">       <span class=\"attribute\">root</span>     /var/www;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">location</span> = /.well-known/acme-challenge/ &#123;</span><br><span class=\"line\">       <span class=\"attribute\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>PS:<br>如上两个location配置是为了通过 Let’s Encrypt 的验证，验证域名归属</p>\n</blockquote>\n<p>c. 启动nginx</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@aws-techpoc-c02:~/web# ls conf.d/app.conf</span><br><span class=\"line\">root@aws-techpoc-c02:~/web# ls wwwroot/</span><br><span class=\"line\">index.html</span><br><span class=\"line\">root@aws-techpoc-c02:~/web# docker-compose up -d</span><br><span class=\"line\">Creating<span class=\"built_in\"> network </span><span class=\"string\">\"web_default\"</span> with the<span class=\"built_in\"> default </span>driver</span><br><span class=\"line\">Creating web_nginx_1 <span class=\"built_in\">..</span>.</span><br><span class=\"line\">Creating web_nginx_1 <span class=\"built_in\">..</span>. done</span><br></pre></td></tr></table></figure>\n\n<p>d. 生成Cert</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./certbot-auto certonly -d domain1.<span class=\"keyword\">com</span> domain2.<span class=\"keyword\">com</span></span><br></pre></td></tr></table></figure>\n\n<p><em>该步骤过程中会自动运行和安装很多linux的以来包，不用干预，其中有两布需要注意：<br>i.选择用standalone的方式运行还是webroot，一般80端口已经备用了，无法使用standalone，所以选择webroot方式，然后输入webroot的地址，及上面指定的主机项目目录，如本例，/root/web/wwwroot<br>2.有一步要求输入邮箱地址的提示，照着输入自己的邮箱即可，顺利完成的话，屏幕上会有提示信息。<br>最后，证书成功成功后，会有如下信息:</em><br>IMPORTANT NOTES:<br> Congratulations! Your certificate and chain have been saved at<br>   /etc/letsencrypt/live/<strong>&lt;domain.com&gt;</strong>/fullchain.pem. Your cert<br>   will expire on xxxx-xx-xxxx. To obtain a new version of the<br>   certificate in the future, simply run Let’s Encrypt again.<br>至此，证书就生成好了，接下来就可以去配置nginx ssl监听了</p>\n<h5 id=\"配置SSL监听-for-Nginx\"><a href=\"#配置SSL监听-for-Nginx\" class=\"headerlink\" title=\"配置SSL监听 for Nginx\"></a>配置SSL监听 for Nginx</h5><p>a. 修改nginx配置文件</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>   <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>  domain.com;</span><br><span class=\"line\">        <span class=\"attribute\">ssl_certificate</span>        /etc/letsencrypt/live/domain.com/fullchain.pem;</span><br><span class=\"line\">        <span class=\"attribute\">ssl_certificate_key</span>    /etc/letsencrypt/live/domain.com/privkey.pem;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">            <span class=\"attribute\">root</span> /var/www;</span><br><span class=\"line\">            <span class=\"attribute\">index</span> index.jsp index.html index.htm index.php;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> /proxy/ &#123;</span><br><span class=\"line\">            <span class=\"attribute\">root</span> /var/www;</span><br><span class=\"line\">            <span class=\"attribute\">index</span> index.jsp index.html index.htm index.php;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$http_host</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"attribute\">proxy_pass</span> http://172.19.0.1:8080/;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">error_page</span>   <span class=\"number\">500</span> <span class=\"number\">502</span> <span class=\"number\">503</span> <span class=\"number\">504</span>  /50x.html;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> = /50x.html &#123;</span><br><span class=\"line\">            <span class=\"attribute\">root</span>   /usr/share/nginx/html;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>   <span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>   domain.com www.domain.com;</span><br><span class=\"line\">        <span class=\"attribute\">return</span> <span class=\"number\">301</span> https://<span class=\"variable\">$server_name</span><span class=\"variable\">$request_uri</span>;            </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>proxy_pass 指定代理地址，注意代理地址后面有没有’/‘,区别很大</p>\n</blockquote>\n<p>b. [optional]准备一个测试的html，用来检测nginx配置是否正常，./wwwroot/index.html</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>TEST WebSite<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span>    </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>Hello, this is a test web site<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>c. Reload nginx config</p>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker <span class=\"keyword\">container</span> <span class=\"keyword\">exec</span> &lt;<span class=\"keyword\">container</span>&gt; nginx -s reload</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以去测试了，https://&lt;domain.com&gt;,如果成功可以显示那个test html page，如果有问题，请使用docker logs -f <container>,或者查看日志目录先access.log 和 error.log</container></p>\n<h4 id=\"Cert-Renew\"><a href=\"#Cert-Renew\" class=\"headerlink\" title=\"Cert Renew\"></a>Cert Renew</h4><p>Let’s Encrypt 签发的证书有效期只有 90 天，所以需要每隔三个月就要更新一次安全证书,为了能让你的网站能被安全的保护起来，所以是非常有必要去更新cert的。certbot-auto 支持手动和自动更新两种cert更新模式，我们来测试一下这两种模式<br>首先运行测试一下能否更新,调试模式，不是真的更新</p>\n<figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./certbot-<span class=\"keyword\">auto</span> renew --dry-<span class=\"built_in\">run</span></span><br></pre></td></tr></table></figure>\n\n<p>获得的结果截图如下<br><img src=\"//cloud-poc.github.io/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/20190714194434.png\" style=\"margin-left:20px\"></p>\n<p>手动更新模式：</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./certbot-<span class=\"keyword\">auto</span> renew -v</span><br></pre></td></tr></table></figure>\n\n<p>自动更新模式：</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">./certbot-auto</span> renew <span class=\"params\">--quiet</span> <span class=\"params\">--no-self-upgrade</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>PS:该部分一般有运维人员集中进行处理，CA证书自动生成后还需要被加载一下去刷新，在本例中，需要运行docker container exec <container> nginx -s reload 去刷新</container></p>\n</blockquote>\n<p>更新后的结果展示<br><img src=\"//cloud-poc.github.io/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/20190714195417.png\" style=\"margin-left:20px\"></p>\n<p>Q&amp;A:</p>\n<ol>\n<li>policy-forbids-issuing-for-name-on-amazon-ec2-domain<br><a href=\"https://community.letsencrypt.org/t/policy-forbids-issuing-for-name-on-amazon-ec2-domain/12692/3\" target=\"_blank\" rel=\"noopener\">issue related post</a><br>amazonaws.com happens to be on the blacklist Let’s Encrypt uses for high-risk domain names，及无法使用free cert for aws，可以考虑使用route53</li>\n</ol>\n<p>Related posts:<br><a href=\"https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/\" target=\"_blank\" rel=\"noopener\">https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/</a><br><a href=\"https://www.jianshu.com/p/c136c7ec2572\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/c136c7ec2572</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h4><p><strong>Let’s Encrypt</strong> is a <a href=\"https://en.wikipedia.org/wiki/Certificate_authority\" title=\"Certificate authority\" target=\"_blank\" rel=\"noopener\">certificate authority</a> that provides <a href=\"https://en.wikipedia.org/wiki/X.509\" title=\"X.509\" target=\"_blank\" rel=\"noopener\">X.509</a> <a href=\"https://en.wikipedia.org/wiki/Public_key_certificate\" title=\"Public key certificate\" target=\"_blank\" rel=\"noopener\">certificates</a> for <a href=\"https://en.wikipedia.org/wiki/Transport_Layer_Security\" title=\"Transport Layer Security\" target=\"_blank\" rel=\"noopener\">Transport Layer Security</a> (TLS) encryption at no charge,The certificate is valid for 90 days, during which renewal can take place at anytime.<br>这样我们就可以用上免费的CA cert来 安全expose我们自己的网站或者服务</p>\n<p><strong>基本的http和https</strong>知识请阅读<a href=\"https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/的‘背景知识’部分，作者讲述的非常很不错。\" target=\"_blank\" rel=\"noopener\">https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/的‘背景知识’部分，作者讲述的非常很不错。</a></p>\n<h4 id=\"Objectives\"><a href=\"#Objectives\" class=\"headerlink\" title=\"Objectives\"></a>Objectives</h4><p>通过例子来demo如何生成和使用Internet Security Research Group推出的Let’s Encrypt 免费证书<br>主要涉及如下：</p>\n<ol>\n<li>Docker, docker-compose用来部署nginx</li>\n<li>Certbot，用来为域名生成CA证书</li>\n</ol>\n<h4 id=\"Not-In-Scope\"><a href=\"#Not-In-Scope\" class=\"headerlink\" title=\"Not In Scope\"></a>Not In Scope</h4><ol>\n<li>Docker 和docker compose的相关概念和安装，请参考<a href=\"https://docs.docker.com/install/linux/docker-ce/ubuntu/\" target=\"_blank\" rel=\"noopener\">docker官方文档</a></li>\n</ol>\n<h4 id=\"Steps\"><a href=\"#Steps\" class=\"headerlink\" title=\"Steps\"></a>Steps</h4><h5 id=\"生成CA证书\"><a href=\"#生成CA证书\" class=\"headerlink\" title=\"生成CA证书\"></a>生成CA证书</h5><ul>\n<li><p>安装Certbot 客户端</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https:<span class=\"string\">//dl.eff.org/certbot-auto</span></span><br><span class=\"line\">chmod a+x <span class=\"string\">./certbot-auto</span></span><br><span class=\"line\"><span class=\"string\">./certbot-auto</span> <span class=\"params\">--help</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>验证域名所有权<br> 该步骤需要启动nginx<br>a. 准备docker-compose file</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">version</span>: <span class=\"string\">'3.0'</span></span><br><span class=\"line\"><span class=\"attribute\">services</span>:</span><br><span class=\"line\">  <span class=\"attribute\">nginx</span>:</span><br><span class=\"line\">    <span class=\"attribute\">restart</span>: always</span><br><span class=\"line\">    <span class=\"attribute\">image</span>: <span class=\"attribute\">nginx</span>:<span class=\"number\">1.15</span>.<span class=\"number\">6</span></span><br><span class=\"line\">    <span class=\"attribute\">ports</span>:</span><br><span class=\"line\">     - <span class=\"number\">80</span>:<span class=\"number\">80</span></span><br><span class=\"line\">     - <span class=\"number\">443</span>:<span class=\"number\">443</span></span><br><span class=\"line\">    <span class=\"attribute\">volumes</span>:</span><br><span class=\"line\">     - ./conf.<span class=\"attribute\">d</span>:/etc/nginx/conf.d</span><br><span class=\"line\">     - ./<span class=\"attribute\">log</span>:/var/log/nginx</span><br><span class=\"line\">     - ./<span class=\"attribute\">wwwroot</span>:/var/www</span><br><span class=\"line\">     - /etc/<span class=\"attribute\">letsencrypt</span>:/etc/letsencrypt</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<blockquote>\n<p> <strong>Docker volume的映射关系</strong><br>./conf.d nginx的配置所在<br>./log 日志文件位置<br>./wwwroot 项目路径<br>/etc/letsencrypt CA cert的父目录</p>\n</blockquote>\n<p>b. nginx 配置文件 .conf.d/app.conf</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">listen</span>   <span class=\"number\">80</span>;</span><br><span class=\"line\">    <span class=\"attribute\">server_name</span>   domain.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">location</span><span class=\"regexp\"> ^~</span> /.well-known/acme-challenge/ &#123;</span><br><span class=\"line\">       <span class=\"attribute\">default_type</span> <span class=\"string\">\"text/plain\"</span>;</span><br><span class=\"line\">       <span class=\"attribute\">root</span>     /var/www;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">location</span> = /.well-known/acme-challenge/ &#123;</span><br><span class=\"line\">       <span class=\"attribute\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>PS:<br>如上两个location配置是为了通过 Let’s Encrypt 的验证，验证域名归属</p>\n</blockquote>\n<p>c. 启动nginx</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@aws-techpoc-c02:~/web# ls conf.d/app.conf</span><br><span class=\"line\">root@aws-techpoc-c02:~/web# ls wwwroot/</span><br><span class=\"line\">index.html</span><br><span class=\"line\">root@aws-techpoc-c02:~/web# docker-compose up -d</span><br><span class=\"line\">Creating<span class=\"built_in\"> network </span><span class=\"string\">\"web_default\"</span> with the<span class=\"built_in\"> default </span>driver</span><br><span class=\"line\">Creating web_nginx_1 <span class=\"built_in\">..</span>.</span><br><span class=\"line\">Creating web_nginx_1 <span class=\"built_in\">..</span>. done</span><br></pre></td></tr></table></figure>\n\n<p>d. 生成Cert</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./certbot-auto certonly -d domain1.<span class=\"keyword\">com</span> domain2.<span class=\"keyword\">com</span></span><br></pre></td></tr></table></figure>\n\n<p><em>该步骤过程中会自动运行和安装很多linux的以来包，不用干预，其中有两布需要注意：<br>i.选择用standalone的方式运行还是webroot，一般80端口已经备用了，无法使用standalone，所以选择webroot方式，然后输入webroot的地址，及上面指定的主机项目目录，如本例，/root/web/wwwroot<br>2.有一步要求输入邮箱地址的提示，照着输入自己的邮箱即可，顺利完成的话，屏幕上会有提示信息。<br>最后，证书成功成功后，会有如下信息:</em><br>IMPORTANT NOTES:<br> Congratulations! Your certificate and chain have been saved at<br>   /etc/letsencrypt/live/<strong>&lt;domain.com&gt;</strong>/fullchain.pem. Your cert<br>   will expire on xxxx-xx-xxxx. To obtain a new version of the<br>   certificate in the future, simply run Let’s Encrypt again.<br>至此，证书就生成好了，接下来就可以去配置nginx ssl监听了</p>\n<h5 id=\"配置SSL监听-for-Nginx\"><a href=\"#配置SSL监听-for-Nginx\" class=\"headerlink\" title=\"配置SSL监听 for Nginx\"></a>配置SSL监听 for Nginx</h5><p>a. 修改nginx配置文件</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>   <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>  domain.com;</span><br><span class=\"line\">        <span class=\"attribute\">ssl_certificate</span>        /etc/letsencrypt/live/domain.com/fullchain.pem;</span><br><span class=\"line\">        <span class=\"attribute\">ssl_certificate_key</span>    /etc/letsencrypt/live/domain.com/privkey.pem;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">            <span class=\"attribute\">root</span> /var/www;</span><br><span class=\"line\">            <span class=\"attribute\">index</span> index.jsp index.html index.htm index.php;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> /proxy/ &#123;</span><br><span class=\"line\">            <span class=\"attribute\">root</span> /var/www;</span><br><span class=\"line\">            <span class=\"attribute\">index</span> index.jsp index.html index.htm index.php;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$http_host</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"attribute\">proxy_pass</span> http://172.19.0.1:8080/;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">error_page</span>   <span class=\"number\">500</span> <span class=\"number\">502</span> <span class=\"number\">503</span> <span class=\"number\">504</span>  /50x.html;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> = /50x.html &#123;</span><br><span class=\"line\">            <span class=\"attribute\">root</span>   /usr/share/nginx/html;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>   <span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>   domain.com www.domain.com;</span><br><span class=\"line\">        <span class=\"attribute\">return</span> <span class=\"number\">301</span> https://<span class=\"variable\">$server_name</span><span class=\"variable\">$request_uri</span>;            </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>proxy_pass 指定代理地址，注意代理地址后面有没有’/‘,区别很大</p>\n</blockquote>\n<p>b. [optional]准备一个测试的html，用来检测nginx配置是否正常，./wwwroot/index.html</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>TEST WebSite<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span>    </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>Hello, this is a test web site<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>c. Reload nginx config</p>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker <span class=\"keyword\">container</span> <span class=\"keyword\">exec</span> &lt;<span class=\"keyword\">container</span>&gt; nginx -s reload</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以去测试了，https://&lt;domain.com&gt;,如果成功可以显示那个test html page，如果有问题，请使用docker logs -f <container>,或者查看日志目录先access.log 和 error.log</container></p>\n<h4 id=\"Cert-Renew\"><a href=\"#Cert-Renew\" class=\"headerlink\" title=\"Cert Renew\"></a>Cert Renew</h4><p>Let’s Encrypt 签发的证书有效期只有 90 天，所以需要每隔三个月就要更新一次安全证书,为了能让你的网站能被安全的保护起来，所以是非常有必要去更新cert的。certbot-auto 支持手动和自动更新两种cert更新模式，我们来测试一下这两种模式<br>首先运行测试一下能否更新,调试模式，不是真的更新</p>\n<figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./certbot-<span class=\"keyword\">auto</span> renew --dry-<span class=\"built_in\">run</span></span><br></pre></td></tr></table></figure>\n\n<p>获得的结果截图如下<br><img src=\"//cloud-poc.github.io/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/20190714194434.png\" style=\"margin-left:20px\"></p>\n<p>手动更新模式：</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./certbot-<span class=\"keyword\">auto</span> renew -v</span><br></pre></td></tr></table></figure>\n\n<p>自动更新模式：</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">./certbot-auto</span> renew <span class=\"params\">--quiet</span> <span class=\"params\">--no-self-upgrade</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>PS:该部分一般有运维人员集中进行处理，CA证书自动生成后还需要被加载一下去刷新，在本例中，需要运行docker container exec <container> nginx -s reload 去刷新</container></p>\n</blockquote>\n<p>更新后的结果展示<br><img src=\"//cloud-poc.github.io/2019/07/14/Https-setup-using-Certbot-Docker-Nginx/index/20190714195417.png\" style=\"margin-left:20px\"></p>\n<p>Q&amp;A:</p>\n<ol>\n<li>policy-forbids-issuing-for-name-on-amazon-ec2-domain<br><a href=\"https://community.letsencrypt.org/t/policy-forbids-issuing-for-name-on-amazon-ec2-domain/12692/3\" target=\"_blank\" rel=\"noopener\">issue related post</a><br>amazonaws.com happens to be on the blacklist Let’s Encrypt uses for high-risk domain names，及无法使用free cert for aws，可以考虑使用route53</li>\n</ol>\n<p>Related posts:<br><a href=\"https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/\" target=\"_blank\" rel=\"noopener\">https://linuxstory.org/deploy-lets-encrypt-ssl-certificate-with-certbot/</a><br><a href=\"https://www.jianshu.com/p/c136c7ec2572\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/c136c7ec2572</a></p>\n"},{"title":"Linux network proxy setup for desktop and terminal","date":"2019-07-14T06:50:52.000Z","_content":"### 背景介绍\n很多时候我们由于great firewall，我们无法访问某些网站，这时候就需要用到网络代理来应对一些比较urgent的case，本文主要会介绍如何使用Shadowsocks 和 Proxychain来 setup linux network proxy，这样在命令行下都可以起到代理和转发的作用，而不仅限于浏览器的代理。\n\n### SS server & SS local的配置\n  #### 预置条件\n- Install Python 3 + pip, 安装命令如下：\n>sudo apt-get install python3-pip\n*如果得到no packages found - python3-pip的错误，请添加相应的apt sources. 修改/etc/apt/sources.list文件，添加如下4条source信息*\n```\n  deb http://cn.archive.ubuntu.com/ubuntu bionic main multiverse restricted universe\n  deb http://cn.archive.ubuntu.com/ubuntu bionic-updates main multiverse restricted universe\n  deb http://cn.archive.ubuntu.com/ubuntu bionic-security main multiverse restricted universe\n  deb http://cn.archive.ubuntu.com/ubuntu bionic-proposed main multiverse restricted universe\n```\n- Install Shadowsocks\n- 一台可以访问__外网__的云主机，Azure/AWS/Alicloud-HK等都可以\n> sudo pip install shadowsocks\n#### SSServer的配置和启动\n在云主机上创建sss 配置文件shadowsocks.json(推荐放置在/etc/shadowsocks/ 下面)，其内容如下：\n```\n{\n  \"server\":\"0.0.0.0\",\n  \"server_port\":\"{port}\",\n  \"local_address\":\"127.0.0.1\",\n  \"local_port\":\"1080\",\n  \"password\":\"{password}\",\n  \"timeout\":1000,\n  \"method\":\"aes-256-cfb\",\n  \"fast_open\":false\n}\n```\nip,port,password这三个参数是必须参数\n配置好这个配置文件后，运行命令然SSS服务运行起来\n>nohup ssserver -c /etc/shadowsocks/shadowsocks.json start &\n#### SSLocal的配置和启动\n在配置好了服务端之后，我们就可以开始配置客户端了，客户端也需要一个基本类似的配置文件，当然了你可以在windows或者手机上用shadowsocks的客户端来实现客户端代理，这个不是本文的重点\n在本地的linux机上创建shadowsocks.json，配置内容如下：\n```\n{\n  \"server\":\"xxxx\",\n  \"local_address\": \"127.0.0.1\",\n  \"local_port\":1080,\n  \"server_port\":xxxx,\n  \"password\":\"xxxx\",\n  \"timeout\":300,\n  \"method\":\"aes-256-cfb\"\n}\n```\n完成配置后，命令运行起来\n>nohup sslocal -c shadowsocks.json &\n\n到此，我们可以通过设置linux系统环境变量达到浏览器network代理的目的,这距离我们的最终目标命令行下的网络代理更近一步了\n>export http_proxy=127.0.0.1:1080\nexport https_proxy=127.0.0.1:1080\nexport no_proxy=localhost, 127.0.0.1\n\n接下来我们进行proxychain的安装和配置\n### Proxychain的配置\n#### Install proxychain\n>git clone https://github.com/rofl0r/proxychains-ng\n  cd proxychains-ng\n  ./configure --prefix=/usr --sysconfdir=/etc\n  make\n  make install\n  make install-config\n按步骤执行如上命令完成后，proxychain安装完成，并且默认的配置为：/etc/proxychains.conf\n#### Update proxychain的代理列表\n> vim /etc/proxychains.conf\n在文件尾部增加一行：socks5    127.0.0.1  1080\n<img src=\"15532408-1405d25f0bcee21b.png\" style=\"margin-left:25px\" />\n现在你可以测试了，测试命令如下：\n>proxychains4 curl https://www.google.com\n\n如果你能看到服务器返回了html相关的东西，说明代理是工作的，恭喜你\n截至目前，你可以做到在命令下来代理网络了，可以应对很多的使用场景了，但是依然有场景你无法满足，例如，在某个应用的内需要走代理，前提是你无法添加proxychains4的前缀，如docker daemon里面去下载image，这时候需要一个‘全局’的代理，使到全部的流量都走代理，不管是inbound或者outbound，你会问可以做到吗？\n答案是Yes，很简单，只需要一个命令去打开bash并在这个bash下面所有的流量都走代理\n> proxychains4 -q /bin/bash\n\n到此为止，我们基本实现了基于浏览器代理和命令行下的全局代理，自己去试试吧，good luck\n\n最后一点补充，可以把SS做成linux服务，这样随系统启动使用起来会更加的方便，做法如下：\n>sudo vim /etc/systemd/system/shadowsocks.service\n内容如下：\n*[Unit]\nDescription=Shadowsocks Client Service\nAfter=network.target\n[Service]\nType=simple\nUser=root\nExecStart=/usr/local/bin/sslocal -c /xxx/shadowsocks.json\n\t\t[Install]\nWantedBy=multi-user.target*\n\n开发SS的linux服务\n>systemctl enable /etc/systemd/system/shadowsocks.service\n\n然后就可以像其他linux服务那样使用 systemctl来管理了\n如果在上述添加SS服务的过程中遇到这个错误的话\n/usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER\n请修改/usr/local/lib/python3.6/dist-packages/shadowsocks/crypto/openssl.py，更新第55行和111行\n将libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) 修改为 <label style=\"color:blue\">libcrypto.EVP_CIPHER_CTX_reset(self._ctx)</label>\n\n\n","source":"_posts/Linux-network-proxy-setup-desktop-and-terminal/index.md","raw":"---\ntitle: Linux network proxy setup for desktop and terminal\ndate: 2019-07-14 14:50:52\ncategories: \"Infra\"\ntags: #文章標籤 可以省略\n     - Shadowsocks\n     - Proxychain\n     - Proxy\n---\n### 背景介绍\n很多时候我们由于great firewall，我们无法访问某些网站，这时候就需要用到网络代理来应对一些比较urgent的case，本文主要会介绍如何使用Shadowsocks 和 Proxychain来 setup linux network proxy，这样在命令行下都可以起到代理和转发的作用，而不仅限于浏览器的代理。\n\n### SS server & SS local的配置\n  #### 预置条件\n- Install Python 3 + pip, 安装命令如下：\n>sudo apt-get install python3-pip\n*如果得到no packages found - python3-pip的错误，请添加相应的apt sources. 修改/etc/apt/sources.list文件，添加如下4条source信息*\n```\n  deb http://cn.archive.ubuntu.com/ubuntu bionic main multiverse restricted universe\n  deb http://cn.archive.ubuntu.com/ubuntu bionic-updates main multiverse restricted universe\n  deb http://cn.archive.ubuntu.com/ubuntu bionic-security main multiverse restricted universe\n  deb http://cn.archive.ubuntu.com/ubuntu bionic-proposed main multiverse restricted universe\n```\n- Install Shadowsocks\n- 一台可以访问__外网__的云主机，Azure/AWS/Alicloud-HK等都可以\n> sudo pip install shadowsocks\n#### SSServer的配置和启动\n在云主机上创建sss 配置文件shadowsocks.json(推荐放置在/etc/shadowsocks/ 下面)，其内容如下：\n```\n{\n  \"server\":\"0.0.0.0\",\n  \"server_port\":\"{port}\",\n  \"local_address\":\"127.0.0.1\",\n  \"local_port\":\"1080\",\n  \"password\":\"{password}\",\n  \"timeout\":1000,\n  \"method\":\"aes-256-cfb\",\n  \"fast_open\":false\n}\n```\nip,port,password这三个参数是必须参数\n配置好这个配置文件后，运行命令然SSS服务运行起来\n>nohup ssserver -c /etc/shadowsocks/shadowsocks.json start &\n#### SSLocal的配置和启动\n在配置好了服务端之后，我们就可以开始配置客户端了，客户端也需要一个基本类似的配置文件，当然了你可以在windows或者手机上用shadowsocks的客户端来实现客户端代理，这个不是本文的重点\n在本地的linux机上创建shadowsocks.json，配置内容如下：\n```\n{\n  \"server\":\"xxxx\",\n  \"local_address\": \"127.0.0.1\",\n  \"local_port\":1080,\n  \"server_port\":xxxx,\n  \"password\":\"xxxx\",\n  \"timeout\":300,\n  \"method\":\"aes-256-cfb\"\n}\n```\n完成配置后，命令运行起来\n>nohup sslocal -c shadowsocks.json &\n\n到此，我们可以通过设置linux系统环境变量达到浏览器network代理的目的,这距离我们的最终目标命令行下的网络代理更近一步了\n>export http_proxy=127.0.0.1:1080\nexport https_proxy=127.0.0.1:1080\nexport no_proxy=localhost, 127.0.0.1\n\n接下来我们进行proxychain的安装和配置\n### Proxychain的配置\n#### Install proxychain\n>git clone https://github.com/rofl0r/proxychains-ng\n  cd proxychains-ng\n  ./configure --prefix=/usr --sysconfdir=/etc\n  make\n  make install\n  make install-config\n按步骤执行如上命令完成后，proxychain安装完成，并且默认的配置为：/etc/proxychains.conf\n#### Update proxychain的代理列表\n> vim /etc/proxychains.conf\n在文件尾部增加一行：socks5    127.0.0.1  1080\n<img src=\"15532408-1405d25f0bcee21b.png\" style=\"margin-left:25px\" />\n现在你可以测试了，测试命令如下：\n>proxychains4 curl https://www.google.com\n\n如果你能看到服务器返回了html相关的东西，说明代理是工作的，恭喜你\n截至目前，你可以做到在命令下来代理网络了，可以应对很多的使用场景了，但是依然有场景你无法满足，例如，在某个应用的内需要走代理，前提是你无法添加proxychains4的前缀，如docker daemon里面去下载image，这时候需要一个‘全局’的代理，使到全部的流量都走代理，不管是inbound或者outbound，你会问可以做到吗？\n答案是Yes，很简单，只需要一个命令去打开bash并在这个bash下面所有的流量都走代理\n> proxychains4 -q /bin/bash\n\n到此为止，我们基本实现了基于浏览器代理和命令行下的全局代理，自己去试试吧，good luck\n\n最后一点补充，可以把SS做成linux服务，这样随系统启动使用起来会更加的方便，做法如下：\n>sudo vim /etc/systemd/system/shadowsocks.service\n内容如下：\n*[Unit]\nDescription=Shadowsocks Client Service\nAfter=network.target\n[Service]\nType=simple\nUser=root\nExecStart=/usr/local/bin/sslocal -c /xxx/shadowsocks.json\n\t\t[Install]\nWantedBy=multi-user.target*\n\n开发SS的linux服务\n>systemctl enable /etc/systemd/system/shadowsocks.service\n\n然后就可以像其他linux服务那样使用 systemctl来管理了\n如果在上述添加SS服务的过程中遇到这个错误的话\n/usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER\n请修改/usr/local/lib/python3.6/dist-packages/shadowsocks/crypto/openssl.py，更新第55行和111行\n将libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) 修改为 <label style=\"color:blue\">libcrypto.EVP_CIPHER_CTX_reset(self._ctx)</label>\n\n\n","slug":"Linux-network-proxy-setup-desktop-and-terminal/index","published":1,"updated":"2019-07-14T07:24:53.260Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjy30duha000764m7i886y2dc","content":"<h3 id=\"背景介绍\"><a href=\"#背景介绍\" class=\"headerlink\" title=\"背景介绍\"></a>背景介绍</h3><p>很多时候我们由于great firewall，我们无法访问某些网站，这时候就需要用到网络代理来应对一些比较urgent的case，本文主要会介绍如何使用Shadowsocks 和 Proxychain来 setup linux network proxy，这样在命令行下都可以起到代理和转发的作用，而不仅限于浏览器的代理。</p>\n<h3 id=\"SS-server-amp-SS-local的配置\"><a href=\"#SS-server-amp-SS-local的配置\" class=\"headerlink\" title=\"SS server &amp; SS local的配置\"></a>SS server &amp; SS local的配置</h3><h4 id=\"预置条件\"><a href=\"#预置条件\" class=\"headerlink\" title=\"预置条件\"></a>预置条件</h4><ul>\n<li>Install Python 3 + pip, 安装命令如下：<blockquote>\n<p>sudo apt-get install python3-pip</p>\n</blockquote>\n</li>\n</ul>\n<p><em>如果得到no packages found - python3-pip的错误，请添加相应的apt sources. 修改/etc/apt/sources.list文件，添加如下4条source信息</em></p>\n<figure class=\"highlight armasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic-updates </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic-security </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic-proposed </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Install Shadowsocks</li>\n<li>一台可以访问<strong>外网</strong>的云主机，Azure/AWS/Alicloud-HK等都可以<blockquote>\n<p>sudo pip install shadowsocks</p>\n</blockquote>\n<h4 id=\"SSServer的配置和启动\"><a href=\"#SSServer的配置和启动\" class=\"headerlink\" title=\"SSServer的配置和启动\"></a>SSServer的配置和启动</h4>在云主机上创建sss 配置文件shadowsocks.json(推荐放置在/etc/shadowsocks/ 下面)，其内容如下：<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"server\"</span>:<span class=\"string\">\"0.0.0.0\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"server_port\"</span>:<span class=\"string\">\"&#123;port&#125;\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_address\"</span>:<span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_port\"</span>:<span class=\"string\">\"1080\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"password\"</span>:<span class=\"string\">\"&#123;password&#125;\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"timeout\"</span>:<span class=\"number\">1000</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"method\"</span>:<span class=\"string\">\"aes-256-cfb\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"fast_open\"</span>:<span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>ip,port,password这三个参数是必须参数<br>配置好这个配置文件后，运行命令然SSS服务运行起来</p>\n<blockquote>\n<p>nohup ssserver -c /etc/shadowsocks/shadowsocks.json start &amp;</p>\n</blockquote>\n<h4 id=\"SSLocal的配置和启动\"><a href=\"#SSLocal的配置和启动\" class=\"headerlink\" title=\"SSLocal的配置和启动\"></a>SSLocal的配置和启动</h4><p>在配置好了服务端之后，我们就可以开始配置客户端了，客户端也需要一个基本类似的配置文件，当然了你可以在windows或者手机上用shadowsocks的客户端来实现客户端代理，这个不是本文的重点<br>在本地的linux机上创建shadowsocks.json，配置内容如下：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"server\"</span>:<span class=\"string\">\"xxxx\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_port\"</span>:<span class=\"number\">1080</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"server_port\"</span>:xxxx,</span><br><span class=\"line\">  <span class=\"attr\">\"password\"</span>:<span class=\"string\">\"xxxx\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"timeout\"</span>:<span class=\"number\">300</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"method\"</span>:<span class=\"string\">\"aes-256-cfb\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>完成配置后，命令运行起来</p>\n<blockquote>\n<p>nohup sslocal -c shadowsocks.json &amp;</p>\n</blockquote>\n<p>到此，我们可以通过设置linux系统环境变量达到浏览器network代理的目的,这距离我们的最终目标命令行下的网络代理更近一步了</p>\n<blockquote>\n<p>export http_proxy=127.0.0.1:1080<br>export https_proxy=127.0.0.1:1080<br>export no_proxy=localhost, 127.0.0.1</p>\n</blockquote>\n<p>接下来我们进行proxychain的安装和配置</p>\n<h3 id=\"Proxychain的配置\"><a href=\"#Proxychain的配置\" class=\"headerlink\" title=\"Proxychain的配置\"></a>Proxychain的配置</h3><h4 id=\"Install-proxychain\"><a href=\"#Install-proxychain\" class=\"headerlink\" title=\"Install proxychain\"></a>Install proxychain</h4><blockquote>\n<p>git clone <a href=\"https://github.com/rofl0r/proxychains-ng\" target=\"_blank\" rel=\"noopener\">https://github.com/rofl0r/proxychains-ng</a><br>  cd proxychains-ng<br>  ./configure –prefix=/usr –sysconfdir=/etc<br>  make<br>  make install<br>  make install-config<br>按步骤执行如上命令完成后，proxychain安装完成，并且默认的配置为：/etc/proxychains.conf</p>\n</blockquote>\n<h4 id=\"Update-proxychain的代理列表\"><a href=\"#Update-proxychain的代理列表\" class=\"headerlink\" title=\"Update proxychain的代理列表\"></a>Update proxychain的代理列表</h4><blockquote>\n<p>vim /etc/proxychains.conf<br>在文件尾部增加一行：socks5    127.0.0.1  1080<br><img src=\"//cloud-poc.github.io/2019/07/14/Linux-network-proxy-setup-desktop-and-terminal/index/15532408-1405d25f0bcee21b.png\" style=\"margin-left:25px\"><br>现在你可以测试了，测试命令如下：<br>proxychains4 curl <a href=\"https://www.google.com\" target=\"_blank\" rel=\"noopener\">https://www.google.com</a></p>\n</blockquote>\n<p>如果你能看到服务器返回了html相关的东西，说明代理是工作的，恭喜你<br>截至目前，你可以做到在命令下来代理网络了，可以应对很多的使用场景了，但是依然有场景你无法满足，例如，在某个应用的内需要走代理，前提是你无法添加proxychains4的前缀，如docker daemon里面去下载image，这时候需要一个‘全局’的代理，使到全部的流量都走代理，不管是inbound或者outbound，你会问可以做到吗？<br>答案是Yes，很简单，只需要一个命令去打开bash并在这个bash下面所有的流量都走代理</p>\n<blockquote>\n<p>proxychains4 -q /bin/bash</p>\n</blockquote>\n<p>到此为止，我们基本实现了基于浏览器代理和命令行下的全局代理，自己去试试吧，good luck</p>\n<p>最后一点补充，可以把SS做成linux服务，这样随系统启动使用起来会更加的方便，做法如下：</p>\n<blockquote>\n<p>sudo vim /etc/systemd/system/shadowsocks.service<br>内容如下：<br><em>[Unit]<br>Description=Shadowsocks Client Service<br>After=network.target<br>[Service]<br>Type=simple<br>User=root<br>ExecStart=/usr/local/bin/sslocal -c /xxx/shadowsocks.json<br>        [Install]<br>WantedBy=multi-user.target</em></p>\n</blockquote>\n<p>开发SS的linux服务</p>\n<blockquote>\n<p>systemctl enable /etc/systemd/system/shadowsocks.service</p>\n</blockquote>\n<p>然后就可以像其他linux服务那样使用 systemctl来管理了<br>如果在上述添加SS服务的过程中遇到这个错误的话<br>/usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER<br>请修改/usr/local/lib/python3.6/dist-packages/shadowsocks/crypto/openssl.py，更新第55行和111行<br>将libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) 修改为 <label style=\"color:blue\">libcrypto.EVP_CIPHER_CTX_reset(self._ctx)</label></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"背景介绍\"><a href=\"#背景介绍\" class=\"headerlink\" title=\"背景介绍\"></a>背景介绍</h3><p>很多时候我们由于great firewall，我们无法访问某些网站，这时候就需要用到网络代理来应对一些比较urgent的case，本文主要会介绍如何使用Shadowsocks 和 Proxychain来 setup linux network proxy，这样在命令行下都可以起到代理和转发的作用，而不仅限于浏览器的代理。</p>\n<h3 id=\"SS-server-amp-SS-local的配置\"><a href=\"#SS-server-amp-SS-local的配置\" class=\"headerlink\" title=\"SS server &amp; SS local的配置\"></a>SS server &amp; SS local的配置</h3><h4 id=\"预置条件\"><a href=\"#预置条件\" class=\"headerlink\" title=\"预置条件\"></a>预置条件</h4><ul>\n<li>Install Python 3 + pip, 安装命令如下：<blockquote>\n<p>sudo apt-get install python3-pip</p>\n</blockquote>\n</li>\n</ul>\n<p><em>如果得到no packages found - python3-pip的错误，请添加相应的apt sources. 修改/etc/apt/sources.list文件，添加如下4条source信息</em></p>\n<figure class=\"highlight armasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic-updates </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic-security </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br><span class=\"line\"><span class=\"symbol\">deb</span> http://<span class=\"meta\">cn</span>.archive.ubuntu.com/ubuntu <span class=\"keyword\">bionic-proposed </span>main <span class=\"keyword\">multiverse </span>restricted universe</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Install Shadowsocks</li>\n<li>一台可以访问<strong>外网</strong>的云主机，Azure/AWS/Alicloud-HK等都可以<blockquote>\n<p>sudo pip install shadowsocks</p>\n</blockquote>\n<h4 id=\"SSServer的配置和启动\"><a href=\"#SSServer的配置和启动\" class=\"headerlink\" title=\"SSServer的配置和启动\"></a>SSServer的配置和启动</h4>在云主机上创建sss 配置文件shadowsocks.json(推荐放置在/etc/shadowsocks/ 下面)，其内容如下：<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"server\"</span>:<span class=\"string\">\"0.0.0.0\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"server_port\"</span>:<span class=\"string\">\"&#123;port&#125;\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_address\"</span>:<span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_port\"</span>:<span class=\"string\">\"1080\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"password\"</span>:<span class=\"string\">\"&#123;password&#125;\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"timeout\"</span>:<span class=\"number\">1000</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"method\"</span>:<span class=\"string\">\"aes-256-cfb\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"fast_open\"</span>:<span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>ip,port,password这三个参数是必须参数<br>配置好这个配置文件后，运行命令然SSS服务运行起来</p>\n<blockquote>\n<p>nohup ssserver -c /etc/shadowsocks/shadowsocks.json start &amp;</p>\n</blockquote>\n<h4 id=\"SSLocal的配置和启动\"><a href=\"#SSLocal的配置和启动\" class=\"headerlink\" title=\"SSLocal的配置和启动\"></a>SSLocal的配置和启动</h4><p>在配置好了服务端之后，我们就可以开始配置客户端了，客户端也需要一个基本类似的配置文件，当然了你可以在windows或者手机上用shadowsocks的客户端来实现客户端代理，这个不是本文的重点<br>在本地的linux机上创建shadowsocks.json，配置内容如下：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"server\"</span>:<span class=\"string\">\"xxxx\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"local_port\"</span>:<span class=\"number\">1080</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"server_port\"</span>:xxxx,</span><br><span class=\"line\">  <span class=\"attr\">\"password\"</span>:<span class=\"string\">\"xxxx\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"timeout\"</span>:<span class=\"number\">300</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"method\"</span>:<span class=\"string\">\"aes-256-cfb\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>完成配置后，命令运行起来</p>\n<blockquote>\n<p>nohup sslocal -c shadowsocks.json &amp;</p>\n</blockquote>\n<p>到此，我们可以通过设置linux系统环境变量达到浏览器network代理的目的,这距离我们的最终目标命令行下的网络代理更近一步了</p>\n<blockquote>\n<p>export http_proxy=127.0.0.1:1080<br>export https_proxy=127.0.0.1:1080<br>export no_proxy=localhost, 127.0.0.1</p>\n</blockquote>\n<p>接下来我们进行proxychain的安装和配置</p>\n<h3 id=\"Proxychain的配置\"><a href=\"#Proxychain的配置\" class=\"headerlink\" title=\"Proxychain的配置\"></a>Proxychain的配置</h3><h4 id=\"Install-proxychain\"><a href=\"#Install-proxychain\" class=\"headerlink\" title=\"Install proxychain\"></a>Install proxychain</h4><blockquote>\n<p>git clone <a href=\"https://github.com/rofl0r/proxychains-ng\" target=\"_blank\" rel=\"noopener\">https://github.com/rofl0r/proxychains-ng</a><br>  cd proxychains-ng<br>  ./configure –prefix=/usr –sysconfdir=/etc<br>  make<br>  make install<br>  make install-config<br>按步骤执行如上命令完成后，proxychain安装完成，并且默认的配置为：/etc/proxychains.conf</p>\n</blockquote>\n<h4 id=\"Update-proxychain的代理列表\"><a href=\"#Update-proxychain的代理列表\" class=\"headerlink\" title=\"Update proxychain的代理列表\"></a>Update proxychain的代理列表</h4><blockquote>\n<p>vim /etc/proxychains.conf<br>在文件尾部增加一行：socks5    127.0.0.1  1080<br><img src=\"//cloud-poc.github.io/2019/07/14/Linux-network-proxy-setup-desktop-and-terminal/index/15532408-1405d25f0bcee21b.png\" style=\"margin-left:25px\"><br>现在你可以测试了，测试命令如下：<br>proxychains4 curl <a href=\"https://www.google.com\" target=\"_blank\" rel=\"noopener\">https://www.google.com</a></p>\n</blockquote>\n<p>如果你能看到服务器返回了html相关的东西，说明代理是工作的，恭喜你<br>截至目前，你可以做到在命令下来代理网络了，可以应对很多的使用场景了，但是依然有场景你无法满足，例如，在某个应用的内需要走代理，前提是你无法添加proxychains4的前缀，如docker daemon里面去下载image，这时候需要一个‘全局’的代理，使到全部的流量都走代理，不管是inbound或者outbound，你会问可以做到吗？<br>答案是Yes，很简单，只需要一个命令去打开bash并在这个bash下面所有的流量都走代理</p>\n<blockquote>\n<p>proxychains4 -q /bin/bash</p>\n</blockquote>\n<p>到此为止，我们基本实现了基于浏览器代理和命令行下的全局代理，自己去试试吧，good luck</p>\n<p>最后一点补充，可以把SS做成linux服务，这样随系统启动使用起来会更加的方便，做法如下：</p>\n<blockquote>\n<p>sudo vim /etc/systemd/system/shadowsocks.service<br>内容如下：<br><em>[Unit]<br>Description=Shadowsocks Client Service<br>After=network.target<br>[Service]<br>Type=simple<br>User=root<br>ExecStart=/usr/local/bin/sslocal -c /xxx/shadowsocks.json<br>        [Install]<br>WantedBy=multi-user.target</em></p>\n</blockquote>\n<p>开发SS的linux服务</p>\n<blockquote>\n<p>systemctl enable /etc/systemd/system/shadowsocks.service</p>\n</blockquote>\n<p>然后就可以像其他linux服务那样使用 systemctl来管理了<br>如果在上述添加SS服务的过程中遇到这个错误的话<br>/usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER<br>请修改/usr/local/lib/python3.6/dist-packages/shadowsocks/crypto/openssl.py，更新第55行和111行<br>将libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) 修改为 <label style=\"color:blue\">libcrypto.EVP_CIPHER_CTX_reset(self._ctx)</label></p>\n"}],"PostAsset":[{"_id":"source/_posts/Linux-network-proxy-setup-desktop-and-terminal/index/15532408-1405d25f0bcee21b.png","slug":"15532408-1405d25f0bcee21b.png","post":"cjy30duha000764m7i886y2dc","modified":0,"renderable":0},{"_id":"source/_posts/Harshicorp-vault-setup-Config/index/15532408-351f3fa54f1ebc1a.png","slug":"15532408-351f3fa54f1ebc1a.png","post":"cjy30dugr000364m75c8hwg2i","modified":0,"renderable":0},{"_id":"source/_posts/Harshicorp-vault-setup-Config/index/15532408-698c9ee3afd1d4f9.png","slug":"15532408-698c9ee3afd1d4f9.png","post":"cjy30dugr000364m75c8hwg2i","modified":0,"renderable":0},{"_id":"source/_posts/Https-setup-using-Certbot-Docker-Nginx/index/20190714194434.png","slug":"20190714194434.png","post":"cjy30duh5000464m7ovjm1lym","modified":0,"renderable":0},{"_id":"source/_posts/Https-setup-using-Certbot-Docker-Nginx/index/20190714195417.png","slug":"20190714195417.png","post":"cjy30duh5000464m7ovjm1lym","modified":0,"renderable":0},{"_id":"source/_posts/Https-setup-using-Certbot-Docker-Nginx/index/debug.log","slug":"debug.log","post":"cjy30duh5000464m7ovjm1lym","modified":0,"renderable":0}],"PostCategory":[{"post_id":"cjy30dugr000364m75c8hwg2i","category_id":"cjy30duh8000564m7w3xm4pvx","_id":"cjy30duhe000a64m7pxq64xba"},{"post_id":"cjy30duh5000464m7ovjm1lym","category_id":"cjy30duhc000864m748dkqk71","_id":"cjy30duhh000d64m7c3vytqim"},{"post_id":"cjy30duha000764m7i886y2dc","category_id":"cjy30duhc000864m748dkqk71","_id":"cjy30duhi000g64m7i9zmq9y6"}],"PostTag":[{"post_id":"cjy30dugr000364m75c8hwg2i","tag_id":"cjy30duh9000664m754o86f9f","_id":"cjy30duhi000f64m7k6xb88ai"},{"post_id":"cjy30dugr000364m75c8hwg2i","tag_id":"cjy30duhd000964m74odqefbs","_id":"cjy30duhj000h64m79xc0d7k2"},{"post_id":"cjy30dugr000364m75c8hwg2i","tag_id":"cjy30duhe000c64m7ds9nf3j5","_id":"cjy30duhj000j64m7b7oqyfdv"},{"post_id":"cjy30duh5000464m7ovjm1lym","tag_id":"cjy30duhh000e64m7di8pq48p","_id":"cjy30duhk000m64m7ww9mdyqz"},{"post_id":"cjy30duh5000464m7ovjm1lym","tag_id":"cjy30duhj000i64m7ouad2r4g","_id":"cjy30duhl000n64m7unkrjf96"},{"post_id":"cjy30duh5000464m7ovjm1lym","tag_id":"cjy30duhk000k64m7p0b967co","_id":"cjy30duhl000p64m7j3kqhptl"},{"post_id":"cjy30duha000764m7i886y2dc","tag_id":"cjy30duhk000l64m7e0pumsm6","_id":"cjy30duhn000r64m7128ks7yg"},{"post_id":"cjy30duha000764m7i886y2dc","tag_id":"cjy30duhl000o64m7oh35k1fl","_id":"cjy30duhn000s64m7dgedoomb"},{"post_id":"cjy30duha000764m7i886y2dc","tag_id":"cjy30duhm000q64m7jkozz9gh","_id":"cjy30duhn000t64m758r9i9fx"}],"Tag":[{"name":"Harshicorp","_id":"cjy30duh9000664m754o86f9f"},{"name":"Docker","_id":"cjy30duhd000964m74odqefbs"},{"name":"Microservices","_id":"cjy30duhe000c64m7ds9nf3j5"},{"name":"Certbot","_id":"cjy30duhh000e64m7di8pq48p"},{"name":"Let’s Encrypt","_id":"cjy30duhj000i64m7ouad2r4g"},{"name":"Nginx","_id":"cjy30duhk000k64m7p0b967co"},{"name":"Shadowsocks","_id":"cjy30duhk000l64m7e0pumsm6"},{"name":"Proxychain","_id":"cjy30duhl000o64m7oh35k1fl"},{"name":"Proxy","_id":"cjy30duhm000q64m7jkozz9gh"}]}}